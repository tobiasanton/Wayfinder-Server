<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mc2: OldExtraDataUtility.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">Server</a>&nbsp;/&nbsp;<a class="el" href="dir_000007.html">MapGen</a>&nbsp;/&nbsp;<a class="el" href="dir_000034.html">include</a></div>
<h1>OldExtraDataUtility.h</h1><a href="OldExtraDataUtility_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">Copyright (c) 1999 - 2010, Vodafone Group Services Ltd</span>
00003 <span class="comment">All rights reserved.</span>
00004 <span class="comment"></span>
00005 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
00008 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
00009 <span class="comment">    * Neither the name of the Vodafone Group Services Ltd nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
00010 <span class="comment"></span>
00011 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#ifndef OLDEXTRADATAUTILITY_H</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define OLDEXTRADATAUTILITY_H</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00018 
00019 <span class="preprocessor">#include "<a class="code" href="Vector_8h.html">Vector.h</a>"</span>
00020 <span class="preprocessor">#include "<a class="code" href="ItemTypes_8h.html">ItemTypes.h</a>"</span>
00021 <span class="preprocessor">#include "<a class="code" href="CoordinateTransformer_8h.html">CoordinateTransformer.h</a>"</span>
00022 <span class="preprocessor">#include "<a class="code" href="STLStrComp_8h.html">STLStrComp.h</a>"</span>
00023 <span class="preprocessor">#include "<a class="code" href="MC2String_8h.html">MC2String.h</a>"</span>
00024 <span class="preprocessor">#include "<a class="code" href="LangTypes_8h.html">LangTypes.h</a>"</span>
00025 
00026 <span class="preprocessor">#include &lt;vector&gt;</span>
00027 
00028 <span class="keyword">class </span><a class="code" href="classOldItem.html">OldItem</a>;
00029 <span class="keyword">class </span><a class="code" href="classOldStreetSegmentItem.html">OldStreetSegmentItem</a>;
00030 <span class="keyword">class </span><a class="code" href="classOldNode.html">OldNode</a>;
00031 <span class="keyword">class </span><a class="code" href="classOldConnection.html">OldConnection</a>;
00032 <span class="keyword">class </span><a class="code" href="classOldGenericMap.html">OldGenericMap</a>;
00033 
<a name="l00042"></a><a class="code" href="classOldExtraDataUtility.html">00042</a> <span class="keyword">class </span><a class="code" href="classOldExtraDataUtility.html">OldExtraDataUtility</a> {
00043    <span class="keyword">public</span>:
<a name="l00047"></a><a class="code" href="classOldExtraDataUtility.html#z172_0">00047</a>       <span class="keyword">enum</span> record_t {
00051          COMMENT,
00052 
00056          ADD_CITYPART,
00057 
00061          UPDATE_NAME,
00062 
00067          SET_RAMP,
00068 
00073          SET_ROUNDABOUT,
00074 
00079          SET_MULTIDIGITISED,
00080 
00085          SET_ENTRYRESTRICTIONS,
00086 
00091          SET_SPEEDLIMIT,
00092 
00097          SET_LEVEL,
00098 
00103          SET_TURNDIRECTION,
00104 
00109          SET_HOUSENUMBER,
00110 
00114          ADD_NAME_TO_ITEM,
00115             
00120          SET_VEHICLERESTRICTIONS,
00121 
00126          ADD_LANDMARK,
00127          
00132          ADD_SINGLE_LANDMARK,
00133 
00137          REMOVE_NAME_FROM_ITEM,
00138          
00144          REMOVE_ITEM,
00145 
00149          ADD_SIGNPOST,
00150          
00154          REMOVE_SIGNPOST,
00155          
00160          SET_ROUNDABOUTISH,
00161 
00166          SET_CONTROLLEDACCESS,
00167 
00171          SET_WATER_TYPE,
00172 
00177          SET_TOLLROAD,
00178 
00182          NUMBER_OF_RECORD_TYPES
00183       };
00184 
00191       <span class="keyword">static</span> record_t getRecordType(<a class="code" href="classMC2String.html">MC2String</a>&amp; s);
00192 
00193 
<a name="l00213"></a><a class="code" href="classOldExtraDataUtility.html#z172_1">00213</a>       <span class="keyword">enum</span> selectConn_t {
00214         
00216          ALLCONN,
00217          
00219          AHEADCONN,
00220          
00222          TURNCONN,
00223          
00234 <span class="comment">//         NB: dist not (yet) implemented in the landmark table.</span>
00235 <span class="comment">//         ALLCONN_DIST,</span>
00236 <span class="comment">//         AHEADCONN_DIST,</span>
00237 <span class="comment">//         TURNCONN_DIST,</span>
00238 
00240          NOCONN
00241       };
00242 
00250       <span class="keyword">static</span> selectConn_t getSelectConns(<a class="code" href="classMC2String.html">MC2String</a>&amp; s);
00251 
<a name="l00255"></a><a class="code" href="classOldExtraDataUtility.html#z172_18">00255</a>       <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a> edFieldSep;
00256       
00268       <span class="keyword">static</span> <a class="code" href="classMC2String.html">MC2String</a> createEDFileString( 
00269                <a class="code" href="classvector.html">vector&lt;MC2String&gt;</a>&amp; subStrings, <span class="keywordtype">bool</span> addEndOfRec = <span class="keyword">false</span> );
00270       
00271       
00272 
00290        <span class="keyword">static</span> <span class="keywordtype">int</span> updateName(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap,
00291                        <a class="code" href="classOldItem.html">OldItem</a>* item,
00292                        ItemTypes::itemType it,
00293                        <a class="code" href="classMC2String.html">MC2String</a> ename,
00294                        ItemTypes::name_t nt,
00295                        LangTypes::language_t lang,
00296                        <a class="code" href="classMC2String.html">MC2String</a> nname,
00297                        <a class="code" href="classvector.html">vector&lt;uint32&gt;</a>&amp; affectsStreets);
00298 
00313        <span class="keyword">static</span> <span class="keywordtype">int</span> removeNameFromItem(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap,
00314                        <a class="code" href="classOldItem.html">OldItem</a>* item,
00315                        ItemTypes::itemType it,
00316                        <a class="code" href="classMC2String.html">MC2String</a>&amp; ename,
00317                        ItemTypes::name_t nt,
00318                        LangTypes::language_t lang,
00319                        <a class="code" href="classvector.html">vector&lt;uint32&gt;</a>&amp; affectsStreets);
00320 
00336       <span class="keyword">static</span> <span class="keywordtype">int</span> addNameToItem(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap,
00337                                <a class="code" href="classOldItem.html">OldItem</a>* item,
00338                                ItemTypes::itemType it,
00339                                <a class="code" href="classMC2String.html">MC2String</a> nname,
00340                                ItemTypes::name_t nt,
00341                                LangTypes::language_t lang,
00342                                <a class="code" href="classvector.html">vector&lt;uint32&gt;</a>&amp; affectsStreets);
00343 
00344  
00359       <span class="keyword">static</span> <a class="code" href="Types_8h.html#a25">byte</a> getNameOffsetForItem(<a class="code" href="classOldItem.html">OldItem</a>* item, 
00360                                        uint32 enameIndex,
00361                                        ItemTypes::name_t nt,
00362                                        LangTypes::language_t lang);
00363 
00372       <span class="keyword">static</span> <span class="keywordtype">bool</span> readNextRecordFromFile(istream&amp; is,
00373                                   <a class="code" href="classvector.html">vector&lt;MC2String&gt;</a>&amp; recordAsStrings);
00374 
00383       <span class="keyword">static</span> <a class="code" href="classOldNode.html">OldNode</a>* getNodeFromStrings(
00384                               <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap,
00385                               CoordinateTransformer::format_t coordType,
00386                               <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>&amp; coord1, 
00387                               <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>&amp; coord2);
00388 
00400       <span class="keyword">static</span> <span class="keywordtype">bool</span> strtolatlon(<span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>&amp; s, int32&amp; lat, int32&amp; lon,
00401                               CoordinateTransformer::format_t coordType);
00402 
00423       <span class="keyword">static</span> <span class="keywordtype">int</span> addLandmark(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap,
00424                              ItemTypes::itemType it,
00425                              ItemTypes::pointOfInterest_t pt,
00426                              uint32 importance,
00427                              int32 lat, int32 lon,
00428                              uint32 radius,
00429                              int32 itemlat, int32 itemlon,
00430                              <span class="keyword">const</span> <span class="keywordtype">char</span>* itemName,
00431                              selectConn_t selConns);
00432 
00438       <span class="keyword">static</span> <span class="keywordtype">int</span> addRailwayLandmark(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap,
00439                              ItemTypes::itemType it,
00440                              uint32 importance,
00441                              int32 lat, int32 lon,
00442                              uint32 radius,
00443                              selectConn_t selConns);
00444 
00450       <span class="keyword">static</span> <span class="keywordtype">int</span> addOtherLandmark(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap,
00451                              ItemTypes::itemType it,
00452                              ItemTypes::pointOfInterest_t pt,
00453                              uint32 importance,
00454                              int32 lat, int32 lon,
00455                              uint32 radius,
00456                              int32 itemlat, int32 itemlon,
00457                              <span class="keyword">const</span> <span class="keywordtype">char</span>* itemName,
00458                              selectConn_t selConns);
00459 
00476       <span class="keyword">static</span> <span class="keywordtype">bool</span> addSingleLandmark(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap,
00477                              <a class="code" href="classOldItem.html">OldItem</a>* lmItem,
00478                              uint32 importance,
00479                              <span class="keywordtype">int</span> location,
00480                              <span class="keywordtype">int</span> side,
00481                              <a class="code" href="classOldNode.html">OldNode</a>* fromNode, <a class="code" href="classOldNode.html">OldNode</a>* toNode);
00482                               
00483 
00492       <span class="keyword">static</span> <span class="keywordtype">bool</span> removeItem(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap, <a class="code" href="classOldItem.html">OldItem</a>* item);
00493 
00494 
00508       <span class="keyword">static</span> <span class="keywordtype">bool</span> transferChangeToVirtualNode(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap,
00509                               uint32 nodeID, <span class="keywordtype">int</span> val, record_t edType,
00510                               <a class="code" href="classvector.html">vector&lt;uint32&gt;</a>&amp; changedVirtuals);
00511 
00512    <span class="keyword">private</span>:
00513 
00523       <span class="keyword">static</span> <span class="keywordtype">bool</span> nextToken( <a class="code" href="classMC2String.html">MC2String</a>&amp; src, <a class="code" href="classMC2String.html">MC2String</a>&amp; token );
00524 
00526       <span class="keyword">static</span> <a class="code" href="Types_8h.html#a21">uint32</a> getAllItemsWithName(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap,
00527                                  <a class="code" href="classMC2String.html">MC2String</a>&amp; str,
00528                                  Vector* result);
00529 
00531       <span class="keyword">static</span> <span class="keywordtype">void</span> getAllItemsWithName(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap,
00532                                       <span class="keyword">const</span> uint32,
00533                                       Vector* result);
00534 
00544       <span class="keyword">static</span> <span class="keywordtype">bool</span> hasItemName(<a class="code" href="classOldItem.html">OldItem</a>* item, <span class="keyword">const</span> uint32 rawStringIndex);
00545 
00546 
00573          <span class="keyword">static</span> <span class="keywordtype">bool</span> getLandmarkLocationAndSide(
00574                <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap, <a class="code" href="classOldConnection.html">OldConnection</a>* conn, uint32 toNodeID,
00575                int32 itemlat, int32 itemlon, uint32 itemID, 
00576                ItemTypes::landmark_t lmType, Vector&amp; ssiIDs,
00577                ItemTypes::landmarklocation_t&amp; location,
00578                SearchTypes::side_t&amp; side);
00579 
00605          <span class="keyword">static</span> SearchTypes::side_t getSide(<a class="code" href="classOldStreetSegmentItem.html">OldStreetSegmentItem</a>* ssi,
00606                uint32 nodeNbr, int32 itemlat, int32 itemlon,
00607                <span class="keywordtype">bool</span> fromSide = <span class="keyword">true</span>, <span class="keywordtype">bool</span> within = <span class="keyword">true</span>);
00608 
00617          <span class="keyword">static</span> <span class="keywordtype">bool</span> withinSsi(<a class="code" href="classOldStreetSegmentItem.html">OldStreetSegmentItem</a>* ssi, 
00618                                  int32 itemlat, int32 itemlon,
00619                                  int32 crossinglat, int32 crossinglon);
00620 
00629          <span class="keyword">static</span> <span class="keywordtype">bool</span> onSsi( <a class="code" href="classOldStreetSegmentItem.html">OldStreetSegmentItem</a>* ssi,
00630                             int32 itemlat, int32 itemlon);
00631          
00642          <span class="keyword">static</span> <span class="keywordtype">bool</span> crossingTlike(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap, Vector&amp; ssiIDs);
00644 
00650       <span class="keyword">static</span> <span class="keywordtype">void</span> init();
00651 
<a name="l00655"></a><a class="code" href="classOldExtraDataUtility.html#v0">00655</a>       <span class="keyword">static</span> <span class="keywordtype">bool</span> m_initiated;
00656 
<a name="l00657"></a><a class="code" href="structOldExtraDataUtility_1_1ltstrcase.html">00657</a>       <span class="keyword">struct </span><a class="code" href="structOldExtraDataUtility_1_1ltstrcase.html">ltstrcase</a> {
<a name="l00658"></a><a class="code" href="structOldExtraDataUtility_1_1ltstrcase.html#a0">00658</a>          <span class="keywordtype">bool</span> operator()(<span class="keyword">const</span> <span class="keywordtype">char</span>* a, <span class="keyword">const</span> <span class="keywordtype">char</span>* b ) {
00659             <span class="keywordflow">return</span> strcasecmp( a, b ) &lt; 0;
00660          }
00661       };
00662 
<a name="l00663"></a><a class="code" href="classOldExtraDataUtility.html#y0">00663</a>       <span class="keyword">typedef</span> <a class="code" href="classmap.html">map&lt;const char*, record_t, ltstrcase&gt;</a> <a class="code" href="classmap.html">recordMap_t</a>;
00664 
<a name="l00669"></a><a class="code" href="classOldExtraDataUtility.html#v1">00669</a>       <span class="keyword">static</span> recordMap_t m_recordTypes;
00670 
<a name="l00671"></a><a class="code" href="classOldExtraDataUtility.html#y1">00671</a>       <span class="keyword">typedef</span> <a class="code" href="classmap.html">map&lt;const char*, selectConn_t, ltstrcase&gt;</a> <a class="code" href="classmap.html">selectConnMap_t</a>;
00672       
<a name="l00677"></a><a class="code" href="classOldExtraDataUtility.html#v2">00677</a>       <span class="keyword">static</span> selectConnMap_t m_selectConns;
00678 
00679 };
00680 
00681 <span class="preprocessor">#endif // OLDEXTRADATAUTILITY_H</span>
00682 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jun 30 10:11:48 2010 for mc2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
