<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mc2: HttpHeader.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">Server</a>&nbsp;/&nbsp;<a class="el" href="dir_000005.html">Shared</a>&nbsp;/&nbsp;<a class="el" href="dir_000024.html">Net</a>&nbsp;/&nbsp;<a class="el" href="dir_000025.html">include</a></div>
<h1>HttpHeader.h</h1><a href="HttpHeader_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">Copyright (c) 1999 - 2010, Vodafone Group Services Ltd</span>
00003 <span class="comment">All rights reserved.</span>
00004 <span class="comment"></span>
00005 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
00008 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
00009 <span class="comment">    * Neither the name of the Vodafone Group Services Ltd nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
00010 <span class="comment"></span>
00011 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#ifndef HTTPHEADER_H</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define HTTPHEADER_H</span>
00016 <span class="preprocessor"></span>
00017 <span class="comment">// Includes</span>
00018 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00019 <span class="preprocessor">#include &lt;time.h&gt;</span>
00020 
00021 <span class="preprocessor">#include "<a class="code" href="MC2String_8h.html">MC2String.h</a>"</span>
00022 <span class="preprocessor">#include &lt;map&gt;</span>
00023 <span class="preprocessor">#include "<a class="code" href="STLStrComp_8h.html">STLStrComp.h</a>"</span>
00024 
00025 <span class="keyword">class </span><a class="code" href="classTCPSocket.html">TCPSocket</a>;
00026 
<a name="l00031"></a><a class="code" href="classHttpHeader.html">00031</a> <span class="keyword">class </span><a class="code" href="classHttpHeader.html">HttpHeader</a> {
00032    <span class="keyword">public</span>:
00037       <a class="code" href="classHttpHeader.html">HttpHeader</a>(<a class="code" href="classMC2String.html">MC2String</a>* Header);
00038 
00039 
00043       <a class="code" href="classHttpHeader.html">HttpHeader</a>();
00044 
00045 
00049       <span class="keyword">virtual</span> ~<a class="code" href="classHttpHeader.html">HttpHeader</a>();
00050    
00051 
00058       <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>* getHeaderValue(<span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>* HeaderType) <span class="keyword">const</span>;
00059       
00060 
00067       <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>* getHeaderValue(<span class="keyword">const</span> <span class="keywordtype">char</span>* HeaderType) <span class="keyword">const</span>;
00068 
00069 
00077       <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>* getHeaderValue( <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>&amp; HeaderType ) <span class="keyword">const</span>;
00078 
00083       time_t getHeaderDateValue( <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>&amp; headername ) <span class="keyword">const</span>;
00084 
00090       <span class="keywordtype">void</span> addHeaderDateValue( <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>&amp; headername,
00091                                time_t timeVal );
00092    
00099       <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>&amp; getAcceptCharset() <span class="keyword">const</span>;
00100       
00101 
00105       <a class="code" href="Types_8h.html#a21">uint32</a> getContentLength() <span class="keyword">const</span>;
00106       
00107       
00114       <span class="keywordtype">void</span> setContentLength(<a class="code" href="Types_8h.html#a21">uint32</a> Length);
00115       
00116       
00129       <span class="keywordtype">void</span> addHeaderLine( <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>* headerType, 
00130                           <a class="code" href="classMC2String.html">MC2String</a>* headerValue,
00131                           <span class="keywordtype">bool</span> appendMultipleHeaders = <span class="keyword">false</span> );
00132 
00144       <span class="keywordtype">void</span> addHeaderLine( <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>&amp; headerType,
00145                           <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>&amp; headerValue,
00146                           <span class="keywordtype">bool</span> appendMultipleHeaders = <span class="keyword">false</span> );
00147 
00159       <span class="keywordtype">void</span> addHeaderLine( <span class="keyword">const</span> <span class="keywordtype">char</span>* headerType,
00160                           <span class="keyword">const</span> <span class="keywordtype">char</span>* headerValue,
00161                           <span class="keywordtype">bool</span> appendMultipleHeaders = <span class="keyword">false</span> );
00162 
00175       <span class="keywordtype">bool</span> addHeaderLine( <span class="keyword">const</span> <span class="keywordtype">char</span>* inLine,
00176                           <span class="keywordtype">bool</span> appendMultipleHeaders = <span class="keyword">false</span> );
00177 
00183       <span class="keywordtype">bool</span> addRequestLine(<span class="keyword">const</span> <span class="keywordtype">char</span>* inLine);
00184       
00190       <span class="keywordtype">bool</span> deleteHeaderLine( <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>* HeaderType );
00191       
00192       
00200       <span class="keywordtype">void</span> setStartLine(<a class="code" href="classMC2String.html">MC2String</a>* Line);
00201       
00202       
00208       <span class="keywordtype">void</span> setStartLine( <a class="code" href="Types_8h.html#a21">uint32</a> code );
00209       
00213       <span class="keyword">const</span> <span class="keywordtype">char</span>* getCurrHTTPVer() <span class="keyword">const</span>;
00214 
00220       <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>* getStartLine() <span class="keyword">const</span>;
00221       
00222      
00227       <a class="code" href="Types_8h.html#a21">uint32</a> getStartLineCode() <span class="keyword">const</span>;
00228 
00229 
00234       <span class="keywordtype">void</span> writeHeader(<a class="code" href="classTCPSocket.html">TCPSocket</a>* sock) <span class="keyword">const</span>;
00235 
00236 
00241       <span class="keywordtype">void</span> putHeader(<a class="code" href="classMC2String.html">MC2String</a>* headerString) <span class="keyword">const</span>;
00242       
00243       <span class="keywordtype">void</span> replacePagename( <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>&amp; newPagename );
00247       <span class="keywordtype">void</span> clear();
00248       
00249       
00255       <span class="keywordtype">void</span> setURLPath(<a class="code" href="classMC2String.html">MC2String</a>* newURLPath);
00256       
00257 
00261       <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>* getURLPath() <span class="keyword">const</span>;
00262 
00263 
00269       <span class="keywordtype">void</span> setPagename(<a class="code" href="classMC2String.html">MC2String</a>* newPagename);
00270 
00271       
00275       <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>* getPagename() <span class="keyword">const</span>;
00276       
00277 
00284       <span class="keyword">static</span> <a class="code" href="Types_8h.html#a21">uint32</a> parseHTTPResponeLine( <span class="keyword">const</span> <span class="keywordtype">char</span>* data );
00285 
<a name="l00289"></a><a class="code" href="classHttpHeader.html#w11">00289</a>       <span class="keyword">enum</span> MethodType {
00290          GET_METHOD,
00291          POST_METHOD,
00292          HEAD_METHOD, <span class="comment">// HEAD was already defined</span>
00293          OPTIONS_METHOD,
00294          PUT_METHOD,
00295          DELETE_METHOD,
00296          TRACE_METHOD,
00297          CONNECT_METHOD,
00298 
00299          NO_MATCH
00300       };
00301 
00305       MethodType getMethod() <span class="keyword">const</span>;
00306 
00307 
00312       <span class="keywordtype">void</span> setMethod( MethodType method );
00313 
00314 
00318       <span class="keyword">const</span> <span class="keywordtype">char</span>* getMethodString() <span class="keyword">const</span>;
00319 
00320 
00324       <a class="code" href="Types_8h.html#a21">uint32</a> getMajorVersion() <span class="keyword">const</span>;
00325 
00326 
00330       <a class="code" href="Types_8h.html#a21">uint32</a> getMinorVersion() <span class="keyword">const</span>;
00331 
00332 
00336       <span class="keywordtype">void</span> setHttpVersion( uint32 major, uint32 minor );
00337 
00338 
00344       <span class="keyword">static</span> <a class="code" href="Types_8h.html#a21">uint32</a> nbrStrings( <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>* str );
00345 
00346       
00353       <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* getFirstStringIn( <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>* str, 
00354                                            uint32&amp; pos );
00355 
00356 
00365       <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* getNextStringIn( <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>* str, uint32&amp; pos );
00366 
00367 
00375       <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* getStringIn( uint32 index, <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>* str );
00376 
00382       <span class="keyword">friend</span> ostream&amp; <a class="code" href="UserRightsItemTable_8h.html#a0">operator&lt;&lt;</a>( ostream&amp; ostr, <span class="keyword">const</span> <a class="code" href="classHttpHeader.html">HttpHeader</a>&amp; header );
00383 
<a name="l00387"></a><a class="code" href="classHttpHeader.html#w0">00387</a>       <span class="keyword">typedef</span> <a class="code" href="classmap.html">map&lt;MC2String, MC2String*, strNoCaseCompareLess&gt;</a> <a class="code" href="classmap.html">HeaderMap</a>;
00388 
00392       <span class="keyword">const</span> HeaderMap&amp; getHeaderMap() <span class="keyword">const</span>;
00393 
<a name="l00394"></a><a class="code" href="classHttpHeader.html#w1">00394</a>       <span class="keyword">typedef</span> <a class="code" href="classmap.html">map&lt; uint32, pair&lt; MC2String, MC2String &gt;</a> &gt; <a class="code" href="classmap.html">httpResponsMap</a>;
00395 
00399       <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>&amp; getHttpStartLine( uint32 code );
00400 
00404       <span class="keyword">static</span> <span class="keywordtype">bool</span> getHttpErrorPage( uint32 code, <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>*&amp; header,
00405                                     <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>*&amp; body );
00406       
00407   <span class="keyword">private</span>:
00408 
00412       <span class="keywordtype">void</span> resetCached();
00413 
00418       <span class="keywordtype">void</span> parseHeader(<a class="code" href="classMC2String.html">MC2String</a>* Header);
00419 
00426       MethodType findMethod(<span class="keyword">const</span> <span class="keywordtype">char</span>* method) <span class="keyword">const</span>;
00427 
00431       <span class="keyword">static</span> httpResponsMap initHttpResponsMap();
00432 
<a name="l00436"></a><a class="code" href="classHttpHeader.html#v0">00436</a>       <span class="keyword">static</span> httpResponsMap httpResponses;
00437       
<a name="l00439"></a><a class="code" href="classHttpHeader.html#r0">00439</a>       <a class="code" href="classMC2String.html">MC2String</a>* m_header;
00440 
<a name="l00442"></a><a class="code" href="classHttpHeader.html#r1">00442</a>       <a class="code" href="Types_8h.html#a21">uint32</a> m_contentLength;
00443 
<a name="l00445"></a><a class="code" href="classHttpHeader.html#r2">00445</a>       <a class="code" href="classMC2String.html">MC2String</a>* m_URLPath;
00446 
<a name="l00448"></a><a class="code" href="classHttpHeader.html#r3">00448</a>       <a class="code" href="classMC2String.html">MC2String</a>* m_pagename;
00449 
<a name="l00451"></a><a class="code" href="classHttpHeader.html#r4">00451</a>       <a class="code" href="classMC2String.html">MC2String</a>* m_startLine;
00452 
<a name="l00456"></a><a class="code" href="classHttpHeader.html#r5">00456</a>       HeaderMap m_Headers;
00457 
<a name="l00459"></a><a class="code" href="classHttpHeader.html#r6">00459</a>       MethodType m_method;
00460 
<a name="l00464"></a><a class="code" href="classHttpHeader.html#r7">00464</a>       <a class="code" href="classMC2String.html">MC2String</a> m_acceptCharset;
00465 
<a name="l00469"></a><a class="code" href="classHttpHeader.html#r8">00469</a>       <a class="code" href="Types_8h.html#a21">uint32</a> m_majorVersion;
00470 
00471 
<a name="l00475"></a><a class="code" href="classHttpHeader.html#r9">00475</a>       <a class="code" href="Types_8h.html#a21">uint32</a> m_minorVersion;
00476 
00477 
<a name="l00479"></a><a class="code" href="structHttpHeader_1_1methodTable__t.html">00479</a>       <span class="keyword">struct </span><a class="code" href="structHttpHeader_1_1methodTable__t.html">methodTable_t</a> {
<a name="l00480"></a><a class="code" href="structHttpHeader_1_1methodTable__t.html#o0">00480</a>          <span class="keyword">const</span> <span class="keywordtype">char</span>* methodString;
<a name="l00481"></a><a class="code" href="structHttpHeader_1_1methodTable__t.html#o1">00481</a>          MethodType method;
00482       };
00483 
<a name="l00485"></a><a class="code" href="classHttpHeader.html#v1">00485</a>       <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structHttpHeader_1_1methodTable__t.html">methodTable_t</a> methodTable[];
00486 };
00487 
00488 
00489 <span class="comment">// -----------------------------------------------------------------------</span>
00490 <span class="comment">//                                     Implementation of inlined methods -</span>
00491 
00492 
00493 <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>*
<a name="l00494"></a><a class="code" href="classHttpHeader.html#a5">00494</a> <a class="code" href="classHttpHeader.html#a3">HttpHeader::getHeaderValue</a>( <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a>&amp; HeaderType )<span class="keyword"> const </span>{
00495    <span class="keywordflow">return</span> <a class="code" href="classHttpHeader.html#a3">getHeaderValue</a>( &amp;HeaderType );
00496 }
00497 
00498 
00499 <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classmap.html">HttpHeader::HeaderMap</a>&amp;
<a name="l00500"></a><a class="code" href="classHttpHeader.html#a36">00500</a> <a class="code" href="classHttpHeader.html#a36">HttpHeader::getHeaderMap</a>()<span class="keyword"> const </span>{
00501    <span class="keywordflow">return</span> m_Headers;
00502 }
00503 
00504 <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00505"></a><a class="code" href="classHttpHeader.html#a35">00505</a> <a class="code" href="classHttpHeader.html#a35">HttpHeader::setHttpVersion</a>( uint32 major, uint32 minor ) {
00506    <a class="code" href="classHttpHeader.html#r8">m_majorVersion</a> = major;
00507    <a class="code" href="classHttpHeader.html#r9">m_minorVersion</a> = minor;
00508 }
00509 
00510 
00511 <span class="preprocessor">#endif // HTTPHEADER_H</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jun 30 10:11:47 2010 for mc2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
