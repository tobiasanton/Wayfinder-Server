<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mc2: GfxFeatureMap.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">Server</a>&nbsp;/&nbsp;<a class="el" href="dir_000005.html">Shared</a>&nbsp;/&nbsp;<a class="el" href="dir_000045.html">Gfx</a>&nbsp;/&nbsp;<a class="el" href="dir_000046.html">include</a></div>
<h1>GfxFeatureMap.h</h1><a href="GfxFeatureMap_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">Copyright (c) 1999 - 2010, Vodafone Group Services Ltd</span>
00003 <span class="comment">All rights reserved.</span>
00004 <span class="comment"></span>
00005 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
00008 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
00009 <span class="comment">    * Neither the name of the Vodafone Group Services Ltd nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
00010 <span class="comment"></span>
00011 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#ifndef GFX_FEATURE_MAP_H</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define GFX_FEATURE_MAP_H</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00018 <span class="preprocessor">#include "<a class="code" href="DataBuffer_8h.html">DataBuffer.h</a>"</span>
00019 <span class="preprocessor">#include "<a class="code" href="MC2BoundingBox_8h.html">MC2BoundingBox.h</a>"</span>
00020 <span class="preprocessor">#include "<a class="code" href="GfxFeature_8h.html">GfxFeature.h</a>"</span>
00021 <span class="preprocessor">#include "<a class="code" href="ScreenSize_8h.html">ScreenSize.h</a>"</span>
00022 
<a name="l00028"></a><a class="code" href="GfxFeatureMap_8h.html#a0">00028</a> <span class="keyword">typedef</span> std::vector &lt; GfxFeature* &gt; GfxFeatureVector;
00029 
<a name="l00030"></a><a class="code" href="classGfxFeatureMap.html">00030</a> <span class="keyword">class </span><a class="code" href="classGfxFeatureMap.html">GfxFeatureMap</a> {
00031 <span class="keyword">public</span>:
00032 
00033 
00037       <a class="code" href="classGfxFeatureMap.html">GfxFeatureMap</a>();
00038       
00042       <span class="keyword">virtual</span> ~<a class="code" href="classGfxFeatureMap.html">GfxFeatureMap</a>();
00043       
00052       <span class="keywordtype">bool</span> <a class="code" href="namespaceTileFeatureScaleRange.html#a4">load</a>( <a class="code" href="classDataBuffer.html">DataBuffer</a>* data );
00053 
00054 
00064       <a class="code" href="Types_8h.html#a21">uint32</a> loadHeader( <a class="code" href="classDataBuffer.html">DataBuffer</a>* data );
00065 
00066 
00076       <span class="keywordtype">bool</span> <a class="code" href="namespaceTileFeatureScaleRange.html#a3">save</a>( <a class="code" href="classDataBuffer.html">DataBuffer</a>* data ) <span class="keyword">const</span>;
00077 
00078 
00088       <span class="keywordtype">bool</span> saveHeader( <a class="code" href="classDataBuffer.html">DataBuffer</a>* data, <a class="code" href="Types_8h.html#a21">uint32</a> nbrFeatures ) <span class="keyword">const</span>;
00089 
00090 
00103       <span class="keywordtype">bool</span> <a class="code" href="namespaceTileFeatureScaleRange.html#a3">save</a>( <a class="code" href="classDataBuffer.html">DataBuffer</a>* data, <a class="code" href="classDataBuffer.html">DataBuffer</a>* featureData, 
00104                  <a class="code" href="Types_8h.html#a21">uint32</a> nbrFeatures ) <span class="keyword">const</span>;
00105 
00106 
00114       <a class="code" href="Types_8h.html#a21">uint32</a> getMapSize() <span class="keyword">const</span>;
00115       
00118       <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getScaleLevel() <span class="keyword">const</span>;
00119 
00122       <span class="keyword">inline</span> <span class="keywordtype">void</span> setScaleLevel(<a class="code" href="Types_8h.html#a21">uint32</a> newScale);
00123 
00128       <a class="code" href="Types_8h.html#a21">uint32</a> getNbrFeatures() <span class="keyword">const</span>;
00129 
00137       <span class="keyword">const</span> <a class="code" href="classGfxFeature.html">GfxFeature</a>* getFeature( <a class="code" href="Types_8h.html#a21">uint32</a> index ) <span class="keyword">const</span>;
00138       
00147       <span class="keywordtype">void</span> addFeature( <a class="code" href="classGfxFeature.html">GfxFeature</a>* feature );
00148       
00156       <span class="keywordtype">bool</span> removeFeature( <a class="code" href="Types_8h.html#a21">uint32</a> index );
00157       
00163       <span class="keywordtype">void</span> setMC2BoundingBox(<span class="keyword">const</span> <a class="code" href="classMC2BoundingBox.html">MC2BoundingBox</a>* bbox);
00164 
00171       <span class="keywordtype">void</span> getMC2BoundingBox(<a class="code" href="classMC2BoundingBox.html">MC2BoundingBox</a>* bbox);
00172 
<a name="l00178"></a><a class="code" href="classGfxFeatureMap.html#a16">00178</a>       <span class="keywordtype">void</span> setScreenSize(uint16 screenX, uint16 screenY) {
00179          setScreenSize( <a class="code" href="classScreenSize.html">ScreenSize</a>( screenX, screenY ) );
00180       }
00181 
00183       <span class="keywordtype">void</span> setScreenSize( <span class="keyword">const</span> <a class="code" href="classScreenSize.html">ScreenSize</a>&amp; size );
00184 
00190       <span class="keyword">inline</span> ScreenSize::ValueType getScreenX() <span class="keyword">const</span>;
00192       <span class="keyword">inline</span> ScreenSize::ValueType getScreenY() <span class="keyword">const</span>;
00193 
00195       <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classScreenSize.html">ScreenSize</a>&amp; getScreenSize() <span class="keyword">const</span>;
00196 
00202       <span class="keywordtype">void</span> dump(<span class="keywordtype">int</span> verboseLevel = 1) <span class="keyword">const</span>;
00203 
00207       <span class="keywordtype">void</span> printStatistics(<span class="keywordtype">int</span> verboseLevel = 1);
00208       
00209 
00220       <span class="keywordtype">int</span> mergeInto(<a class="code" href="classGfxFeatureMap.html">GfxFeatureMap</a>* otherMap,
00221                     <span class="keywordtype">bool</span> keepOrder = <span class="keyword">true</span> );
00222 
00223 
00226       <span class="keywordtype">void</span> recalculateLevelAndSplitRoads();
00227 
00228 
00238          <span class="keyword">inline</span> <span class="keywordtype">void</span> setTransportationType(
00239             ItemTypes::transportation_t transpType );
00240          
00246          <span class="keyword">inline</span> ItemTypes::transportation_t getTransportationType() <span class="keyword">const</span>;
00247 
00253          <span class="keyword">inline</span> <span class="keywordtype">void</span> setStartingAngle( uint8 angle );
00254          
00261          <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a17">uint8</a> getStartingAngle() <span class="keyword">const</span>;
00262          
00267          <span class="keyword">inline</span> <span class="keywordtype">void</span> setDrivingOnRightSide( <span class="keywordtype">bool</span> drivingOnRightSide );
00268          
00273          <span class="keyword">inline</span> <span class="keywordtype">bool</span> getDrivingOnRightSide() <span class="keyword">const</span>;
00274 
00280          <span class="keyword">inline</span> <span class="keywordtype">void</span> setInitialUTurn( <span class="keywordtype">bool</span> initialUTurn );
00281          
00287          <span class="keyword">inline</span> <span class="keywordtype">bool</span> getInitialUTurn() <span class="keyword">const</span>;
00288 
00293          <span class="keywordtype">void</span> mergeRouteSettings( <span class="keyword">const</span> <a class="code" href="classGfxFeatureMap.html">GfxFeatureMap</a>* otherMap );
00295      
00299       <span class="keywordtype">void</span> removeDuplicates();
00300       
00305       <span class="keywordtype">void</span> getUniqueFeatures( <a class="code" href="classvector.html">vector&lt;const GfxFeature*&gt;</a>&amp; uniques,
00306                               GfxFeature::gfxFeatureType type ) <span class="keyword">const</span>; 
00307          
00314       <span class="keyword">inline</span> <a class="code" href="classGfxFeature.html">GfxFeature</a>* getAndRemoveLastFeature();
00315 
00328       <a class="code" href="Types_8h.html#a25">byte</a>* getAsSimpleMapData( <span class="keywordtype">int</span> version,
00329                                 uint32&amp; outSize ) <span class="keyword">const</span>;
00330       
00334       <span class="keywordtype">void</span> reverseFeatures();
00335 
00336  
<a name="l00338"></a><a class="code" href="classGfxFeatureMap.html#w0">00338</a>       <span class="keyword">typedef</span> GfxFeatureVector::const_iterator const_iterator;
00339 
00340 
<a name="l00342"></a><a class="code" href="classGfxFeatureMap.html#a30">00342</a>       const_iterator begin()<span class="keyword"> const </span>{
00343          <span class="keywordflow">return</span> m_features.begin();
00344       }
00345 
<a name="l00347"></a><a class="code" href="classGfxFeatureMap.html#a31">00347</a>       const_iterator end()<span class="keyword"> const </span>{
00348          <span class="keywordflow">return</span> m_features.end();
00349       }
00350 
<a name="l00352"></a><a class="code" href="classGfxFeatureMap.html#w1">00352</a>       <span class="keyword">typedef</span> GfxFeatureVector::iterator iterator;
00353 
<a name="l00355"></a><a class="code" href="classGfxFeatureMap.html#a32">00355</a>       iterator begin() {
00356          <span class="keywordflow">return</span> m_features.begin();
00357       }
00358 
<a name="l00360"></a><a class="code" href="classGfxFeatureMap.html#a33">00360</a>       iterator end() { 
00361          <span class="keywordflow">return</span> m_features.end();
00362       }
00363 
00364    
00365    <span class="keyword">private</span>:
00372       <a class="code" href="classGfxFeature.html">GfxFeature</a>* getAndRemoveFirstFeature();
00373    
<a name="l00377"></a><a class="code" href="classGfxFeatureMap.html#r0">00377</a>       <a class="code" href="classMC2BoundingBox.html">MC2BoundingBox</a> m_bbox;
00378       
<a name="l00382"></a><a class="code" href="classGfxFeatureMap.html#r1">00382</a>       <a class="code" href="classScreenSize.html">ScreenSize</a> m_screenSize;
00383 
<a name="l00389"></a><a class="code" href="classGfxFeatureMap.html#r2">00389</a>       <a class="code" href="Types_8h.html#a21">uint32</a> m_scaleLevel;
00390       
<a name="l00394"></a><a class="code" href="classGfxFeatureMap.html#r3">00394</a>       <a class="code" href="GfxFeatureMap_8h.html#a0">GfxFeatureVector</a> m_features;
00395 
<a name="l00399"></a><a class="code" href="classGfxFeatureMap.html#r4">00399</a>       <a class="code" href="Types_8h.html#a21">uint32</a> m_featureSize;
00400 
<a name="l00406"></a><a class="code" href="classGfxFeatureMap.html#r5">00406</a>       ItemTypes::transportation_t m_transportationType;
00407 
<a name="l00413"></a><a class="code" href="classGfxFeatureMap.html#r6">00413</a>       <a class="code" href="Types_8h.html#a17">uint8</a> m_startingAngle;
00414 
<a name="l00420"></a><a class="code" href="classGfxFeatureMap.html#r7">00420</a>       <span class="keywordtype">bool</span> m_drivingOnRightSide;
00421 
<a name="l00427"></a><a class="code" href="classGfxFeatureMap.html#r8">00427</a>       <span class="keywordtype">bool</span> m_initialUTurn;
00428 };
00429 
00430 <span class="comment">// =======================================================================</span>
00431 <span class="comment">//                                     Implementation of inlined methods =</span>
00432 
00433 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> 
<a name="l00434"></a><a class="code" href="classGfxFeatureMap.html#a8">00434</a> <a class="code" href="classGfxFeatureMap.html#a8">GfxFeatureMap::getScaleLevel</a>()<span class="keyword"> const</span>
00435 <span class="keyword"></span>{
00436    <span class="keywordflow">return</span> (m_scaleLevel);
00437 }
00438 
00439 <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00440"></a><a class="code" href="classGfxFeatureMap.html#a9">00440</a> <a class="code" href="classGfxFeatureMap.html#a9">GfxFeatureMap::setScaleLevel</a>(uint32 newScale)
00441 {
00442    <a class="code" href="classGfxFeatureMap.html#r2">m_scaleLevel</a> = newScale;
00443 }
00444 
00445 <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00446"></a><a class="code" href="classGfxFeatureMap.html#z511_0">00446</a> <a class="code" href="classGfxFeatureMap.html#z511_0">GfxFeatureMap::setTransportationType</a>(
00447             ItemTypes::transportation_t transpType )
00448 {
00449    <a class="code" href="classGfxFeatureMap.html#r5">m_transportationType</a> = transpType;
00450 }
00451 
00452 <span class="keyword">inline</span> ItemTypes::transportation_t 
<a name="l00453"></a><a class="code" href="classGfxFeatureMap.html#z511_1">00453</a> <a class="code" href="classGfxFeatureMap.html#z511_1">GfxFeatureMap::getTransportationType</a>()<span class="keyword"> const </span>{
00454    <span class="keywordflow">return</span> m_transportationType;
00455 }
00456 
00457 <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00458"></a><a class="code" href="classGfxFeatureMap.html#z511_2">00458</a> <a class="code" href="classGfxFeatureMap.html#z511_2">GfxFeatureMap::setStartingAngle</a>( uint8 angle ) {
00459    <a class="code" href="classGfxFeatureMap.html#r6">m_startingAngle</a> = angle;
00460 }
00461 
00462 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a17">uint8</a> 
<a name="l00463"></a><a class="code" href="classGfxFeatureMap.html#z511_3">00463</a> <a class="code" href="classGfxFeatureMap.html#z511_3">GfxFeatureMap::getStartingAngle</a>()<span class="keyword"> const </span>{
00464    <span class="keywordflow">return</span> m_startingAngle;
00465 }
00466 
00467 <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00468"></a><a class="code" href="classGfxFeatureMap.html#z511_4">00468</a> <a class="code" href="classGfxFeatureMap.html#z511_4">GfxFeatureMap::setDrivingOnRightSide</a>( <span class="keywordtype">bool</span> drivingOnRightSide ) {
00469    <a class="code" href="classGfxFeatureMap.html#r7">m_drivingOnRightSide</a> = drivingOnRightSide;
00470 }
00471 
00472 <span class="keyword">inline</span> <span class="keywordtype">bool</span> 
<a name="l00473"></a><a class="code" href="classGfxFeatureMap.html#z511_5">00473</a> <a class="code" href="classGfxFeatureMap.html#z511_5">GfxFeatureMap::getDrivingOnRightSide</a>()<span class="keyword"> const </span>{
00474    <span class="keywordflow">return</span> m_drivingOnRightSide;
00475 }
00476 
00477 <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00478"></a><a class="code" href="classGfxFeatureMap.html#z511_6">00478</a> <a class="code" href="classGfxFeatureMap.html#z511_6">GfxFeatureMap::setInitialUTurn</a>( <span class="keywordtype">bool</span> initialUTurn ) {
00479    <a class="code" href="classGfxFeatureMap.html#r8">m_initialUTurn</a> = initialUTurn;
00480 }
00481 
00482 <span class="keyword">inline</span> <span class="keywordtype">bool</span> 
<a name="l00483"></a><a class="code" href="classGfxFeatureMap.html#z511_7">00483</a> <a class="code" href="classGfxFeatureMap.html#z511_7">GfxFeatureMap::getInitialUTurn</a>()<span class="keyword"> const </span>{
00484    <span class="keywordflow">return</span> m_initialUTurn;
00485 }
00486 
00487 <span class="keyword">inline</span> <a class="code" href="classGfxFeature.html">GfxFeature</a>* 
<a name="l00488"></a><a class="code" href="classGfxFeatureMap.html#a27">00488</a> <a class="code" href="classGfxFeatureMap.html#a27">GfxFeatureMap::getAndRemoveLastFeature</a>() {
00489    <a class="code" href="classGfxFeature.html">GfxFeature</a>* returnValue = NULL;
00490    <span class="keywordflow">if</span> (<a class="code" href="classGfxFeatureMap.html#r3">m_features</a>.size() &gt; 0) {
00491       returnValue =  <a class="code" href="classGfxFeatureMap.html#r3">m_features</a>.back();
00492       <a class="code" href="classGfxFeatureMap.html#r3">m_features</a>.erase( <a class="code" href="classGfxFeatureMap.html#r3">m_features</a>.end() - 1 );
00493       <a class="code" href="classGfxFeatureMap.html#r4">m_featureSize</a> -= returnValue-&gt;<a class="code" href="classGfxFeature.html#a10">getSize</a>();
00494    }
00495    <span class="keywordflow">return</span> (returnValue);
00496 }
00497 
00498 <span class="keyword">inline</span> ScreenSize::ValueType
<a name="l00499"></a><a class="code" href="classGfxFeatureMap.html#a18">00499</a> <a class="code" href="classGfxFeatureMap.html#a18">GfxFeatureMap::getScreenX</a>()<span class="keyword"> const </span>{
00500    <span class="keywordflow">return</span> <a class="code" href="classGfxFeatureMap.html#r1">m_screenSize</a>.<a class="code" href="classScreenSize.html#a2">getWidth</a>();
00501 }
00502 
00503 <span class="keyword">inline</span> ScreenSize::ValueType
<a name="l00504"></a><a class="code" href="classGfxFeatureMap.html#a19">00504</a> <a class="code" href="classGfxFeatureMap.html#a19">GfxFeatureMap::getScreenY</a>()<span class="keyword"> const </span>{
00505    <span class="keywordflow">return</span> <a class="code" href="classGfxFeatureMap.html#r1">m_screenSize</a>.<a class="code" href="classScreenSize.html#a3">getHeight</a>();
00506 }
00507 
00508 <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classScreenSize.html">ScreenSize</a>&amp;
<a name="l00509"></a><a class="code" href="classGfxFeatureMap.html#a20">00509</a> <a class="code" href="classGfxFeatureMap.html#a20">GfxFeatureMap::getScreenSize</a>()<span class="keyword"> const </span>{
00510    <span class="keywordflow">return</span> m_screenSize;
00511 }
00512 
00513 
00514 <span class="preprocessor">#endif // GFX_FEATURE_MAP_H</span>
00515 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jun 30 10:11:46 2010 for mc2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
