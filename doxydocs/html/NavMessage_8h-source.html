<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mc2: NavMessage.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">Server</a>&nbsp;/&nbsp;<a class="el" href="dir_000003.html">Servers</a>&nbsp;/&nbsp;<a class="el" href="dir_000004.html">include</a></div>
<h1>NavMessage.h</h1><a href="NavMessage_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">Copyright (c) 1999 - 2010, Vodafone Group Services Ltd</span>
00003 <span class="comment">All rights reserved.</span>
00004 <span class="comment"></span>
00005 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
00008 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
00009 <span class="comment">    * Neither the name of the Vodafone Group Services Ltd nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
00010 <span class="comment"></span>
00011 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#ifndef NAVMESSAGE_H</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define NAVMESSAGE_H</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00018 <span class="preprocessor">#include "<a class="code" href="StringTable_8h.html">StringTable.h</a>"</span>
00019 <span class="preprocessor">#include "<a class="code" href="ItemTypes_8h.html">ItemTypes.h</a>"</span>
00020 
00021 <span class="preprocessor">#include "<a class="code" href="NavAddress_8h.html">NavAddress.h</a>"</span>
00022 
00023 <span class="preprocessor">#include "<a class="code" href="RouteTypes_8h.html">RouteTypes.h</a>"</span>
00024 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00025 <span class="comment">// NavMessages isn't really depending on NavSession. Funny.</span>
00026 <span class="keyword">class </span><a class="code" href="classNavSession.html">NavSession</a>;
00027 
00028 <span class="keyword">class </span>NavComm; <span class="comment">// Forward declaration</span>
00029 
<a name="l00033"></a><a class="code" href="classNavMessage.html">00033</a> <span class="keyword">class </span><a class="code" href="classNavMessage.html">NavMessage</a> {
00034 
00035 <span class="keyword">public</span>:
00036 
<a name="l00041"></a><a class="code" href="classNavMessage.html#w50">00041</a>    <span class="keyword">enum</span> MessageType {
00042       INVALID            = 0x00,
00043       PICK_ME_UP_REQ     = 0x01,
00044       PICK_ME_UP_REPLY   = 0x02,
00045       PICK_UP_REQ        = 0x03,
00046       PICK_UP_REPLY      = 0x04,
00047       ROUTE_REQ          = 0x05,
00048       ROUTE_REPLY        = 0x06,
00049       SEARCH_REQ         = 0x07,
00050       SEARCH_REPLY       = 0x08,
00051       DEST_REQ           = 0x09,
00052       DEST_REPLY         = 0x0a,
00053 
00054       GPS_ADDRESS_REQ    = 0x0b,
00055       GPS_ADDRESS_REPLY  = 0x0c,
00056       GPS_POS_REQ        = 0x0d,
00057       GPS_POS_REPLY      = 0x0e,
00058       <span class="comment">// The missing 0x0f is an very old thing, req is even below</span>
00059       POLL_SERVER_REQ    = 0x10,
00060       POLL_SERVER_REPLY  = 0x11,
00061 
00062       MAP_REQ            = 0x12,
00063       MAP_REPLY          = 0x13,
00064       FAV_REQ            = 0x14,
00065       FAV_REPLY          = 0x15,
00066 
00067       INFO_REQ           = 0x16,
00068       INFO_REPLY         = 0x17,
00069 
00070       MESSAGE_REQ        = 0x18,
00071       MESSAGE_REPLY      = 0x19,
00072       UPGRADE_REQ        = 0x1a,
00073       UPGRADE_REPLY      = 0x1b,
00074 
00075       VECTOR_MAP_REQ     = 0x1c,
00076       VECTOR_MAP_REPLY   = 0x1d,
00077 
00078       MULTI_VECTOR_MAP_REQ   = 0x1e,
00079       MULTI_VECTOR_MAP_REPLY = 0x1f,
00080 
00081       PARAMETER_REQ      = 0x20,
00082       PARAMETER_REPLY    = 0x21,
00083       CELL_REPORT        = 0x22,
00084       CELL_CONFIRM       = 0x23,
00085       GPS_INIT_REQ       = 0x30,
00086       GPS_INIT_REPLY     = 0x31,
00087       BINARY_UPLOAD_REQ  = 0x32,
00088       BINARY_UPLOAD_REPLY = 0x33,
00089       NAVALARM_REQ       = 0x40,
00090       NAVALARM_REPLY     = 0x41,
00091    };
00092    
<a name="l00100"></a><a class="code" href="classNavMessage.html#w51">00100</a>    <span class="keyword">enum</span> ReplyStatus {
00101       NAV_STATUS_OK                    = 0x00,
00102       NAV_STATUS_NOT_OK                = 0x01,
00103       NAV_STATUS_REQUEST_TIMEOUT       = 0x02,
00104       NAV_STATUS_PARAM_REQ_NOT_FIRST   = 0x03,
00105       NAV_STATUS_OUTSIDE_MAP           = 0x04,
00106       NAV_STATUS_PROTOVER_NOT_SUPPORTED= 0x05,
00107       NAV_STATUS_OUTSIDE_ALLOWED_AREA  = 0x06,
00108       NAV_STATUS_NO_TRANSACTIONS_LEFT  = 0x07,
00109 
00110       NAV_STATUS_REQUEST_SPECIFIC_MASK = 0x80
00111    };
00112 
<a name="l00117"></a><a class="code" href="classNavMessage.html#s0">00117</a>    <span class="keyword">static</span> <a class="code" href="Types_8h.html#a17">uint8</a> MAX_PROTOVER;
00118 
00128    <a class="code" href="classNavMessage.html">NavMessage</a>(<span class="keyword">const</span> <a class="code" href="classNavAddress.html">NavAddress</a>&amp; address,
00129               MessageType messType,
00130               <span class="keywordtype">bool</span> isRequest,
00131               <a class="code" href="classNavSession.html">NavSession</a> * session);
00132    
00136    <span class="keyword">virtual</span> ~<a class="code" href="classNavMessage.html">NavMessage</a>();
00137    
00141    MessageType getType() <span class="keyword">const</span>;
00142    
00147    <span class="keywordtype">void</span> setType(uint16 type);
00148    
00149    
00153    <span class="keyword">const</span> <a class="code" href="classNavAddress.html">NavAddress</a>* getAddress() <span class="keyword">const</span>;
00154    
00159    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> isRequest() <span class="keyword">const</span>;
00160 
00164    <a class="code" href="Types_8h.html#a17">uint8</a> getProtoVer() <span class="keyword">const</span>;
00165    
00170    <span class="keywordtype">void</span> setProtoVer(uint8 protoVer);
00171 
00175    <a class="code" href="Types_8h.html#a21">uint32</a> getLength() <span class="keyword">const</span>;
00176    
00181    <span class="keywordtype">void</span> setLength(uint32 length);
00182 
00186    <a class="code" href="Types_8h.html#a17">uint8</a> getReqID() <span class="keyword">const</span>;
00187    
00192    <span class="keywordtype">void</span> setReqID(uint8 <span class="keywordtype">id</span>);
00193 
00197    <span class="keywordtype">void</span> setCRC(uint32 crc);
00198 
00202    <span class="keywordtype">void</span> setNavID(uint32 navID);
00203 
00207    <a class="code" href="Types_8h.html#a21">uint32</a> getNavID() <span class="keyword">const</span>;
00208    
00212    <span class="keywordtype">void</span> setUserID(uint32 userID);
00213    
00217    <a class="code" href="Types_8h.html#a21">uint32</a> getUserID() <span class="keyword">const</span>;
00218 
00222    <span class="keywordtype">void</span> setUserName(<span class="keyword">const</span> byte* userName);
00223    
00227    <span class="keywordtype">char</span>* getUserName();
00228    
00229    
00233    <a class="code" href="Types_8h.html#a21">uint32</a> getCRC() <span class="keyword">const</span>;
00234    
00239    <span class="keywordtype">void</span>* getCookie() <span class="keyword">const</span>;
00240 
00245    <span class="keywordtype">void</span> setCookie(<span class="keywordtype">void</span>* cookie);
00246 
00251    <a class="code" href="classNavSession.html">NavSession</a> * getSession() <span class="keyword">const</span>;
00252 
<a name="l00257"></a><a class="code" href="classNavMessage.html#a23">00257</a>    <span class="keywordtype">bool</span> hasValidCoordinates() { <span class="keywordflow">return</span> m_validCoordinates; }
00258 
00265    <span class="keyword">static</span> MessageType replyType( MessageType request );
00266 
00267 
00268 <span class="keyword">protected</span>:
00269 
<a name="l00275"></a><a class="code" href="classNavMessage.html#b0">00275</a>    <a class="code" href="classNavMessage.html">NavMessage</a>() : m_address(<a class="code" href="classNavAddress.html">NavAddress</a>::ADDRESS_TYPE_NULL, <span class="stringliteral">""</span>)
00276       { cerr &lt;&lt; <span class="stringliteral">"Warning NavMessage called() "</span> &lt;&lt; endl; exit(1);}
00277    
<a name="l00281"></a><a class="code" href="classNavMessage.html#p0">00281</a>    <a class="code" href="Types_8h.html#a17">uint8</a> m_protoVer;
00282 
<a name="l00286"></a><a class="code" href="classNavMessage.html#p1">00286</a>    MessageType m_type;
00287 
<a name="l00291"></a><a class="code" href="classNavMessage.html#p2">00291</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_length;
00292 
<a name="l00296"></a><a class="code" href="classNavMessage.html#p3">00296</a>    <a class="code" href="Types_8h.html#a17">uint8</a> m_requestID;
00297 
<a name="l00301"></a><a class="code" href="classNavMessage.html#p4">00301</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_crc;
00302 
<a name="l00306"></a><a class="code" href="classNavMessage.html#p5">00306</a>    <a class="code" href="classNavAddress.html">NavAddress</a> m_address;
00307 
<a name="l00311"></a><a class="code" href="classNavMessage.html#p6">00311</a>    <span class="keywordtype">bool</span> m_isRequest;
00312 
<a name="l00316"></a><a class="code" href="classNavMessage.html#p7">00316</a>    <span class="keywordtype">void</span>* m_cookie;
00317 
<a name="l00321"></a><a class="code" href="classNavMessage.html#p8">00321</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_navID;
00322 
<a name="l00326"></a><a class="code" href="classNavMessage.html#p9">00326</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_userID;
00327 
<a name="l00331"></a><a class="code" href="classNavMessage.html#p10">00331</a>    <span class="keywordtype">char</span> m_userName[20];
00332    
<a name="l00337"></a><a class="code" href="classNavMessage.html#p11">00337</a>    <a class="code" href="classNavSession.html">NavSession</a> * m_session;
00338 
<a name="l00343"></a><a class="code" href="classNavMessage.html#p12">00343</a>    <span class="keywordtype">bool</span> m_validCoordinates;
00344 };
00345 
<a name="l00346"></a><a class="code" href="classOutGoingNavMessage.html">00346</a> <span class="keyword">class </span><a class="code" href="classOutGoingNavMessage.html">OutGoingNavMessage</a> : <span class="keyword">public</span> <a class="code" href="classNavMessage.html">NavMessage</a> {
00347 
00348 <span class="keyword">public</span>:
00349 
00358    <a class="code" href="classOutGoingNavMessage.html#a0">OutGoingNavMessage</a>(<span class="keyword">const</span> <a class="code" href="classNavAddress.html">NavAddress</a>&amp; recipientAddress,
00359                       MessageType type,
00360                       <span class="keywordtype">bool</span> isRequest,
00361                       <a class="code" href="classNavSession.html">NavSession</a> * session);
00362 
00366    <span class="keyword">virtual</span> <a class="code" href="classOutGoingNavMessage.html#a1">~OutGoingNavMessage</a>();
00367    
00368    
00377    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classOutGoingNavMessage.html#a2">convertToBytes</a>(<a class="code" href="Types_8h.html#a25">byte</a>* buf,
00378                                <span class="keywordtype">int</span> bufSize) = 0;
00379 
00385    <span class="keywordtype">void</span> <a class="code" href="classOutGoingNavMessage.html#a3">setStatus</a>( <a class="code" href="Types_8h.html#a17">uint8</a> status );
00386 
00392    <a class="code" href="Types_8h.html#a17">uint8</a> <a class="code" href="classOutGoingNavMessage.html#a4">getStatus</a>() <span class="keyword">const</span>;
00393 
00394 
00398    <span class="keyword">virtual</span> <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classOutGoingNavMessage.html#a5">getReplySize</a>() <span class="keyword">const</span>;
00399 
00400 
00401 <span class="keyword">private</span>:
00402 
<a name="l00406"></a><a class="code" href="classOutGoingNavMessage.html#r0">00406</a>    <a class="code" href="Types_8h.html#a17">uint8</a> m_status;
00407 };
00408 
<a name="l00409"></a><a class="code" href="classIncomingNavMessage.html">00409</a> <span class="keyword">class </span><a class="code" href="classIncomingNavMessage.html">IncomingNavMessage</a> : <span class="keyword">public</span> <a class="code" href="classNavMessage.html">NavMessage</a> {
00410 
00411 <span class="keyword">public</span>:
00412 
00421    <a class="code" href="classIncomingNavMessage.html#a0">IncomingNavMessage</a>(<span class="keyword">const</span> <a class="code" href="classNavAddress.html">NavAddress</a>&amp; senderAddress,
00422                       MessageType type,
00423                       <span class="keywordtype">bool</span> isRequest,
00424                       <a class="code" href="classNavSession.html">NavSession</a> * session);
00425 
00429    <span class="keyword">virtual</span> <a class="code" href="classIncomingNavMessage.html#a1">~IncomingNavMessage</a>();
00430    
00439    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classIncomingNavMessage.html#a2">convertFromBytes</a>(<span class="keyword">const</span> <a class="code" href="Types_8h.html#a25">byte</a>* buf,
00440                                  <span class="keywordtype">int</span> bufSize);
00441 
<a name="l00447"></a><a class="code" href="classIncomingNavMessage.html#a3">00447</a>    NavComm* <a class="code" href="classIncomingNavMessage.html#a3">getComm</a>()<span class="keyword"> const </span>{
00448       <span class="keywordflow">return</span> m_comm;
00449    }
00450 
<a name="l00454"></a><a class="code" href="classIncomingNavMessage.html#a4">00454</a>    <span class="keywordtype">void</span> <a class="code" href="classIncomingNavMessage.html#a4">setComm</a>(NavComm* comm) {
00455       <a class="code" href="classIncomingNavMessage.html#r0">m_comm</a> = comm;
00456    }
00457 
00458 <span class="keyword">private</span>:
00459    
<a name="l00463"></a><a class="code" href="classIncomingNavMessage.html#r0">00463</a>    NavComm* m_comm;
00464    
00465 };
00466 
00467 
00468 <span class="comment">/* Implementation of inlined methods */</span>
00469 
00470 <span class="preprocessor">#endif</span>
00471 <span class="preprocessor"></span>
00472 
00473 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jun 30 10:11:48 2010 for mc2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
