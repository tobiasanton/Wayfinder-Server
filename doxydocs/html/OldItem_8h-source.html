<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mc2: OldItem.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">Server</a>&nbsp;/&nbsp;<a class="el" href="dir_000007.html">MapGen</a>&nbsp;/&nbsp;<a class="el" href="dir_000034.html">include</a></div>
<h1>OldItem.h</h1><a href="OldItem_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">Copyright (c) 1999 - 2010, Vodafone Group Services Ltd</span>
00003 <span class="comment">All rights reserved.</span>
00004 <span class="comment"></span>
00005 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
00008 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
00009 <span class="comment">    * Neither the name of the Vodafone Group Services Ltd nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
00010 <span class="comment"></span>
00011 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#ifndef OLDITEM_H</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define OLDITEM_H</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00018 
00019 <span class="preprocessor">#include "<a class="code" href="ArrayTools_8h.html">ArrayTools.h</a>"</span>
00020 <span class="preprocessor">#include "<a class="code" href="ItemTypes_8h.html">ItemTypes.h</a>"</span>
00021 <span class="preprocessor">#include "<a class="code" href="NameUtility_8h.html">NameUtility.h</a>"</span>
00022 <span class="preprocessor">#include "<a class="code" href="GMSGfxData_8h.html">GMSGfxData.h</a>"</span>
00023 
00024 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00025 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00026 
00027 <span class="comment">// Foreward declarations</span>
00028 <span class="keyword">class </span><a class="code" href="classOldItem.html">OldItem</a>;
00029 <span class="keyword">class </span><a class="code" href="classOldGenericMap.html">OldGenericMap</a>;
00030 <span class="keyword">class </span><a class="code" href="classOldItemNames.html">OldItemNames</a>;
00031 <span class="keyword">class </span><a class="code" href="classDataBuffer.html">DataBuffer</a>;
00032 <span class="keyword">class </span><a class="code" href="classGfxData.html">GfxData</a>;
00033 <span class="keyword">class </span><a class="code" href="classGMSGfxData.html">GMSGfxData</a>;
00034 <span class="keyword">class </span><a class="code" href="classCoordinateTransformer.html">CoordinateTransformer</a>;
00035 
<a name="l00042"></a><a class="code" href="classOldItem.html">00042</a> <span class="keyword">class </span><a class="code" href="classOldItem.html">OldItem</a> {
00043       
<a name="l00047"></a><a class="code" href="OldItem_8h.html#a0">00047</a> <span class="preprocessor">      #define GET_ZOOMLEVEL(id) ( ((id) &gt;&gt; 27) &amp; 0x0f)</span>
00048 <span class="preprocessor"></span>
<a name="l00049"></a><a class="code" href="OldItem_8h.html#a1">00049</a> <span class="preprocessor">      #define GET_INDEXINZOOM(id) ( (id) &amp; 0x07ffffff)</span>
00050 <span class="preprocessor"></span>
<a name="l00051"></a><a class="code" href="OldItem_8h.html#a2">00051</a> <span class="preprocessor">      #define CREATE_ITEMID(z, i) ( ((uint32(z) &amp; 0x0f) &lt;&lt; 27) |\</span>
00052 <span class="preprocessor">                                     (uint32(i) &amp; 0x07ffffff))</span>
00053 <span class="preprocessor"></span>   
00054    <span class="keyword">public</span>:
00066       <span class="keyword">static</span> <span class="keywordtype">void</span> writeGenericMifHeader(uint32 nbrCol, ofstream&amp; mifFile,
00067                         CoordinateTransformer::format_t coordsys 
00068                            = CoordinateTransformer::mc2,
00069                         <span class="keywordtype">bool</span> coordOrderLatLon = <span class="keyword">true</span>);
00070       
00078       <span class="keyword">static</span> <a class="code" href="classOldItem.html">OldItem</a>* createNewItem(<a class="code" href="classDataBuffer.html">DataBuffer</a>* dataBuffer, <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap);
00079 
<a name="l00084"></a><a class="code" href="OldItem_8h.html#a3">00084</a> <span class="preprocessor">      #define ITEMID_MASK 0x7fffffff</span>
00085 <span class="preprocessor"></span>
<a name="l00090"></a><a class="code" href="OldItem_8h.html#a4">00090</a> <span class="preprocessor">      #define ITEM_AS_STRING_LENGTH 4096</span>
00091 <span class="preprocessor"></span>
<a name="l00095"></a><a class="code" href="classOldItem.html#a0">00095</a>       <span class="keyword">inline</span> <a class="code" href="classOldItem.html">OldItem</a>() { <a class="code" href="MC2Logging_8h.html#a1">MINFO</a>(<span class="stringliteral">"OldItem()"</span>); };
00096       
00102       <a class="code" href="classOldItem.html">OldItem</a>(ItemTypes::itemType type, uint32 <span class="keywordtype">id</span> = MAX_UINT32);
00103 
00107       <span class="keyword">virtual</span> ~<a class="code" href="classOldItem.html">OldItem</a>();
00108       
00117       <span class="keyword">virtual</span> <span class="keywordtype">void</span> printMidMif(ofstream&amp; midFile, ofstream&amp; mifFile,
00118                      <a class="code" href="classOldItemNames.html">OldItemNames</a>* namePointer);
00119 
00126       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> createFromMidMif(ifstream&amp; midFile,
00127                                     <span class="keywordtype">bool</span> readRestOfLine = <span class="keyword">true</span>);
00128 
00156       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> updateAttributesFromItem(<a class="code" href="classOldItem.html">OldItem</a>* otherItem,
00157                                             <span class="keywordtype">bool</span> sameMap = <span class="keyword">true</span>);
00158 
00169          <span class="keyword">inline</span> LangTypes::language_t getNameLanguage(byte offset) <span class="keyword">const</span>;
00170 
00176          <span class="keyword">inline</span> ItemTypes::name_t getNameType(byte offset) <span class="keyword">const</span>;
00177 
00185          <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getStringIndex(byte offset) <span class="keyword">const</span>;
00186          
00195          <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getRawStringIndex(byte offset) <span class="keyword">const</span>;
00196 
00209          <span class="keyword">inline</span> <span class="keywordtype">bool</span> getNameAndType(byte offset, 
00210                                     LangTypes::language_t&amp; strLang, 
00211                                     ItemTypes::name_t&amp; strType, 
00212                                     uint32&amp; strIndex) <span class="keyword">const</span>;
00213 
00228          <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getNameWithType(ItemTypes::name_t strType, 
00229                                        LangTypes::language_t strLang) <span class="keyword">const</span>;
00230 
00238          <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getBestRawName( LangTypes::language_t reqLang,
00239                                        <span class="keywordtype">bool</span> acceptUniqueName = <span class="keyword">true</span> ) <span class="keyword">const</span>;
00240 
00249          <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getBestRawName( LangTypes::language_t reqLang,
00250                                        ItemTypes::name_t reqType,
00251                                        set&lt;uint32&gt;* usedStrings = NULL) <span class="keyword">const</span>;
00252 
00260          <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getBestRawName(
00261             <span class="keyword">const</span> <a class="code" href="classvector.html">vector&lt;LangTypes::language_t&gt;</a>&amp; reqLangs,
00262             <span class="keywordtype">bool</span> acceptUniqueName = <span class="keyword">true</span> ) <span class="keyword">const</span>;
00263 
00273          <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
00274             getBestRawNameOfType( ItemTypes::name_t    nameType,
00275                                   LangTypes::language_t reqLang,
00276                                   set&lt;uint32&gt;* usedStrings = NULL) <span class="keyword">const</span>;
00277 
00287          <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getBestRawNameOfType(
00288             ItemTypes::name_t nameType,
00289             <span class="keyword">const</span> <a class="code" href="classvector.html">vector&lt;LangTypes::language_t&gt;</a>&amp; reqLangs ) <span class="keyword">const</span>;
00290          
00295          <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a25">byte</a> getNbrNames() <span class="keyword">const</span>;
00296 
00306          <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a25">byte</a> getNbrNamesWithType(ItemTypes::name_t types) <span class="keyword">const</span>;
00307 
00309      
00324          <span class="keywordtype">bool</span> setNameType(byte offset, ItemTypes::name_t type);
00325 
00333          <span class="keywordtype">bool</span> setNameLanguage(byte offset, LangTypes::language_t lang);
00335      
00336 
00342 
00354       <span class="keywordtype">bool</span> hasSameNames(<span class="keyword">const</span> <a class="code" href="classOldItem.html">OldItem</a>* item) <span class="keyword">const</span>;
00355 
00356 
00366       <span class="keywordtype">bool</span> hasCommonName(<span class="keyword">const</span> <a class="code" href="classOldItem.html">OldItem</a>* item) <span class="keyword">const</span>;
00367 
00376       <span class="keywordtype">bool</span> hasCommonLangName(<span class="keyword">const</span> <a class="code" href="classOldItem.html">OldItem</a>* item) <span class="keyword">const</span>;
00377 
00386       <span class="keywordtype">bool</span> hasAllLangNames(<span class="keyword">const</span> <a class="code" href="classOldItem.html">OldItem</a>* item) <span class="keyword">const</span>;
00387 
00394       <a class="code" href="classvector.html">vector&lt;uint32&gt;</a> getCommonStrIdxes(<span class="keyword">const</span> <a class="code" href="classOldItem.html">OldItem</a>* item) <span class="keyword">const</span>;
00396 
00401       <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getID () <span class="keyword">const </span>;
00402 
00407       <span class="keyword">inline</span> <span class="keywordtype">void</span> setID(uint32 ID);
00408       
00414       <span class="keyword">inline</span> <a class="code" href="classGMSGfxData.html">GMSGfxData</a>* getGfxData() <span class="keyword">const</span>;
00415 
00428       <span class="keywordtype">void</span> setGfxData(<a class="code" href="classGfxDataFull.html">GfxDataFull</a>* gfx, <span class="keywordtype">bool</span> deleteOld = <span class="keyword">false</span>);
00429 
00437       <a class="code" href="Types_8h.html#a21">uint32</a> getLength() <span class="keyword">const</span>;
00438 
00446       <span class="keyword">inline</span> ItemTypes::itemType getItemType() <span class="keyword">const</span>;
00447       
00456       <span class="keywordtype">int</span> addName(LangTypes::language_t lang, ItemTypes::name_t type, 
00457                   uint32 nameID);
00458 
00469          <span class="keywordtype">bool</span> removeNameWithOffset(uint32 i);
00470 
00475          <span class="keywordtype">bool</span> removeAllNames();
00477 
00483       <span class="keyword">virtual</span> <span class="keywordtype">char</span> *<a class="code" href="namespaceRequestTime.html#a4">toString</a>(); 
00484 
00489       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="namespaceTileFeatureScaleRange.html#a3">save</a>(<a class="code" href="classDataBuffer.html">DataBuffer</a>* dataBuffer) <span class="keyword">const </span>;
00490 
00491 
00492       <span class="keyword">inline</span> <span class="keywordtype">bool</span> memberOfGroup(uint32 groupID) <span class="keyword">const</span>;
00493 
00494 
00499       <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getNbrGroups() <span class="keyword">const</span>;
00500 
00506       <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getGroup(uint32 i) <span class="keyword">const</span>;
00507 
00511       <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getUnmaskedGroup(uint32 i) <span class="keyword">const</span>;
00512 
00521       <span class="keyword">inline</span> <span class="keywordtype">bool</span> setGroup(uint32 i, uint32 groupID);
00522       
00529       <span class="keyword">inline</span> <span class="keywordtype">bool</span> removeGroup(uint32 i);
00530             
00537       <span class="keyword">inline</span> <span class="keywordtype">bool</span> removeGroupWithID(uint32 <span class="keywordtype">id</span>);
00538 
00539 
00545       <span class="keywordtype">bool</span> removeAllGroups();
00546 
00547 
00553       <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a17">uint8</a> getSource() <span class="keyword">const</span>;
00554 
00559       <span class="keyword">inline</span> <span class="keywordtype">void</span> setSource(uint8 newSource);
00560 
00567       <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* getItemTypeAsString( 
00568                                        StringTable::languageCode lc = 
00569                                           StringTable::ENGLISH ) <span class="keyword">const</span>;
00570          
00575       <span class="keyword">virtual</span> <a class="code" href="Types_8h.html#a21">uint32</a> getMemoryUsage() <span class="keyword">const</span>;
00576 
00577 
00578 
<a name="l00582"></a><a class="code" href="classOldItem.html#a27">00582</a>    <span class="keyword">const</span> <a class="code" href="Types_8h.html#a21">uint32</a> *getNames()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_names; }
00583 
<a name="l00587"></a><a class="code" href="classOldItem.html#a28">00587</a>    <span class="keyword">const</span> <a class="code" href="Types_8h.html#a21">uint32</a> *getGroups()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_groups; }
00588 
00594    <a class="code" href="Types_8h.html#a21">uint32</a> getOfficialCode(<span class="keyword">const</span> <a class="code" href="classOldGenericMap.html">OldGenericMap</a>&amp; theMap) <span class="keyword">const</span>;
00595 
00601    <span class="keywordtype">void</span> setOfficialCode(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>&amp; theMap, uint32 officialCode);
00602 
00615    set&lt;uint16&gt; getCategories(<span class="keyword">const</span> <a class="code" href="classOldGenericMap.html">OldGenericMap</a>&amp; theMap) <span class="keyword">const</span>;
00616 
00621    <span class="keywordtype">void</span> addCategory(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>&amp; theMap, uint16 categoryID);
00622 
00627    <span class="keywordtype">void</span> addCategories(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>&amp; theMap, 
00628                       <span class="keyword">const</span> set&lt;uint16&gt;&amp; poiCategories );
00629 
00634    <span class="keywordtype">void</span> removeCategories(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>&amp; theMap);
00636 
00637 
00638 
00639   <span class="keyword">protected</span>:
00643       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> createFromDataBuffer(<a class="code" href="classDataBuffer.html">DataBuffer</a>* dataBuffer, 
00644                                         <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap);
00645 
<a name="l00650"></a><a class="code" href="classOldItem.html#t0">00650</a>       <span class="keyword">static</span> <span class="keywordtype">char</span> itemAsString[ITEM_AS_STRING_LENGTH];
00651       
00656       <span class="keyword">virtual</span> <span class="keywordtype">void</span> init(ItemTypes::itemType type);
00657       
00668       <span class="keywordtype">bool</span> addGroup(uint32 groupID);
00669 
<a name="l00676"></a><a class="code" href="classOldItem.html#p0">00676</a>       <a class="code" href="Types_8h.html#a21">uint32</a>* m_names;
00677 
<a name="l00682"></a><a class="code" href="classOldItem.html#p1">00682</a>       <a class="code" href="Types_8h.html#a21">uint32</a>* m_groups;
00683 
<a name="l00691"></a><a class="code" href="classOldItem.html#p2">00691</a>       <a class="code" href="Types_8h.html#a21">uint32</a> m_localID;
00692 
<a name="l00696"></a><a class="code" href="classOldItem.html#p3">00696</a>       <a class="code" href="classGfxDataFull.html">GfxDataFull</a>* m_gfxData;
00697 
<a name="l00701"></a><a class="code" href="classOldItem.html#p4">00701</a>       <a class="code" href="Types_8h.html#a25">byte</a> m_nbrNames;
00702 
<a name="l00706"></a><a class="code" href="classOldItem.html#p5">00706</a>       <a class="code" href="Types_8h.html#a21">uint32</a> m_nbrGroups;
00707 
<a name="l00713"></a><a class="code" href="classOldItem.html#p6">00713</a>       <a class="code" href="Types_8h.html#a25">byte</a> m_type;
00714 
<a name="l00718"></a><a class="code" href="classOldItem.html#p7">00718</a>       <a class="code" href="Types_8h.html#a25">byte</a> m_source;
00719 
<a name="l00720"></a><a class="code" href="classOldItem.html#n0">00720</a>       <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classGMSItem.html">GMSItem</a>;
<a name="l00721"></a><a class="code" href="classOldItem.html#n1">00721</a>       <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classOldGenericMap.html">OldGenericMap</a>;
00722 };
00723 
00724 
00725 <span class="comment">// ========================================================================</span>
00726 <span class="comment">//                                       Implementation ofinlined methods =</span>
00727 
00728 <span class="keyword">inline</span> LangTypes::language_t 
<a name="l00729"></a><a class="code" href="classOldItem.html#z224_0">00729</a> <a class="code" href="classOldItem.html#z224_0">OldItem::getNameLanguage</a>(byte offset)<span class="keyword"> const</span>
00730 <span class="keyword"></span>{
00731    <span class="keywordflow">if</span> ((offset &lt; m_nbrNames) &amp;&amp; (m_nbrNames &gt; 0)) {
00732       <span class="keywordflow">if</span>(<a class="code" href="classOldItem.html#z224_1">getNameType</a>(offset) == ItemTypes::roadNumber)
00733          <span class="keywordflow">return</span> (LangTypes::invalidLanguage);
00734       <span class="keywordflow">return</span> (<a class="code" href="ItemTypes_8h.html#a4">GET_STRING_LANGUAGE</a>(<a class="code" href="classOldItem.html#p0">m_names</a>[offset]));
00735    } <span class="keywordflow">else</span> {
00736       <span class="keywordflow">return</span> (LangTypes::invalidLanguage);
00737    }
00738 }
00739 
00740 <span class="keyword">inline</span> ItemTypes::name_t 
<a name="l00741"></a><a class="code" href="classOldItem.html#z224_1">00741</a> <a class="code" href="classOldItem.html#z224_1">OldItem::getNameType</a>(byte offset)<span class="keyword"> const</span>
00742 <span class="keyword"></span>{
00743    <span class="keywordflow">if</span> ((offset &lt; m_nbrNames) &amp;&amp; (m_nbrNames &gt; 0)) {
00744       <span class="keywordflow">return</span> (<a class="code" href="ItemTypes_8h.html#a7">GET_STRING_TYPE</a>(<a class="code" href="classOldItem.html#p0">m_names</a>[offset]));
00745    } <span class="keywordflow">else</span> {
00746       <span class="keywordflow">return</span> (ItemTypes::invalidName);
00747    }
00748 }
00749 
00750 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00751"></a><a class="code" href="classOldItem.html#z224_3">00751</a> <a class="code" href="classOldItem.html#z224_3">OldItem::getRawStringIndex</a>(byte offset)<span class="keyword"> const</span>
00752 <span class="keyword"></span>{
00753    <span class="keywordflow">if</span> (<a class="code" href="classOldItem.html#p4">m_nbrNames</a> == 0)
00754       <span class="keywordflow">return</span> (0);
00755    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (offset &lt; m_nbrNames)
00756       <span class="keywordflow">return</span> (<a class="code" href="classOldItem.html#p0">m_names</a>[offset]);
00757    <span class="keywordflow">else</span>
00758       <span class="keywordflow">return</span> (MAX_UINT32);
00759 }
00760 
00761 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> 
<a name="l00762"></a><a class="code" href="classOldItem.html#z224_2">00762</a> <a class="code" href="classOldItem.html#z224_2">OldItem::getStringIndex</a>(byte offset)<span class="keyword"> const</span>
00763 <span class="keyword"></span>{
00764    <a class="code" href="Types_8h.html#a21">uint32</a> res = <a class="code" href="classOldItem.html#z224_3">getRawStringIndex</a>(offset);
00765    <span class="keywordflow">if</span> (res != MAX_UINT32) {
00766       res = <a class="code" href="ItemTypes_8h.html#a10">GET_STRING_INDEX</a>(res);
00767    }
00768    <span class="keywordflow">return</span> res;
00769 }
00770 
00771 <span class="keyword">inline</span> <span class="keywordtype">bool</span> 
<a name="l00772"></a><a class="code" href="classOldItem.html#z224_4">00772</a> <a class="code" href="classOldItem.html#z224_4">OldItem::getNameAndType</a>(byte offset, LangTypes::language_t&amp; strLang, 
00773                      ItemTypes::name_t&amp; strType, uint32&amp; strIndex)<span class="keyword"> const</span>
00774 <span class="keyword"></span>{
00775    <span class="keywordflow">if</span> (<a class="code" href="classOldItem.html#p4">m_nbrNames</a> == 0) {
00776       strLang = LangTypes::invalidLanguage;
00777       strType = ItemTypes::invalidName;
00778       strIndex = 0;
00779       <span class="keywordflow">return</span> <span class="keyword">true</span>;
00780    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (offset &lt; m_nbrNames) {
00781       strType = <a class="code" href="ItemTypes_8h.html#a7">GET_STRING_TYPE</a>(<a class="code" href="classOldItem.html#p0">m_names</a>[offset]);
00782       <span class="keywordflow">if</span>(strType == ItemTypes::roadNumber)
00783          strLang = LangTypes::invalidLanguage;
00784       <span class="keywordflow">else</span>
00785          strLang = <a class="code" href="ItemTypes_8h.html#a4">GET_STRING_LANGUAGE</a>(<a class="code" href="classOldItem.html#p0">m_names</a>[offset]);
00786       strIndex = <a class="code" href="ItemTypes_8h.html#a10">GET_STRING_INDEX</a>(<a class="code" href="classOldItem.html#p0">m_names</a>[offset]);
00787       <span class="keywordflow">return</span> <span class="keyword">true</span>;
00788    } <span class="keywordflow">else</span> {
00789       <span class="keywordflow">return</span> <span class="keyword">false</span>;
00790    }
00791 }
00792 
00793 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> 
<a name="l00794"></a><a class="code" href="classOldItem.html#z224_5">00794</a> <a class="code" href="classOldItem.html#z224_5">OldItem::getNameWithType</a>(ItemTypes::name_t strType, 
00795                       LangTypes::language_t strLang)<span class="keyword"> const</span>
00796 <span class="keyword"></span>{
00797    <a class="code" href="Types_8h.html#a21">uint32</a> i=0;
00798    <a class="code" href="Types_8h.html#a21">uint32</a> retValue = MAX_UINT32;
00799    <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
00800    <span class="keywordflow">while</span> ((i&lt;<a class="code" href="classOldItem.html#z224_11">getNbrNames</a>()) &amp;&amp; (!found)) {
00801       ItemTypes::name_t curType;
00802       LangTypes::language_t curLang;
00803       <a class="code" href="Types_8h.html#a21">uint32</a> curIndex;
00804 
00805       <span class="keywordflow">if</span> (<a class="code" href="classOldItem.html#z224_4">getNameAndType</a>(i, curLang, curType, curIndex)) {
00806          
00807          <span class="keywordflow">if</span> ( ((strType == curType) || 
00808               (strType == ItemTypes::invalidName)) &amp;&amp;
00809               ((strLang == curLang) || 
00810               (strLang == LangTypes::invalidLanguage)) ) {
00811             found = <span class="keyword">true</span>;
00812             retValue = curIndex;
00813          } <span class="keywordflow">else</span> {
00814             i++;
00815          }
00816       } <span class="keywordflow">else</span> {
00817          found = <span class="keyword">true</span>;
00818          retValue = MAX_UINT32;
00819       }
00820 
00821    }
00822 
00823    <span class="keywordflow">return</span> (retValue);
00824 }
00825 
00826 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00827"></a><a class="code" href="classOldItem.html#z224_6">00827</a> <a class="code" href="classOldItem.html#z224_6">OldItem::getBestRawName</a>(LangTypes::language_t reqLang,
00828                      <span class="keywordtype">bool</span> acceptUniqueName)<span class="keyword"> const</span>
00829 <span class="keyword"></span>{
00830    <span class="keywordtype">int</span> idx = <a class="code" href="classNameUtility.html#e0">NameUtility::getBestName</a>(<a class="code" href="classOldItem.html#p4">m_nbrNames</a>,
00831                                       <a class="code" href="classOldItem.html#p0">m_names</a>,
00832                                       reqLang,
00833                                       NULL,
00834                                       acceptUniqueName);
00835    <span class="keywordflow">if</span> ( idx &lt; 0 ) {
00836       <span class="keywordflow">return</span> MAX_UINT32;
00837    } <span class="keywordflow">else</span> {
00838       <span class="keywordflow">return</span> <a class="code" href="classOldItem.html#p0">m_names</a>[idx];
00839    }
00840 }
00841 
00842 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00843"></a><a class="code" href="classOldItem.html#z224_7">00843</a> <a class="code" href="classOldItem.html#z224_6">OldItem::getBestRawName</a>(LangTypes::language_t reqLang,
00844                      ItemTypes::name_t reqType,
00845                      set&lt;uint32&gt;* usedStrings)<span class="keyword"> const</span>
00846 <span class="keyword"></span>{
00847    <span class="keywordtype">int</span> idx = <a class="code" href="classNameUtility.html#e7">NameUtility::getName</a>(<a class="code" href="classOldItem.html#p4">m_nbrNames</a>,
00848                                   <a class="code" href="classOldItem.html#p0">m_names</a>,
00849                                   reqLang,
00850                                   reqType,
00851                                   usedStrings);
00852    <span class="keywordflow">if</span> ( idx &lt; 0 ) {
00853       <span class="keywordflow">return</span> MAX_UINT32;
00854    } <span class="keywordflow">else</span> {
00855       <span class="keywordflow">return</span> <a class="code" href="classOldItem.html#p0">m_names</a>[idx];
00856    }
00857 }
00858 
00859 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00860"></a><a class="code" href="classOldItem.html#z224_8">00860</a> <a class="code" href="classOldItem.html#z224_6">OldItem::getBestRawName</a>(<span class="keyword">const</span> <a class="code" href="classvector.html">vector&lt;LangTypes::language_t&gt;</a>&amp; reqLangs,
00861                      <span class="keywordtype">bool</span> acceptUniqueName)<span class="keyword"> const</span>
00862 <span class="keyword"></span>{
00863    <span class="keywordtype">int</span> idx = <a class="code" href="classNameUtility.html#e0">NameUtility::getBestName</a>(<a class="code" href="classOldItem.html#p4">m_nbrNames</a>,
00864                                       <a class="code" href="classOldItem.html#p0">m_names</a>,
00865                                       reqLangs,
00866                                       NULL,
00867                                       acceptUniqueName);
00868    <span class="keywordflow">if</span> ( idx &lt; 0 ) {
00869       <span class="keywordflow">return</span> MAX_UINT32;
00870    } <span class="keywordflow">else</span> {
00871       <span class="keywordflow">return</span> <a class="code" href="classOldItem.html#p0">m_names</a>[idx];
00872    }
00873 }
00874 
00875 
00876 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00877"></a><a class="code" href="classOldItem.html#z224_9">00877</a> <a class="code" href="classOldItem.html#z224_9">OldItem::getBestRawNameOfType</a>(ItemTypes::name_t     nameType,
00878                            LangTypes::language_t reqLang ,
00879                            set&lt;uint32&gt;* usedStrings)<span class="keyword"> const</span>
00880 <span class="keyword"></span>{
00881    <span class="keywordtype">int</span> idx = <a class="code" href="classNameUtility.html#e4">NameUtility::getBestNameOfType</a>(<a class="code" href="classOldItem.html#p4">m_nbrNames</a>,
00882                                             <a class="code" href="classOldItem.html#p0">m_names</a>,
00883                                             reqLang,
00884                                             nameType,
00885                                             usedStrings);
00886    <span class="keywordflow">if</span> ( idx &lt; 0 ) {
00887       <span class="keywordflow">return</span> MAX_UINT32;
00888    } <span class="keywordflow">else</span> {
00889       <span class="keywordflow">return</span> <a class="code" href="classOldItem.html#p0">m_names</a>[idx];
00890    } 
00891 }
00892 
00893 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00894"></a><a class="code" href="classOldItem.html#z224_10">00894</a> <a class="code" href="classOldItem.html#z224_9">OldItem::getBestRawNameOfType</a>(ItemTypes::name_t nameType,
00895                            <span class="keyword">const</span> <a class="code" href="classvector.html">vector&lt;LangTypes::language_t&gt;</a>&amp; reqLangs)<span class="keyword"> const</span>
00896 <span class="keyword"></span>{
00897    <span class="keywordtype">int</span> idx = <a class="code" href="classNameUtility.html#e4">NameUtility::getBestNameOfType</a>(<a class="code" href="classOldItem.html#p4">m_nbrNames</a>,
00898                                             <a class="code" href="classOldItem.html#p0">m_names</a>,
00899                                             reqLangs,
00900                                             nameType);
00901    <span class="keywordflow">if</span> ( idx &lt; 0 ) {
00902       <span class="keywordflow">return</span> MAX_UINT32;
00903    } <span class="keywordflow">else</span> {
00904       <span class="keywordflow">return</span> <a class="code" href="classOldItem.html#p0">m_names</a>[idx];
00905    }
00906 }
00907 
00908 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a25">byte</a> 
<a name="l00909"></a><a class="code" href="classOldItem.html#z224_11">00909</a> <a class="code" href="classOldItem.html#z224_11">OldItem::getNbrNames</a>()<span class="keyword"> const</span>
00910 <span class="keyword"></span>{
00911    <span class="keywordflow">return</span> <a class="code" href="Types_8h.html#a25">byte</a>(<a class="code" href="classOldItem.html#p4">m_nbrNames</a>);
00912 }
00913 
00914 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a25">byte</a> 
<a name="l00915"></a><a class="code" href="classOldItem.html#z224_12">00915</a> <a class="code" href="classOldItem.html#z224_12">OldItem::getNbrNamesWithType</a>(ItemTypes::name_t type)<span class="keyword"> const</span>
00916 <span class="keyword"></span>{
00917    <span class="comment">// The value to return.</span>
00918    <a class="code" href="Types_8h.html#a25">byte</a> retVal = 0;
00919 
00920    <span class="comment">// Loop over all the names and find the names that match the given types</span>
00921    <span class="keywordflow">for</span> (<a class="code" href="Types_8h.html#a21">uint32</a> i=0; i&lt;<a class="code" href="classOldItem.html#z224_11">getNbrNames</a>(); i++) {
00922       ItemTypes::name_t strType = <a class="code" href="ItemTypes_8h.html#a7">GET_STRING_TYPE</a>(<a class="code" href="classOldItem.html#p0">m_names</a>[i]);
00923       <span class="keywordflow">if</span> ( strType == type) {
00924          retVal++;
00925       }
00926    }
00927 
00928    <span class="comment">// Return the number of found companies</span>
00929    <span class="keywordflow">return</span> (retVal);
00930 }
00931 
<a name="l00932"></a><a class="code" href="classOldItem.html#a6">00932</a> <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classOldItem.html#a6">OldItem::getID</a> ()<span class="keyword"> const</span>
00933 <span class="keyword"></span>{
00934    <span class="keywordflow">return</span> m_localID;
00935 }
00936 
<a name="l00937"></a><a class="code" href="classOldItem.html#a7">00937</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classOldItem.html#a7">OldItem::setID</a>(uint32 ID)
00938 {
00939    <a class="code" href="classOldItem.html#p2">m_localID</a> = ID;
00940 }
00941 
00942 <span class="keyword">inline</span> <a class="code" href="classGMSGfxData.html">GMSGfxData</a>* 
<a name="l00943"></a><a class="code" href="classOldItem.html#a8">00943</a> <a class="code" href="classOldItem.html#a8">OldItem::getGfxData</a>()<span class="keyword"> const</span>
00944 <span class="keyword"></span>{
00945    <span class="keywordflow">return</span> static_cast&lt;GMSGfxData*&gt;( m_gfxData );
00946 }
00947 
00948 
00949 
00950 <span class="keyword">inline</span> ItemTypes::itemType
<a name="l00951"></a><a class="code" href="classOldItem.html#a11">00951</a> <a class="code" href="classOldItem.html#a11">OldItem::getItemType</a>()<span class="keyword"> const</span>
00952 <span class="keyword"></span>{
00953    <span class="keywordflow">return</span> (<a class="code" href="classItemTypes.html#w342">ItemTypes::itemType</a>(<a class="code" href="classOldItem.html#p6">m_type</a>));
00954 }
00955 
00956 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00957"></a><a class="code" href="classOldItem.html#a16">00957</a> <a class="code" href="classOldItem.html#a16">OldItem::getNbrGroups</a>()<span class="keyword"> const</span>
00958 <span class="keyword"></span>{
00959    <span class="keywordflow">return</span> m_nbrGroups;
00960 }
00961 
00962 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00963"></a><a class="code" href="classOldItem.html#a17">00963</a> <a class="code" href="classOldItem.html#a17">OldItem::getGroup</a>(uint32 i)<span class="keyword"> const</span>
00964 <span class="keyword"></span>{
00965    <span class="keywordflow">if</span> (i &lt; <a class="code" href="classOldItem.html#a16">getNbrGroups</a>()) {
00966       <span class="keywordflow">return</span> <a class="code" href="classOldItem.html#p1">m_groups</a>[i] &amp; 0x7fffffff;
00967    }
00968    <span class="keywordflow">return</span> MAX_UINT32;
00969 }
00970 
00971 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> 
<a name="l00972"></a><a class="code" href="classOldItem.html#a18">00972</a> <a class="code" href="classOldItem.html#a18">OldItem::getUnmaskedGroup</a>(uint32 i)<span class="keyword"> const</span>
00973 <span class="keyword"></span>{
00974    <span class="keywordflow">if</span> (i &lt; <a class="code" href="classOldItem.html#a16">getNbrGroups</a>()) {
00975       <span class="keywordflow">return</span> <a class="code" href="classOldItem.html#p1">m_groups</a>[i];
00976    }
00977    <span class="keywordflow">return</span> MAX_UINT32;
00978 }
00979 
00980 <span class="keyword">inline</span> <span class="keywordtype">bool</span> 
<a name="l00981"></a><a class="code" href="classOldItem.html#a15">00981</a> <a class="code" href="classOldItem.html#a15">OldItem::memberOfGroup</a>(uint32 groupID)<span class="keyword"> const</span>
00982 <span class="keyword"></span>{
00983    <span class="keywordflow">for</span> (<a class="code" href="Types_8h.html#a21">uint32</a> i=0; i&lt;<a class="code" href="classOldItem.html#a16">getNbrGroups</a>(); ++i) {
00984       <span class="keywordflow">if</span> (<a class="code" href="classOldItem.html#a17">getGroup</a>(i) == groupID)
00985          <span class="keywordflow">return</span> <span class="keyword">true</span>;
00986    }
00987    <span class="keywordflow">return</span> <span class="keyword">false</span>;
00988 }
00989 
00990 <span class="keyword">inline</span> <span class="keywordtype">bool</span> 
<a name="l00991"></a><a class="code" href="classOldItem.html#a19">00991</a> <a class="code" href="classOldItem.html#a19">OldItem::setGroup</a>(uint32 i, uint32 groupID)
00992 {
00993    <span class="keywordflow">if</span> ( i &lt; <a class="code" href="classOldItem.html#a16">getNbrGroups</a>() ) {
00994       <a class="code" href="classOldItem.html#p1">m_groups</a>[ i ] = groupID;
00995       <span class="keywordflow">return</span> <span class="keyword">true</span>;
00996    } <span class="keywordflow">else</span> {
00997       <span class="keywordflow">return</span> <span class="keyword">false</span>;
00998    }
00999 }
01000 
01001 <span class="keyword">inline</span> <span class="keywordtype">bool</span> 
<a name="l01002"></a><a class="code" href="classOldItem.html#a20">01002</a> <a class="code" href="classOldItem.html#a20">OldItem::removeGroup</a>(uint32 i)
01003 {
01004    <span class="keywordflow">if</span> ( i &lt; <a class="code" href="classOldItem.html#a16">getNbrGroups</a>()){
01005       <a class="code" href="namespaceArrayTool.html#a3">ArrayTool::removeElement</a>(<a class="code" href="classOldItem.html#p1">m_groups</a>, i, <a class="code" href="classOldItem.html#p5">m_nbrGroups</a>);
01006       <span class="keywordflow">return</span> <span class="keyword">true</span>;
01007    }
01008    <span class="keywordflow">else</span>{
01009       <span class="keywordflow">return</span> <span class="keyword">false</span>;
01010    }
01011 }
01012       
01013 <span class="keyword">inline</span> <span class="keywordtype">bool</span> 
<a name="l01014"></a><a class="code" href="classOldItem.html#a21">01014</a> <a class="code" href="classOldItem.html#a21">OldItem::removeGroupWithID</a>(uint32 <span class="keywordtype">id</span>)
01015 {
01016    <span class="keywordtype">id</span> &amp;= 0x7fffffff;
01017    <a class="code" href="Types_8h.html#a21">uint32</a> i = 0;
01018    <span class="keywordflow">while</span> ( (i &lt; <a class="code" href="classOldItem.html#a16">getNbrGroups</a>()) &amp;&amp; ( (<a class="code" href="classOldItem.html#p1">m_groups</a>[i] &amp; 0x7fffffff) != id)) {
01019       ++i;
01020    }
01021    <span class="keywordflow">if</span> (i &lt; <a class="code" href="classOldItem.html#a16">getNbrGroups</a>()) {
01022       <span class="keywordflow">return</span> <a class="code" href="classOldItem.html#a20">removeGroup</a>(i);
01023    }
01024    <span class="keywordflow">return</span> <span class="keyword">false</span>;
01025 }
01026 
01027 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a17">uint8</a> 
<a name="l01028"></a><a class="code" href="classOldItem.html#a23">01028</a> <a class="code" href="classOldItem.html#a23">OldItem::getSource</a>()<span class="keyword"> const </span>
01029 <span class="keyword"></span>{
01030    <span class="keywordflow">return</span> m_source;
01031 }
01032 
01033 <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l01034"></a><a class="code" href="classOldItem.html#a24">01034</a> <a class="code" href="classOldItem.html#a24">OldItem::setSource</a>(uint8 newSource) 
01035 {
01036    <a class="code" href="classOldItem.html#p7">m_source</a> = newSource;
01037 }
01038 
01039 <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* 
<a name="l01040"></a><a class="code" href="classOldItem.html#a25">01040</a> <a class="code" href="classOldItem.html#a25">OldItem::getItemTypeAsString</a>( StringTable::languageCode lc )<span class="keyword"> const </span>
01041 <span class="keyword"></span>{
01042    <span class="keyword">const</span> <span class="keywordtype">char</span>* str = <a class="code" href="classStringTable.html#z86_1">StringTable::getString</a>( 
01043          ItemTypes::getItemTypeSC( <a class="code" href="classOldItem.html#a11">getItemType</a>() ), lc );
01044    <span class="keywordflow">if</span> (str != NULL) {
01045       <span class="keywordflow">return</span> (str);
01046    } <span class="keywordflow">else</span> {
01047       <span class="keywordflow">return</span> (<span class="stringliteral">"Unknown itemtype"</span>);
01048    }
01049       
01050 }
01051 
01052 
01053 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jun 30 10:11:48 2010 for mc2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
