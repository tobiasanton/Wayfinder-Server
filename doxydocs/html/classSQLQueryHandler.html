<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mc2: SQLQueryHandler Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>SQLQueryHandler Class Reference</h1>A class that constructs the sql querys needed for inserting and getting data from a specific sql data table.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="SQLQueryHandler_8h-source.html">SQLQueryHandler.h</a>&gt;</code>
<p>
<a href="classSQLQueryHandler-members.html">List of all members.</a><h2>Public Member Functions</h2>
<ul>
<li><a class="el" href="classSQLQueryHandler.html#a0">SQLQueryHandler</a> ()
<dl class="el"><dd class="mdescRight">Creates a new SQLQueryHandler.  <a href="#a0"></a><br></dl><li><a class="el" href="classSQLQueryHandler.html#a1">~SQLQueryHandler</a> ()
</ul>
<h2>Static Public Member Functions</h2>
<ul>
<li>void <a class="el" href="classSQLQueryHandler.html#e0">insertData</a> (<a class="el" href="classCharEncSQLQuery.html">CharEncSQLQuery</a> *sqlQuery, const <a class="el" href="classMC2String.html">MC2String</a> &amp;whereTag, const <a class="el" href="classRequestPacket.html">RequestPacket</a> &amp;reqPacket, <a class="el" href="classReplyPacket.html">ReplyPacket</a> &amp;replyPacket, int reqPos, <a class="el" href="classSQLTableData.html">SQLTableData</a> &amp;table, <a class="el" href="classSQLDataContainer.html">SQLDataContainer</a> &amp;cont)
<dl class="el"><dd class="mdescRight">Insert data into the database.  <a href="#e0"></a><br></dl><li>void <a class="el" href="classSQLQueryHandler.html#e1">fetchData</a> (<a class="el" href="classCharEncSQLQuery.html">CharEncSQLQuery</a> *sqlQuery, const <a class="el" href="classMC2String.html">MC2String</a> &amp;whereTag, const <a class="el" href="classRequestPacket.html">RequestPacket</a> &amp;reqPacket, <a class="el" href="classReplyPacket.html">ReplyPacket</a> &amp;replyPacket, int reqPos, int replyPos, <a class="el" href="classSQLTableData.html">SQLTableData</a> &amp;table, <a class="el" href="classSQLDataContainer.html">SQLDataContainer</a> &amp;cont)
<dl class="el"><dd class="mdescRight">Fetches data from the database.  <a href="#e1"></a><br></dl><li>bool <a class="el" href="classSQLQueryHandler.html#e2">fetchData</a> (<a class="el" href="classCharEncSQLQuery.html">CharEncSQLQuery</a> *sqlQuery, const <a class="el" href="classMC2String.html">MC2String</a> &amp;whereTag, const <a class="el" href="classSQLDataContainer.html">SQLDataContainer</a> &amp;reqCont, <a class="el" href="classSQLTableData.html">SQLTableData</a> &amp;table, <a class="el" href="classSQLDataContainer.html">SQLDataContainer</a> &amp;cont)
<dl class="el"><dd class="mdescRight">Fetches data from the database.  <a href="#e2"></a><br></dl></ul>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A class that constructs the sql querys needed for inserting and getting data from a specific sql data table. 
<p>
And sets the correct reply to the reply packet.<p>
Example:<p>
First have the SQLDataTable created, here m_exampleTableData is a auto_ptr. The sql table has userUIN as a primary key and is numeric, a name value which is not a primary key, and a string. And last a phoneNbr which is not a primary key, and numericly stored in the database. <div class="fragment"><pre class="fragment"> m_exampleTableData.reset( <span class="keyword">new</span> SQLDataTable(<span class="stringliteral">"ExampleData"</span>) );
 m_exampleTableData-&gt;setColumnName(
      SQLDataTable::TableDataColumn(<span class="stringliteral">"userUIN"</span>, <span class="keyword">true</span>, <span class="keyword">true</span> ) );
 m_exampleTableData-&gt;setColumnName(
      SQLDataTable::TableDataColumn(<span class="stringliteral">"name"</span>, <span class="keyword">false</span>, <span class="keyword">false</span> ) );
 m_exampleTableData-&gt;setColumnName(
      SQLDataTable::TableDataColumn(<span class="stringliteral">"phoneNbr"</span>, <span class="keyword">true</span>, <span class="keyword">false</span> ) );
</pre></div>This data will be used to determine how to build up the sql query's in the handler.<p>
To get stored data example, where the request packet might contain a request for a specific phoneNbr from a specific user. <div class="fragment"><pre class="fragment">  <span class="comment">// p is the request packet</span>
  <span class="keywordtype">int</span> reqPos = ... the <a class="code" href="namespaceGetSearchItem.html#a0">request</a> header size of the packet ...;
  <span class="keywordtype">int</span> replyPos = .. the reply header size of the packet ...;
  auto_ptr&lt; CharEncSQLQuery &gt;  sqlQuery( m_sqlConnection-&gt;newQuery() );
  auto_ptr&lt; ... packet reply type ... &gt; 
     reply( <span class="keyword">new</span> ... packet reply type ...( &amp;p ) );
  <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a> whereTag( <span class="stringliteral">"UP::... the handle function name ..."</span> );
  <a class="code" href="classSQLDataContainer.html">SQLDataContainer</a> cont;
  <a class="code" href="classSQLQueryHandler.html">SQLQueryHandler</a> queryHandler;
  queryHandler.<a class="code" href="classSQLQueryHandler.html#e1">fetchData</a>( sqlQuery.get(), whereTag, p, *reply, reqPos,
                           replyPos, *m_exampleTableData, cont );
   <span class="keywordflow">return</span> reply.release();
</pre></div>fetchData will store the requested data in the reply packet at replyPos.<p>
To insert/update data in a table: <div class="fragment"><pre class="fragment">  <span class="comment">// p is the request packet</span>
  <span class="keywordtype">int</span> reqPos = ... the <a class="code" href="namespaceGetSearchItem.html#a0">request</a> header size of the packet ...;
  auto_ptr&lt; CharEncSQLQuery &gt;  sqlQuery( m_sqlConnection-&gt;newQuery() );
  auto_ptr&lt; ... packet reply type ... &gt; 
     reply( <span class="keyword">new</span> ... packet reply type ...( &amp;p ) );
  <span class="keyword">const</span> <a class="code" href="classMC2String.html">MC2String</a> whereTag( <span class="stringliteral">"UP::... the handle function name ..."</span> );
  <a class="code" href="classSQLDataContainer.html">SQLDataContainer</a> cont;
  <a class="code" href="classSQLQueryHandler.html">SQLQueryHandler</a> queryHandler;
  queryHandler.<a class="code" href="classSQLQueryHandler.html#e0">insertData</a>( sqlQuery.get(), whereTag, p, *reply, reqPos,
                           *m_exampleTableData, cont );
   <span class="keywordflow">return</span> reply.release();
</pre></div>insertData will first try to insert the data suplied by the request packet, if it fails it will then try and update the table instead. If that also fails it will set the status in the reply packet to <a class="el" href="classStringTableUTF8.html#z87_1w85">StringTable::NOTOK</a>, else it will be set to <a class="el" href="classStringTableUTF8.html#z87_1w84">StringTable::OK</a>. 
<p>

<p>
Definition at line <a class="el" href="SQLQueryHandler_8h-source.html#l00102">102</a> of file <a class="el" href="SQLQueryHandler_8h-source.html">SQLQueryHandler.h</a>.<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="SQLQueryHandler::SQLQueryHandler"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">SQLQueryHandler::SQLQueryHandler           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Creates a new SQLQueryHandler. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="SQLQueryHandler::~SQLQueryHandler"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">SQLQueryHandler::~<a class="el" href="classSQLQueryHandler.html">SQLQueryHandler</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="e2" doxytag="SQLQueryHandler::fetchData"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool SQLQueryHandler::fetchData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classCharEncSQLQuery.html">CharEncSQLQuery</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>sqlQuery</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="classMC2String.html">MC2String</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>whereTag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="classSQLDataContainer.html">SQLDataContainer</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>reqCont</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="classSQLTableData.html">SQLTableData</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="classSQLDataContainer.html">SQLDataContainer</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>cont</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Fetches data from the database. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sqlQuery</em>&nbsp;</td><td>The sql query connection. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>whereTag</em>&nbsp;</td><td>Debug message. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reqCont</em>&nbsp;</td><td>The container with the column(s) to select with. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>table</em>&nbsp;</td><td>The table data of the databse </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cont</em>&nbsp;</td><td>The sql data container, is filled with the result. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>True if select went ok, false if not. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="e1" doxytag="SQLQueryHandler::fetchData"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void SQLQueryHandler::fetchData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classCharEncSQLQuery.html">CharEncSQLQuery</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>sqlQuery</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="classMC2String.html">MC2String</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>whereTag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="classRequestPacket.html">RequestPacket</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>reqPacket</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="classReplyPacket.html">ReplyPacket</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>replyPacket</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>reqPos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>replyPos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="classSQLTableData.html">SQLTableData</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="classSQLDataContainer.html">SQLDataContainer</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>cont</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Fetches data from the database. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sqlQuery</em>&nbsp;</td><td>The sql query connection </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>whereTag</em>&nbsp;</td><td>Debug message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reqPacket</em>&nbsp;</td><td>The request packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>replyPacket</em>&nbsp;</td><td>the reply packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reqPos</em>&nbsp;</td><td>The request header size of the request packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>replyPos</em>&nbsp;</td><td>The reply header size of the reply packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>table</em>&nbsp;</td><td>The table data of the databse </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cont</em>&nbsp;</td><td>The sql data container </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="e0" doxytag="SQLQueryHandler::insertData"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void SQLQueryHandler::insertData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classCharEncSQLQuery.html">CharEncSQLQuery</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>sqlQuery</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="classMC2String.html">MC2String</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>whereTag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="classRequestPacket.html">RequestPacket</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>reqPacket</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="classReplyPacket.html">ReplyPacket</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>replyPacket</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>reqPos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="classSQLTableData.html">SQLTableData</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="classSQLDataContainer.html">SQLDataContainer</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>cont</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Insert data into the database. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sqlQuery</em>&nbsp;</td><td>The sql query connection </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>whereTag</em>&nbsp;</td><td>Debug message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reqPacket</em>&nbsp;</td><td>The request packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>replyPacket</em>&nbsp;</td><td>The reply packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reqPos</em>&nbsp;</td><td>The request header size of the request packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>table</em>&nbsp;</td><td>The table data of the databse </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cont</em>&nbsp;</td><td>The sql data container </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="SQLQueryHandler_8h-source.html">SQLQueryHandler.h</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed Jun 30 10:27:32 2010 for mc2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
