<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mc2: DATEXRequest.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">Server</a>&nbsp;/&nbsp;<a class="el" href="dir_000003.html">Servers</a>&nbsp;/&nbsp;<a class="el" href="dir_000004.html">include</a></div>
<h1>DATEXRequest.h</h1><a href="DATEXRequest_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">Copyright (c) 1999 - 2010, Vodafone Group Services Ltd</span>
00003 <span class="comment">All rights reserved.</span>
00004 <span class="comment"></span>
00005 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
00008 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
00009 <span class="comment">    * Neither the name of the Vodafone Group Services Ltd nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
00010 <span class="comment"></span>
00011 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#ifndef DATEXREQUEST_H</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define DATEXREQUEST_H</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00018 <span class="preprocessor">#include "<a class="code" href="Request_8h.html">Request.h</a>"</span>
00019 <span class="preprocessor">#include "<a class="code" href="StreetSegmentItemPacket_8h.html">StreetSegmentItemPacket.h</a>"</span>
00020 <span class="preprocessor">#include "<a class="code" href="GetTMCCoordinatePacket_8h.html">GetTMCCoordinatePacket.h</a>"</span>
00021 <span class="preprocessor">#include "<a class="code" href="AddDisturbancePacket_8h.html">AddDisturbancePacket.h</a>"</span>
00022 <span class="preprocessor">#include "<a class="code" href="RemoveDisturbancePacket_8h.html">RemoveDisturbancePacket.h</a>"</span>
00023 <span class="preprocessor">#include &lt;time.h&gt;</span>
00024 <span class="preprocessor">#include &lt;vector&gt;</span>
00025 <span class="preprocessor">#include &lt;queue&gt;</span>
00026 <span class="preprocessor">#include &lt;memory&gt;</span>
00027 <span class="preprocessor">#include "<a class="code" href="TopRegionPacket_8h.html">TopRegionPacket.h</a>"</span>
00028 <span class="preprocessor">#include "<a class="code" href="TopRegionMatch_8h.html">TopRegionMatch.h</a>"</span>
00029 <span class="preprocessor">#include "<a class="code" href="IDTranslationPacket_8h.html">IDTranslationPacket.h</a>"</span>
00030 <span class="preprocessor">#include "<a class="code" href="TrafficSituation_8h.html">TrafficSituation.h</a>"</span>
00031 <span class="preprocessor">#include "<a class="code" href="TrafficDataTypes_8h.html">TrafficDataTypes.h</a>"</span>
00032 <span class="preprocessor">#include "<a class="code" href="MC2String_8h.html">MC2String.h</a>"</span>
00033 <span class="preprocessor">#include "<a class="code" href="ExpandItemID_8h.html">ExpandItemID.h</a>"</span>
00034 <span class="preprocessor">#include "<a class="code" href="RouteRequest_8h.html">RouteRequest.h</a>"</span>
00035 <span class="preprocessor">#include "<a class="code" href="GenericServer_8h.html">GenericServer.h</a>"</span>
00036 
00037 <span class="keyword">class </span><a class="code" href="classCoveredIDsRequest.html">CoveredIDsRequest</a>;
00038 
00039 <span class="keyword">class </span><a class="code" href="classTopRegionRequest.html">TopRegionRequest</a>;
00040 <span class="keyword">class </span><a class="code" href="classTrafficPointRequest.html">TrafficPointRequest</a>;
00041 
<a name="l00048"></a><a class="code" href="classDATEXRequest.html">00048</a> <span class="keyword">class </span><a class="code" href="classDATEXRequest.html">DATEXRequest</a> : <span class="keyword">public</span> <a class="code" href="classRequest.html">Request</a>
00049 {
00050   <span class="keyword">public</span>:
00051 
00056    <a class="code" href="classDATEXRequest.html#a0">DATEXRequest</a>(<a class="code" href="Types_8h.html#a19">uint16</a> requestID,
00057                 <a class="code" href="classTrafficSituation.html">TrafficSituation</a>* trafficSituation,
00058                 <span class="keyword">const</span> <a class="code" href="classTopRegionRequest.html">TopRegionRequest</a>* topReq);
00059 
00064    <a class="code" href="classDATEXRequest.html#a0">DATEXRequest</a>(<a class="code" href="Types_8h.html#a19">uint16</a> requestID,
00065                 <a class="code" href="classvector.html">vector&lt;TrafficSituation*&gt;</a> trafficVector,
00066                 <span class="keyword">const</span> <a class="code" href="classTopRegionRequest.html">TopRegionRequest</a>* topReq,
00067                 <a class="code" href="classMC2String.html">MC2String</a> supplier,
00068                 <a class="code" href="classvector.html">vector&lt;MC2String&gt;</a> toBeKept);
00069    
00073    <span class="keyword">virtual</span> <a class="code" href="classDATEXRequest.html#a2">~DATEXRequest</a>();
00074 
00076    <span class="keywordtype">void</span> <a class="code" href="classDATEXRequest.html#a3">init</a>();
00077    
<a name="l00081"></a><a class="code" href="classDATEXRequest.html#w9">00081</a>    <span class="keyword">enum</span> <a class="code" href="classDATEXRequest.html#w9">datex_state</a> {
00082       <a class="code" href="classDATEXRequest.html#w9w0">STATE_TMC</a> = 0,
00083       STATE_STREET_SEGMENT_ITEM,
00084       STATE_COVERED_IDS,
00085       STATE_ROUTE_REQUEST,
00086       STATE_TOP_REGION_REQUEST,
00087       STATE_ID_TRANSLATION_REQUEST,
00088       STATE_ADD_DISTURBANCE,
00089       STATE_DONE,
00090       <a class="code" href="classDATEXRequest.html#w9w8">STATE_ERROR</a>
00091    } m_state;
00092    
00093    
00095    datex_state <a class="code" href="classDATEXRequest.html#a4">processSituation</a>();
00096    
00101    <span class="keywordtype">void</span> <a class="code" href="classDATEXRequest.html#a5">processPacket</a>(<a class="code" href="classPacketContainer.html">PacketContainer</a>* packetCont);
00102    
<a name="l00108"></a><a class="code" href="classDATEXRequest.html#a6">00108</a>    <a class="code" href="classPacketContainer.html">PacketContainer</a>* <a class="code" href="classDATEXRequest.html#a6">getAnswer</a>() {
00109       <span class="keywordflow">return</span> NULL;
00110    }
00111       
<a name="l00116"></a><a class="code" href="classDATEXRequest.html#a7">00116</a>    <a class="code" href="classDATEXRequest.html#w9">datex_state</a> <a class="code" href="classDATEXRequest.html#a7">getState</a>() {
00117       <span class="keywordflow">return</span> m_state;
00118    }
00119    
00120   <span class="keyword">protected</span>:
00125    datex_state <a class="code" href="classDATEXRequest.html#b0">createGetTMCCoordinateRequestPacket</a>();
00126 
00133    datex_state <a class="code" href="classDATEXRequest.html#b1">processGetTMCCoordinateReplyPacket</a>(<a class="code" href="classPacketContainer.html">PacketContainer</a>* packet);
00134 
00138    <span class="keywordtype">void</span> <a class="code" href="classDATEXRequest.html#b2">processStreetReplyPackets</a>();
00139    
00144    datex_state <a class="code" href="classDATEXRequest.html#b3">createStreetSegmentItemRequestPackets</a>();
00145    
00152    datex_state <a class="code" href="classDATEXRequest.html#b4">processStreetSegmentItemReplyPacket</a>(<a class="code" href="classPacketContainer.html">PacketContainer</a>* packet);
00153    
00165    <span class="keywordtype">void</span> <a class="code" href="classDATEXRequest.html#b5">getAngle</a>(<a class="code" href="classExpandItemID.html">ExpandItemID</a>* expItemID,
00166                  uint32* &amp;angle);
00167    
00172    datex_state <a class="code" href="classDATEXRequest.html#b6">createCoveredIDsRequestRequest</a>();
00173 
00177    datex_state <a class="code" href="classDATEXRequest.html#b7">handleCoveredIDsDone</a>();
00178 
00179    
00185    datex_state <a class="code" href="classDATEXRequest.html#b8">processCoveredIDsReply</a>(<a class="code" href="classPacketContainer.html">PacketContainer</a>* pack);
00186 
00191    datex_state <a class="code" href="classDATEXRequest.html#b9">createRouteRequest</a>();
00192 
00198    datex_state <a class="code" href="classDATEXRequest.html#b10">processRouteReply</a>(<a class="code" href="classPacketContainer.html">PacketContainer</a>* pack);
00199 
00205    datex_state <a class="code" href="classDATEXRequest.html#b11">handleRouteReply</a>();
00206    
00211    datex_state <a class="code" href="classDATEXRequest.html#b12">createTopRegionRequestPacket</a>();
00212 
00218    datex_state <a class="code" href="classDATEXRequest.html#b13">processTopRegionReplyPacket</a>(<a class="code" href="classPacketContainer.html">PacketContainer</a>* packet);
00219    
00224    datex_state <a class="code" href="classDATEXRequest.html#b14">createIDTranslationRequestPacket</a>();  
00225    
00233    datex_state <a class="code" href="classDATEXRequest.html#b15">processIDTranslationReplyPacket</a>(<a class="code" href="classPacketContainer.html">PacketContainer</a>* packet);
00234    
00239    datex_state <a class="code" href="classDATEXRequest.html#b16">createAddDisturbanceRequestPacket</a>();
00240    
00247    datex_state <a class="code" href="classDATEXRequest.html#b17">processAddDisturbanceReplyPacket</a>(<a class="code" href="classPacketContainer.html">PacketContainer</a>* packet);
00248 
00249   <span class="keyword">private</span>:
00250 
00251    <span class="comment">// Member variables</span>
<a name="l00253"></a><a class="code" href="classDATEXRequest.html#r0">00253</a> <span class="comment"></span>   <a class="code" href="classMC2String.html">MC2String</a> m_situationReference;
<a name="l00255"></a><a class="code" href="classDATEXRequest.html#r1">00255</a>    <a class="code" href="classMC2String.html">MC2String</a> m_locationTable;
<a name="l00257"></a><a class="code" href="classDATEXRequest.html#r2">00257</a>    <a class="code" href="classMC2String.html">MC2String</a> m_elementReference;
<a name="l00259"></a><a class="code" href="classDATEXRequest.html#r3">00259</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_startTime;
<a name="l00261"></a><a class="code" href="classDATEXRequest.html#r4">00261</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_expiryTime;
<a name="l00263"></a><a class="code" href="classDATEXRequest.html#r5">00263</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_creationTime;
<a name="l00265"></a><a class="code" href="classDATEXRequest.html#r6">00265</a>    TrafficDataTypes::disturbanceType m_type;
<a name="l00267"></a><a class="code" href="classDATEXRequest.html#r7">00267</a>    TrafficDataTypes::phrase m_phrase;
<a name="l00269"></a><a class="code" href="classDATEXRequest.html#r8">00269</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_eventCode;
<a name="l00271"></a><a class="code" href="classDATEXRequest.html#r9">00271</a>    <a class="code" href="classMC2String.html">MC2String</a> m_text;
<a name="l00273"></a><a class="code" href="classDATEXRequest.html#r10">00273</a>    TrafficDataTypes::severity m_severity;
<a name="l00275"></a><a class="code" href="classDATEXRequest.html#r11">00275</a>    TrafficDataTypes::severity_factor m_severityFactor;
<a name="l00277"></a><a class="code" href="classDATEXRequest.html#r12">00277</a>    <a class="code" href="classMC2String.html">MC2String</a> m_firstLocation;
<a name="l00279"></a><a class="code" href="classDATEXRequest.html#r13">00279</a>    TrafficDataTypes::direction m_direction;
00280 
<a name="l00282"></a><a class="code" href="classDATEXRequest.html#r14">00282</a>    <a class="code" href="classMC2String.html">MC2String</a> m_secondLocation;
<a name="l00284"></a><a class="code" href="classDATEXRequest.html#r15">00284</a>    <a class="code" href="Types_8h.html#a20">int16</a> m_extent;
<a name="l00286"></a><a class="code" href="classDATEXRequest.html#r16">00286</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_costFactor;
<a name="l00288"></a><a class="code" href="classDATEXRequest.html#r17">00288</a>    <a class="code" href="classvector.html">vector&lt;pair&lt;int32, int32&gt;</a> &gt; m_tmcCoords;
<a name="l00290"></a><a class="code" href="classDATEXRequest.html#r18">00290</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_queueLength;
00291    
<a name="l00293"></a><a class="code" href="classDATEXRequest.html#r19">00293</a>    list&lt;StreetSegmentItemRequestPacket*&gt; m_streetSegmentRequestPackets;
<a name="l00294"></a><a class="code" href="classDATEXRequest.html#r20">00294</a>    <a class="code" href="classqueue.html">queue&lt;IDTranslationRequestPacket*&gt;</a> m_idRequestPackets;
<a name="l00295"></a><a class="code" href="classDATEXRequest.html#r21">00295</a>    list&lt;AddDisturbanceRequestPacket*&gt; m_addRequestPackets;
00296    
<a name="l00298"></a><a class="code" href="classDATEXRequest.html#r22">00298</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_nbrRequestPackets;
00299    
<a name="l00301"></a><a class="code" href="classDATEXRequest.html#r23">00301</a>    <a class="code" href="classvector.html">vector&lt;RouteRequest*&gt;</a> m_routeRequests;
00302    
<a name="l00304"></a><a class="code" href="classDATEXRequest.html#r24">00304</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_nbrRouteRequests;
00305 
<a name="l00307"></a><a class="code" href="classDATEXRequest.html#r25">00307</a>    <a class="code" href="classvector.html">vector&lt;uint32&gt;</a> m_mapID;
00308    
<a name="l00310"></a><a class="code" href="classDATEXRequest.html#r26">00310</a>    <a class="code" href="classvector.html">vector&lt;uint32&gt;</a> m_nodeID;
00311    
<a name="l00316"></a><a class="code" href="classDATEXRequest.html#r27">00316</a>    <a class="code" href="classvector.html">vector&lt;pair&lt;int32, int32&gt;</a> &gt; m_coords;
00317    
<a name="l00319"></a><a class="code" href="classDATEXRequest.html#r28">00319</a>    <a class="code" href="classvector.html">vector&lt;pair&lt;int32, int32&gt;</a> &gt; m_tmcFirst;
<a name="l00320"></a><a class="code" href="classDATEXRequest.html#r29">00320</a>    <a class="code" href="classvector.html">vector&lt;pair&lt;int32, int32&gt;</a> &gt; m_tmcSecond;
00321     
<a name="l00326"></a><a class="code" href="classDATEXRequest.html#r30">00326</a>    <a class="code" href="classvector.html">vector&lt;uint32&gt;</a> m_angle;
00327    
<a name="l00329"></a><a class="code" href="classDATEXRequest.html#r31">00329</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_sent;
00330    
<a name="l00332"></a><a class="code" href="classDATEXRequest.html#r32">00332</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_received;
00333    
<a name="l00335"></a><a class="code" href="classDATEXRequest.html#r33">00335</a>    auto_ptr&lt;ItemIDTree&gt; m_mapIDTree;
00336 
<a name="l00338"></a><a class="code" href="classDATEXRequest.html#r34">00338</a>    <a class="code" href="classvector.html">vector&lt;IDPair_t&gt;</a> m_lowLevelNodes;
00339 
<a name="l00345"></a><a class="code" href="classDATEXRequest.html#r35">00345</a>    <a class="code" href="classvector.html">IDPairVector_t</a>* <a class="code" href="classDATEXRequest.html#r35">m_nodeVectors</a>[1];
00346    
00348    <span class="comment">// mapID and nodeID on the overview map.</span>
<a name="l00349"></a><a class="code" href="classDATEXRequest.html#r36">00349</a>    <a class="code" href="classmap.html">map&lt;IDPair_t, IDPair_t&gt;</a> m_lowLevelPairToHighLevel;
00350    
<a name="l00352"></a><a class="code" href="classDATEXRequest.html#r37">00352</a>    multimap&lt;uint32, PacketContainer*&gt; m_streetReplyPackets;
00353 
<a name="l00355"></a><a class="code" href="classDATEXRequest.html#r38">00355</a>    <a class="code" href="classvector.html">vector&lt;TrafficSituation*&gt;</a> m_trafficSituations;
00356 
<a name="l00358"></a><a class="code" href="classDATEXRequest.html#r39">00358</a>    <span class="keyword">const</span> <a class="code" href="classTopRegionRequest.html">TopRegionRequest</a>* m_topReq;
00359 
<a name="l00364"></a><a class="code" href="classDATEXRequest.html#r40">00364</a>    <span class="keywordtype">bool</span> m_tmcFailed;
00365 
<a name="l00367"></a><a class="code" href="classDATEXRequest.html#r41">00367</a>    <a class="code" href="classCoveredIDsRequest.html">CoveredIDsRequest</a>* m_coveredIDreq;
00368    
<a name="l00369"></a><a class="code" href="classDATEXRequest.html#r42">00369</a>    auto_ptr&lt;TrafficPointRequest&gt; m_trafficPointReq;
00370    
<a name="l00372"></a><a class="code" href="classDATEXRequest.html#r43">00372</a>    StringTable::stringCode m_status;
00373 
<a name="l00375"></a><a class="code" href="classDATEXRequest.html#r44">00375</a>    <span class="keywordtype">bool</span> m_originsCovered;
00376 
<a name="l00378"></a><a class="code" href="classDATEXRequest.html#r45">00378</a>    set&lt;IDPair_t&gt; m_originIDs;
<a name="l00380"></a><a class="code" href="classDATEXRequest.html#r46">00380</a>    set&lt;IDPair_t&gt; m_destinationIDs;
00381 
<a name="l00383"></a><a class="code" href="classDATEXRequest.html#r47">00383</a>    <a class="code" href="Types_8h.html#a27">float64</a> m_distance;
00384    
00385 };
00386 
00387 
00388 <span class="preprocessor">#endif </span>
00389 <span class="preprocessor"></span>
00390 
00391 
00392 
00393 
00394 
00395 
00396 
00397 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jun 30 10:11:46 2010 for mc2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
