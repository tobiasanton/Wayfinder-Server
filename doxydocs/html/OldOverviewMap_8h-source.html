<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mc2: OldOverviewMap.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">Server</a>&nbsp;/&nbsp;<a class="el" href="dir_000007.html">MapGen</a>&nbsp;/&nbsp;<a class="el" href="dir_000034.html">include</a></div>
<h1>OldOverviewMap.h</h1><a href="OldOverviewMap_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">Copyright (c) 1999 - 2010, Vodafone Group Services Ltd</span>
00003 <span class="comment">All rights reserved.</span>
00004 <span class="comment"></span>
00005 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
00008 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
00009 <span class="comment">    * Neither the name of the Vodafone Group Services Ltd nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
00010 <span class="comment"></span>
00011 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#ifndef OLDOVERVIEWMAP_H</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define OLDOVERVIEWMAP_H</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00018 <span class="preprocessor">#include "<a class="code" href="OldGenericMap_8h.html">OldGenericMap.h</a>"</span>
00019 <span class="preprocessor">#include "<a class="code" href="OldMap_8h.html">OldMap.h</a>"</span>
00020 <span class="preprocessor">#include "<a class="code" href="Vector_8h.html">Vector.h</a>"</span>
00021 <span class="preprocessor">#include "<a class="code" href="ItemTypes_8h.html">ItemTypes.h</a>"</span>
00022 <span class="preprocessor">#include &lt;deque&gt;</span>
00023 <span class="preprocessor">#include &lt;list&gt;</span>
00024 
00025 <span class="keyword">class </span><a class="code" href="classDataBuffer.html">DataBuffer</a>;
00026 <span class="preprocessor">#include "<a class="code" href="NationalProperties_8h.html">NationalProperties.h</a>"</span>
00027 <span class="preprocessor">#include "<a class="code" href="OldStreetSegmentItem_8h.html">OldStreetSegmentItem.h</a>"</span>
00028 
<a name="l00029"></a><a class="code" href="classOldOverviewMap.html">00029</a> <span class="keyword">class </span><a class="code" href="classOldOverviewMap.html">OldOverviewMap</a> : <span class="keyword">public</span> <a class="code" href="classOldGenericMap.html">OldGenericMap</a> {
00030 
00031    <span class="keyword">public</span>:
00032 
<a name="l00038"></a><a class="code" href="classOldOverviewMap.html#s0">00038</a>       <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classOldOverviewMap.html#s0">maxZoomLevelStreetSegmentItems</a> = 4;
00039 
<a name="l00049"></a><a class="code" href="classOldOverviewMap.html#s1">00049</a>       <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="Types_8h.html#a25">byte</a> <a class="code" href="classOldOverviewMap.html#s1">maxZoomLevelForMapLevel</a>[];
00050       
00051       
00055       <a class="code" href="classOldOverviewMap.html#a0">OldOverviewMap</a>();
00056 
00060       <a class="code" href="classOldOverviewMap.html#a0">OldOverviewMap</a>(uint32 mapID);
00061 
00070       <a class="code" href="classOldOverviewMap.html#a0">OldOverviewMap</a>(uint32 mapID, <span class="keyword">const</span> <span class="keywordtype">char</span>* path);
00071 
00075       <span class="keyword">virtual</span> <a class="code" href="classOldOverviewMap.html#a3">~OldOverviewMap</a>();
00076 
00087       <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#a4">addMap</a>(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap, <span class="keywordtype">bool</span> addExternalAndSave = <span class="keyword">true</span>,
00088                   byte mapLevel = 1 );
00089 
00096       <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#a5">containsMap</a>(uint32 mapID);
00097 
00104       <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classOldOverviewMap.html#a6">reverseLookupNodeID</a>(uint32 mapID, uint32 nodeID) <span class="keyword">const</span>;
00105 
00119       <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#a7">lookupNodeID</a>(uint32 overviewNodeID, 
00120                         uint32&amp; mapID, uint32&amp; nodeID) <span class="keyword">const</span>;
00121 
00134       <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classOldOverviewMap.html#a8">reverseLookup</a>(uint32 mapID, uint32 itemID) <span class="keyword">const</span>;
00135 
00146       <a class="code" href="classIDPair__t.html">IDPair_t</a> <a class="code" href="classOldOverviewMap.html#a9">lookup</a>( uint32 overviewID ) <span class="keyword">const</span>;
00147 
00152       <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classOldOverviewMap.html#a10">getNbrOverviewItems</a>() <span class="keyword">const</span>;
00153 
00166       <span class="keyword">inline</span> <a class="code" href="classOldItem.html">OldItem</a>* <a class="code" href="classOldOverviewMap.html#a11">getOverviewItem</a>(uint32 i,
00167                                    uint32 &amp;overviewID,
00168                                    uint32 &amp;origMapID,
00169                                    uint32 &amp;origItemID) <span class="keyword">const</span>;
00170 
00184       <span class="keywordtype">void</span> <a class="code" href="classOldOverviewMap.html#a12">updateExternalConnectionsFromMap</a>(<a class="code" href="classmap.html">map&lt;uint32, MC2String&gt;</a>&amp;
00185                                             lowerMapNameByID,
00186                                             <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* otherMap, 
00187                                             byte mapLevel);
00188 
00189 
00204       <span class="keywordtype">void</span>  <a class="code" href="classOldOverviewMap.html#a13">createZipCodeAgglomerations</a>();
00205 
00206      
00220       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#a14">removeItem</a>(uint32 localID, 
00221                               <span class="keywordtype">bool</span> updateHashTable = <span class="keyword">true</span>,
00222                               <span class="keywordtype">bool</span> updateAdminCenters = <span class="keyword">true</span>,
00223                               <span class="keywordtype">bool</span> unusedUkZips = <span class="keyword">false</span> );
00224 
00243       <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#a15">applyChangesFromOtherMap</a>(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* otherMap, 
00244             <a class="code" href="classvector.html">vector&lt;uint32&gt;</a> itemsAffectedInOtherMap, byte mapLevel,
00245             <span class="keywordtype">bool</span>&amp; overviewMapChanged,
00246             multimap&lt;uint32,uint32&gt;&amp; changedOverviewIds);
00247 
00256       <span class="keywordtype">bool</span> <a class="code" href="classOldGenericMap.html#z202_11">updateAdminAreaCentres</a>( <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* otherMap, byte mapLevel );
00257 
00258 
00271       <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classOldOverviewMap.html#z243_0">fillAdminAreaCentres</a>( <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* otherMap, byte mapLevel );
00273 
00274 
00281       <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classOldOverviewMap.html#a17">fillLanes</a>(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* otherMap);
00282 
00289       <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classOldOverviewMap.html#a18">fillConnectingLanes</a>(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* otherMap);
00290 
00291       
00304       <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#a19">groupAdminAreas</a>(ItemTypes::itemType itemType,
00305                            uint32 maxMergeDist );
00306 
00307 
00318       <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#a20">groupSameNameAdminIndexAreas</a>(set&lt;ItemTypes::itemType&gt; itemTypes);
00319 
00326       <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#a21">removeAllGfxData</a>( ItemTypes::itemType itemType );
00327 
<a name="l00328"></a><a class="code" href="classOldOverviewMap.html#a22">00328</a>       <span class="keyword">const</span> Vector&amp; <a class="code" href="classOldOverviewMap.html#a22">getContainingMaps</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_containingMaps; }
00329 
00330    <span class="keyword">protected</span>:
00331 
00335       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#b0">internalLoad</a>(<a class="code" href="classDataBuffer.html">DataBuffer</a>&amp; dataBuffer);
00336 
00340       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#b1">internalSave</a>(<span class="keywordtype">int</span> outfile);
00341 
00342    <span class="keyword">private</span>:
00343       
00344 
00359       <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#d0">changeNodeID</a>(<a class="code" href="classOldNode.html">OldNode</a>* node, uint32 trueMapID, 
00360                         uint32 overviewItemID);
00361 
00372       <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#d1">addToLookupTable</a>(uint32 origMapID, 
00373                             uint32 origItemID, 
00374                             uint32 newItemID);
00375 
00381       <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#d2">removeFromLookupTable</a>(uint32 newItemID);
00382 
00399       <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#d3">ssiConnectedToOverviewRoundabout</a>(<a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap, 
00400                                 <span class="keyword">const</span> <span class="keywordtype">int</span> maxZoomLevelStreetSegmentItems,
00401                                 <a class="code" href="classOldStreetSegmentItem.html">OldStreetSegmentItem</a>* ssi);
00402 
00412       <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#d4">toIncludeItem</a>(<a class="code" href="classOldItem.html">OldItem</a>* origItem, <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* origMap, byte mapLevel);
00413       
00439       <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classOldOverviewMap.html#d5">addOneItem</a>( <a class="code" href="classDataBuffer.html">DataBuffer</a>* dataBuffer,
00440                          <a class="code" href="classOldItem.html">OldItem</a>* curItem,
00441                          uint32 currentZoom,
00442                          Vector&amp; changedItems,
00443                          Vector&amp; changedItemsOriginalID,
00444                          <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap );
00445 
00446 
00447 
00466       <span class="keywordtype">void</span> <a class="code" href="classOldOverviewMap.html#d6">transferNodeExpansionTableToOverviewMap</a>(
00467              <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* theMap, 
00468              <a class="code" href="classDataBuffer.html">DataBuffer</a>* dataBuffer,
00469              Vector&amp; changedItems,
00470              Vector&amp; changedItemsOriginalID );
00471 
00472 
00484       <a class="code" href="classOldItem.html">OldItem</a>* <a class="code" href="classOldOverviewMap.html#d7">addGroupItem</a>( <a class="code" href="classOldItem.html">OldItem</a>* nameItem, 
00485                           ItemTypes::itemType groupItemType,
00486                           set&lt;OldItem*&gt;&amp; items);
00487 
00488 
00495       <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#d8">mapCommonNames</a>(<a class="code" href="classvector.html">vector&lt;OldItem*&gt;</a>&amp; items,
00496                           <a class="code" href="classmap.html">map</a>&lt; uint32, set&lt;OldItem*&gt; &gt;&amp; resultItemsByItemID);
00497 
00498       
00507       <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classOldOverviewMap.html#z244_0">createZipMergeGroups</a>();
00508 
00512       <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classOldOverviewMap.html#z244_1">createZipOverviews</a>(uint32 nbrCharacters,
00513                                 NationalProperties::zipCodeType_t 
00514                                 zipCodeType );
00516       
00517 
<a name="l00521"></a><a class="code" href="classOldOverviewMap.html#r0">00521</a>       Vector m_containingMaps;
00522 
00523       <span class="comment">// Only present for location backwards compability.</span>
00524       <span class="comment">// From here --&gt;</span>
<a name="l00525"></a><a class="code" href="classOldOverviewMap.html#n0">00525</a>       <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classOldItem.html">OldItem</a>;
<a name="l00530"></a><a class="code" href="classOldOverviewMap.html#r1">00530</a>       <a class="code" href="classvector.html">vector&lt;pair&lt;uint32, uint32&gt;</a> &gt; m_tempLocationTable;
00531       <span class="comment">// &lt;-- To here</span>
00532 
00542       <span class="keywordtype">void</span> <a class="code" href="classOldOverviewMap.html#d9">updateNames</a>(<a class="code" href="classOldItem.html">OldItem</a>* newItem, <a class="code" href="classOldItem.html">OldItem</a>* otherItem, <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* otherMap);
00543       
00552       <span class="keywordtype">void</span> <a class="code" href="classOldOverviewMap.html#d10">removeUnwantedGroups</a>(<a class="code" href="classOldItem.html">OldItem</a>* newItem, <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* otherMap);
00553 
00566       <span class="keywordtype">void</span> <a class="code" href="classOldOverviewMap.html#d11">addGroupsToPoi</a>(<a class="code" href="classOldItem.html">OldItem</a>* newItem,
00567                           <a class="code" href="classOldItem.html">OldItem</a>* otherItem, <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* otherMap);
00568 
00582       <span class="keywordtype">void</span> <a class="code" href="classOldOverviewMap.html#d12">updateConnectionsAndGroups</a>(Vector changeItems,
00583                                       <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* otherMap);
00584      
00595       <span class="keywordtype">void</span> <a class="code" href="classOldOverviewMap.html#d13">updateSignposts</a>(uint32 thisFromNodeID, 
00596                            uint32 thisToNodeID,
00597                            uint32 otherFromNodeID, 
00598                            uint32 otherToNodeID,
00599                            <span class="keyword">const</span> <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* otherMap);
00600 
00615       <span class="keywordtype">bool</span> <a class="code" href="classOldOverviewMap.html#d14">updateAttributes</a>(<a class="code" href="classOldItem.html">OldItem</a>* overviewItem, 
00616                             <a class="code" href="classOldItem.html">OldItem</a>* otherItem, <a class="code" href="classOldGenericMap.html">OldGenericMap</a>* otherMap);
00617 
00618 
00624 
00625       <span class="keywordtype">void</span> <a class="code" href="classOldOverviewMap.html#z245_0">printItemsToGroup</a>( 
00626                <a class="code" href="classmap.html">map</a>&lt; <a class="code" href="classOldItem.html">OldItem</a>*, list&lt;OldItem*&gt; &gt; mergeLists ) <span class="keyword">const</span>;
00627       
00635       vector &lt;OldItem*&gt; <a class="code" href="classOldOverviewMap.html#z245_1">nextItemsSameIAOrderInSameNameGroup</a>(
00636                <span class="keyword">const</span> set&lt;OldItem*&gt;&amp; items, 
00637                set&lt;OldItem*&gt;::const_iterator&amp; startAtIt,
00638                <span class="keyword">const</span> <a class="code" href="classOldItem.html">OldItem</a>* compareItem ) <span class="keyword">const</span>;
00643       vector &lt;OldItem*&gt; <a class="code" href="classOldOverviewMap.html#z245_2">nextItemsClose</a>( <span class="keyword">const</span> set&lt;OldItem*&gt;&amp; items, 
00644                                      set&lt;OldItem*&gt;::const_iterator&amp; startAtIt,
00645                                      <span class="keyword">const</span> <a class="code" href="classOldItem.html">OldItem</a>* compareItem,
00646                                      uint32 maxDist  ) <span class="keyword">const</span>;
00647       
00648       <span class="keywordtype">void</span> <a class="code" href="classOldOverviewMap.html#z245_3">moveToMergeList</a>( <span class="keyword">const</span> <a class="code" href="classvector.html">vector&lt;OldItem*&gt;</a>&amp; itemsToAdd, 
00649                              list&lt;OldItem*&gt;* mergeVector,
00650                              set&lt;OldItem*&gt;* processedItems) <span class="keyword">const</span>;
00651 
00652       
00663       <a class="code" href="classOldItem.html">OldItem</a>* <a class="code" href="classOldOverviewMap.html#z245_4">getGroupWithCommonLangName</a>( <a class="code" href="classOldItem.html">OldItem</a>* item, 
00664                                         ItemTypes::itemType 
00665                                         itemType ) <span class="keyword">const</span>;
00671       <a class="code" href="classOldItem.html">OldItem</a>* <a class="code" href="classOldOverviewMap.html#z245_5">findNameItem</a>( <a class="code" href="classOldItem.html">OldItem</a>* firstItem,
00672                              list&lt;OldItem*&gt; itemList ) <span class="keyword">const</span>;
00673 
00675 
00676 };
00677 
00678 
00679 <span class="comment">// ==================================================================</span>
00680 <span class="comment">//                                Implementation of inlined methods =</span>
00681 
00682 <span class="keyword">inline</span> <span class="keywordtype">bool</span>
<a name="l00683"></a><a class="code" href="classOldOverviewMap.html#a5">00683</a> <a class="code" href="classOldOverviewMap.html#a5">OldOverviewMap::containsMap</a>(uint32 mapID) 
00684 {
00685    <a class="code" href="Types_8h.html#a21">uint32</a> tmpVal = <a class="code" href="classOldOverviewMap.html#r0">m_containingMaps</a>.binarySearch(mapID);
00686    <span class="keywordflow">return</span> tmpVal &lt; MAX_UINT32;
00687 }
00688 
00689 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> 
<a name="l00690"></a><a class="code" href="classOldOverviewMap.html#a10">00690</a> <a class="code" href="classOldOverviewMap.html#a10">OldOverviewMap::getNbrOverviewItems</a>()<span class="keyword"> const</span>
00691 <span class="keyword"></span>{
00692    <span class="keywordflow">return</span> m_idTranslationTable.<a class="code" href="classIDTranslationTable.html#a10">getNbrElements</a>();
00693 }
00694 
00695 <span class="keyword">inline</span> <a class="code" href="classOldItem.html">OldItem</a>*
<a name="l00696"></a><a class="code" href="classOldOverviewMap.html#a11">00696</a> <a class="code" href="classOldOverviewMap.html#a11">OldOverviewMap::getOverviewItem</a>(uint32 i, uint32 &amp;overviewID,
00697                              uint32 &amp;origMapID, uint32 &amp;origItemID)<span class="keyword"> const</span>
00698 <span class="keyword"></span>{
00699 
00700    <span class="keywordflow">if</span> (m_idTranslationTable.<a class="code" href="classIDTranslationTable.html#a11">getElement</a>(i, overviewID, origMapID, origItemID)) {
00701       <span class="keywordflow">return</span> <a class="code" href="classOldGenericMap.html#z186_3">itemLookup</a>(overviewID);
00702    }
00703    <span class="keywordflow">return</span> NULL;
00704 }
00705 
00706 
00707 <span class="preprocessor">#endif</span>
00708 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jun 30 10:11:48 2010 for mc2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
