<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mc2: isabBoxNavMessage.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">Server</a>&nbsp;/&nbsp;<a class="el" href="dir_000003.html">Servers</a>&nbsp;/&nbsp;<a class="el" href="dir_000004.html">include</a></div>
<h1>isabBoxNavMessage.h</h1><a href="isabBoxNavMessage_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">Copyright (c) 1999 - 2010, Vodafone Group Services Ltd</span>
00003 <span class="comment">All rights reserved.</span>
00004 <span class="comment"></span>
00005 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
00008 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
00009 <span class="comment">    * Neither the name of the Vodafone Group Services Ltd nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
00010 <span class="comment"></span>
00011 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#ifndef ISABBOXNAVMESSAGE_H</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define ISABBOXNAVMESSAGE_H</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#include "<a class="code" href="NavMessage_8h.html">NavMessage.h</a>"</span>
00018 <span class="preprocessor">#include "<a class="code" href="isabBoxSession_8h.html">isabBoxSession.h</a>"</span>
00019 
<a name="l00020"></a><a class="code" href="isabBoxNavMessage_8h.html#a0">00020</a> <span class="preprocessor">#define ISABBOX_MESSAGE_HEADER_SIZE_VER_0 11</span>
<a name="l00021"></a><a class="code" href="isabBoxNavMessage_8h.html#a1">00021</a> <span class="preprocessor"></span><span class="preprocessor">#define ISABBOX_MESSAGE_HEADER_SIZE_VER_1 19</span>
<a name="l00022"></a><a class="code" href="isabBoxNavMessage_8h.html#a2">00022</a> <span class="preprocessor"></span><span class="preprocessor">#define ISABBOX_MESSAGE_HEADER_SIZE_VER_2 35</span>
00023 <span class="preprocessor"></span><span class="comment">// Doesn't return the userName now</span>
<a name="l00024"></a><a class="code" href="isabBoxNavMessage_8h.html#a3">00024</a> <span class="preprocessor">#define ISABBOX_MESSAGE_HEADER_SIZE_VER_2_REPLY 15</span>
00025 <span class="preprocessor"></span><span class="comment">// Version 5 has status code in reply but not in request</span>
<a name="l00026"></a><a class="code" href="isabBoxNavMessage_8h.html#a4">00026</a> <span class="preprocessor">#define ISABBOX_MESSAGE_HEADER_SIZE_VER_5 13</span>
<a name="l00027"></a><a class="code" href="isabBoxNavMessage_8h.html#a5">00027</a> <span class="preprocessor"></span><span class="preprocessor">#define ISABBOX_MESSAGE_HEADER_SIZE_VER_5_REPLY 14</span>
00028 <span class="preprocessor"></span>
00029 <span class="comment">// Forward</span>
00030 <span class="keyword">class </span><a class="code" href="classRouteElement.html">RouteElement</a>;
00031 
00032 
<a name="l00037"></a><a class="code" href="classisabBoxNavMessageUtil.html">00037</a> <span class="keyword">class </span><a class="code" href="classisabBoxNavMessageUtil.html">isabBoxNavMessageUtil</a> {
00038 
00039 <span class="keyword">public</span>:
00040 
<a name="l00041"></a><a class="code" href="classisabBoxNavMessageUtil.html#w9">00041</a>    <span class="keyword">enum</span> binaryTransfer_t {
00042       invalidData          =  0x00,
00043       crossingMapGfxData   =  0x10,
00044       syncFavorites        =  0x11,
00045       crossingMapGifData   =  0x12,
00046       topRegionListData    =  0x13,
00047       additionalRouteData  =  0x14,
00048       categoriesFile       =  0x15,
00049       latestNewsFile       =  0x16,
00050 
00051       logFileData          =  0x20,
00052    };
00053 
<a name="l00054"></a><a class="code" href="classisabBoxNavMessageUtil.html#s0">00054</a>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> navigatorStructSize = 12;
00063    <span class="keyword">static</span> <span class="keywordtype">int</span> convertHeaderToBytes(<span class="keyword">const</span> <a class="code" href="classNavMessage.html">NavMessage</a>* mess,
00064                                byte* buf,
00065                                <span class="keywordtype">int</span> bufSize);
00066 
00075    <span class="keyword">static</span> <span class="keywordtype">int</span> convertHeaderFromBytes(<a class="code" href="classNavMessage.html">NavMessage</a>* mess,
00076                                      <span class="keyword">const</span> byte* buf,
00077                                      <span class="keywordtype">int</span> bufSize);
00078 
00086    <span class="keyword">static</span> <span class="keywordtype">void</span> writeCRC( byte* buf, uint8 protoVer, uint32 crc );
00087 
00095    <span class="keyword">static</span> <a class="code" href="Types_8h.html#a21">uint32</a> readCRC( byte* buf, uint8 protoVer );
00096 
00105    <span class="keyword">static</span> <a class="code" href="Types_8h.html#a17">uint8</a> incReadByte(<span class="keyword">const</span> byte* buf,
00106                             <span class="keywordtype">int</span>&amp; pos);
00107 
00116    <span class="keyword">static</span> <a class="code" href="Types_8h.html#a19">uint16</a> incReadShort(<span class="keyword">const</span> byte* buf,
00117                               <span class="keywordtype">int</span>&amp; pos);
00118 
00127    <span class="keyword">static</span> <a class="code" href="Types_8h.html#a21">uint32</a> incReadLong(<span class="keyword">const</span> byte* buf,
00128                              <span class="keywordtype">int</span>&amp; pos);
00129 
00134    <span class="keyword">static</span> <span class="keywordtype">char</span>* incReadString(<span class="keyword">const</span> byte* buf,
00135                            <span class="keywordtype">int</span>&amp; pos);
00136    
00145    <span class="keyword">static</span> <span class="keywordtype">int</span> incWriteByte(byte* buf, <span class="keywordtype">int</span>&amp; pos, byte val);
00146 
00155    <span class="keyword">static</span> <span class="keywordtype">int</span> incWriteShort(byte* buf, <span class="keywordtype">int</span>&amp; pos, uint16 val);
00156 
00165    <span class="keyword">static</span> <span class="keywordtype">int</span> incWriteLong(byte* buf, <span class="keywordtype">int</span>&amp; pos, uint32 val);
00166 
00176    <span class="keyword">static</span> <span class="keywordtype">int</span> incWriteNavRad(byte* buf, <span class="keywordtype">int</span>&amp; pos, int32 val);
00177 
00187    <span class="keyword">static</span> <span class="keywordtype">int</span> incWriteTurn( byte* buf, <span class="keywordtype">int</span>&amp; pos, 
00188                             <span class="keyword">const</span> <a class="code" href="classRouteElement.html">RouteElement</a>* re,
00189                             <span class="keywordtype">int</span> protoVer );
00190 
00199    <span class="keyword">static</span> <span class="keywordtype">int</span> incWriteString(byte* buf, <span class="keywordtype">int</span>&amp; pos, <span class="keyword">const</span> <span class="keywordtype">char</span>* str);
00200    
00208    <span class="keyword">static</span> <span class="keywordtype">int</span> incWriteStringUTF8(byte* buf, <span class="keywordtype">int</span>&amp; pos, <span class="keyword">const</span> <span class="keywordtype">char</span>* str);
00209    
00217    <span class="keyword">static</span> <a class="code" href="Types_8h.html#a22">int32</a> navRadToMC2(int32 mmin);
00218 
00224    <span class="keyword">static</span> <a class="code" href="Types_8h.html#a22">int32</a> MC2ToNavRad(int32 mc2);
00225 
00233    <span class="keyword">static</span> <a class="code" href="Types_8h.html#a19">uint16</a> turnCodeToIsabBox( <span class="keyword">const</span> <a class="code" href="classRouteElement.html">RouteElement</a>* re,
00234                                     <span class="keywordtype">int</span> protoVer );
00235    
00239    <span class="keyword">static</span> StringTable::stringCode isabBoxToTurnCode( 
00240       uint16 turnCode, byte protoVer );
00241 
00246    <span class="keyword">static</span> <a class="code" href="Types_8h.html#a25">byte</a> attributeToFlags(byte attributes);
00247 
00255    <span class="keyword">static</span> <span class="keywordtype">bool</span> validNavCoordinates(uint32 lat, uint32 lon);
00256 
00264    <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceAlignUtility.html#a2">alignShort</a>( byte* buf, <span class="keywordtype">int</span>&amp; pos );
00265 
00266 <span class="keyword">private</span>:
00267  
00271 
<a name="l00272"></a><a class="code" href="classisabBoxNavMessageUtil.html#y34">00272</a>    <span class="keyword">typedef</span> <span class="keyword">enum</span> {
00273       nav_route_point_not_ok      = - 0x0001,
00274 
00275       nav_route_point_end         = 0x0000,
00276       nav_route_point_start       = 0x0001,
00277       nav_route_point_ahead       = 0x0002,
00278       nav_route_point_left        = 0x0003,
00279       nav_route_point_right       = 0x0004,
00280       nav_route_point_uturn       = 0x0005,
00281       nav_route_point_startat     = 0x0006,
00282       nav_route_point_finally     = 0x0007,
00283       nav_route_point_enter_rdbt  = 0x0008,
00284       nav_route_point_exit_rdbt   = 0x0009,
00285       nav_route_point_ahead_rdbt  = 0x000a,
00286       nav_route_point_left_rdbt   = 0x000b,
00287       nav_route_point_right_rdbt  = 0x000c,
00288       nav_route_point_exitat      = 0x000d,
00289       nav_route_point_on          = 0x000e,
00290       nav_route_point_park_car    = 0x000f,
00291       nav_route_point_keep_left   = 0x0010,
00292       nav_route_point_keep_right  = 0x0011,
00293       nav_route_point_start_with_uturn = 0x0012,
00294       nav_rotue_point_uturn_rdbt  = 0x0013,
00295       nav_route_point_follow_road = 0x0014,
00296       nav_route_point_enter_ferry = 0x0015,
00297       nav_route_point_exit_ferry  = 0x0016,
00298       nav_route_point_change_ferry= 0x0017,
00299       nav_route_point_endofroad_left=0x0018,
00300       nav_route_point_endofroad_right=0x0019,
00301       nav_route_point_off_ramp_left=0x001A,
00302       nav_route_point_off_ramp_right=0x001B,
00303       nav_route_point_exit_rdbt_8 = 0x001C,
00304       nav_route_point_exit_rdbt_16= 0x001D,
00305 
00306       NBR_PDA_ACTIONS,
00307 
00308       nav_route_point_delta     = 0x03fe,
00309       nav_route_point_max       = 0x03ff,
00310    } action_t;
00311 
00312   
<a name="l00317"></a><a class="code" href="structisabBoxNavMessageUtil_1_1turnCodeTable__t.html">00317</a>    <span class="keyword">struct </span><a class="code" href="structisabBoxNavMessageUtil_1_1turnCodeTable__t.html">turnCodeTable_t</a> {
<a name="l00318"></a><a class="code" href="structisabBoxNavMessageUtil_1_1turnCodeTable__t.html#o0">00318</a>       StringTable::stringCode mc2code;
<a name="l00319"></a><a class="code" href="structisabBoxNavMessageUtil_1_1turnCodeTable__t.html#o1">00319</a>       action_t                isabboxcode;
00320    };
00321 
<a name="l00326"></a><a class="code" href="classisabBoxNavMessageUtil.html#v0">00326</a>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structisabBoxNavMessageUtil_1_1turnCodeTable__t.html">turnCodeTable_t</a> turnCodeTable[];
00327 
00328 
<a name="l00333"></a><a class="code" href="classisabBoxNavMessageUtil.html#v1">00333</a>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structisabBoxNavMessageUtil_1_1turnCodeTable__t.html">turnCodeTable_t</a> turnCodeTable7p[];
00334 };
00335 
<a name="l00336"></a><a class="code" href="classisabBoxTypeMessage.html">00336</a> <span class="keyword">class </span><a class="code" href="classisabBoxTypeMessage.html">isabBoxTypeMessage</a> : <span class="keyword">public</span> <a class="code" href="classIncomingNavMessage.html">IncomingNavMessage</a> {
00337   <span class="keyword">public</span>:
00341    <a class="code" href="classisabBoxTypeMessage.html#a0">isabBoxTypeMessage</a>(<span class="keyword">const</span> <a class="code" href="classNavAddress.html">NavAddress</a>&amp; senderAddress,
00342                       <span class="keyword">const</span> <a class="code" href="Types_8h.html#a25">byte</a>* buf,
00343                       <span class="keywordtype">int</span> bufLen,
00344             <a class="code" href="classNavSession.html">NavSession</a> * session);
00345    
00346    
00353    <span class="keywordtype">bool</span> <a class="code" href="classisabBoxTypeMessage.html#a1">convertFromBytes</a>(<span class="keyword">const</span> <a class="code" href="Types_8h.html#a25">byte</a>* buf,
00354                          <span class="keywordtype">int</span> bufSize);
00355 
00364    <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classisabBoxTypeMessage.html#e0">getHeaderSize</a>( <span class="keywordtype">int</span> protoVer, <span class="keywordtype">bool</span> reply = <span class="keyword">true</span> );
00365 };
00366 
00367 
<a name="l00372"></a><a class="code" href="classisabBoxReplyMessage.html">00372</a> <span class="keyword">class </span><a class="code" href="classisabBoxReplyMessage.html">isabBoxReplyMessage</a> : <span class="keyword">public</span> <a class="code" href="classOutGoingNavMessage.html">OutGoingNavMessage</a> {
00373    <span class="keyword">public</span>:
00377       <a class="code" href="classisabBoxReplyMessage.html#a0">isabBoxReplyMessage</a>( <span class="keyword">const</span> <a class="code" href="classNavAddress.html">NavAddress</a>&amp; recipientAddress,
00378                            MessageType type,
00379                            <a class="code" href="Types_8h.html#a17">uint8</a> status,
00380                            <a class="code" href="classNavSession.html">NavSession</a>* session, 
00381                            <a class="code" href="Types_8h.html#a17">uint8</a> protoVer );
00382 
00391       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classisabBoxReplyMessage.html#a1">convertToBytes</a>( <a class="code" href="Types_8h.html#a25">byte</a>* buf,
00392                                    <span class="keywordtype">int</span> bufSize );
00393 };
00394 
00395 
00396 <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00397"></a><a class="code" href="classisabBoxNavMessageUtil.html#e21">00397</a> <a class="code" href="classisabBoxNavMessageUtil.html#e21">isabBoxNavMessageUtil::alignShort</a>( byte* buf, <span class="keywordtype">int</span>&amp; pos ) {
00398    <span class="keywordflow">if</span> ( pos &amp; 0x01 ) {
00399       buf [ pos++ ] = 0;
00400    }
00401 }
00402 
00403 
00404 <span class="preprocessor">#endif</span>
00405 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jun 30 10:11:47 2010 for mc2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
