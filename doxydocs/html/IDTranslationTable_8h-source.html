<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mc2: IDTranslationTable.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">Server</a>&nbsp;/&nbsp;<a class="el" href="dir_000005.html">Shared</a>&nbsp;/&nbsp;<a class="el" href="dir_000006.html">include</a></div>
<h1>IDTranslationTable.h</h1><a href="IDTranslationTable_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">Copyright (c) 1999 - 2010, Vodafone Group Services Ltd</span>
00003 <span class="comment">All rights reserved.</span>
00004 <span class="comment"></span>
00005 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
00008 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
00009 <span class="comment">    * Neither the name of the Vodafone Group Services Ltd nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
00010 <span class="comment"></span>
00011 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#ifndef IDTRANSLATIONTABLE_H</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define IDTRANSLATIONTABLE_H</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00018 <span class="preprocessor">#include "<a class="code" href="IDPairVector_8h.html">IDPairVector.h</a>"</span>
00019 <span class="preprocessor">#include "<a class="code" href="DataBufferObject_8h.html">DataBufferObject.h</a>"</span>
00020 
00021 <span class="preprocessor">#include &lt;vector&gt;</span>
00022 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
00023 <span class="preprocessor">#include &lt;functional&gt;</span>
00024 <span class="preprocessor">#if defined (__GNUC__) &amp;&amp; __GNUC__ &gt; 2</span>
00025 <span class="preprocessor"></span><span class="preprocessor">#include &lt;ext/algorithm&gt;</span>
00026 <span class="keyword">using</span> <span class="keyword">namespace </span>__gnu_cxx;
00027 <span class="preprocessor">#else</span>
00028 <span class="preprocessor"></span><span class="preprocessor">#include &lt;algorithm&gt;</span>
00029 <span class="preprocessor">#endif</span>
00030 <span class="preprocessor"></span>
00031 <span class="preprocessor">#include "<a class="code" href="STLUtility_8h.html">STLUtility.h</a>"</span>
00032 
00033 <span class="keyword">class </span><a class="code" href="classDataBuffer.html">DataBuffer</a>;
00034 
<a name="l00042"></a><a class="code" href="classIDTranslationTable.html">00042</a> <span class="keyword">class </span><a class="code" href="classIDTranslationTable.html">IDTranslationTable</a>: <span class="keyword">public</span> <a class="code" href="structDataBufferObject.html">DataBufferObject</a> {
00043 <span class="keyword">public</span>:
<a name="l00049"></a><a class="code" href="classIDTranslationTable.html#a0">00049</a>    <span class="keyword">explicit</span> <a class="code" href="classIDTranslationTable.html#a0">IDTranslationTable</a>(<span class="keywordtype">int</span> version = 0):
00050       <a class="code" href="classIDTranslationTable.html#r2">m_version</a>( version ) { };
00051    
<a name="l00055"></a><a class="code" href="classIDTranslationTable.html#a1">00055</a>    <span class="keyword">virtual</span> <a class="code" href="classIDTranslationTable.html#a1">~IDTranslationTable</a>() { };
00056    
00061    <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classIDTranslationTable.html#a2">getSizeInDataBuffer</a>() <span class="keyword">const</span>;
00062    
00068    <span class="keywordtype">void</span> <a class="code" href="classIDTranslationTable.html#a3">save</a>(<a class="code" href="classDataBuffer.html">DataBuffer</a>&amp; dbuf) <span class="keyword">const</span>;
00069    
00075    <span class="keywordtype">void</span> <a class="code" href="classIDTranslationTable.html#a4">load</a>(<a class="code" href="classDataBuffer.html">DataBuffer</a>&amp; dbuf);
00076 
00083    <span class="keywordtype">bool</span> <a class="code" href="classIDTranslationTable.html#a3">save</a>(<a class="code" href="classDataBuffer.html">DataBuffer</a>* dataBuffer, <span class="keywordtype">bool</span> twoTables = <span class="keyword">false</span>) <span class="keyword">const</span>;
00090    <span class="keywordtype">void</span> <a class="code" href="classIDTranslationTable.html#a4">load</a>(<a class="code" href="classDataBuffer.html">DataBuffer</a>&amp; dataBuffer, uint32 mapSet);
00091 
00097    <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classIDTranslationTable.html#a7">translateToHigher</a>(<span class="keyword">const</span> <a class="code" href="classIDPair__t.html">IDPair_t</a>&amp; lowerID) <span class="keyword">const</span>;
00098 
00106    <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classIDTranslationTable.html#a7">translateToHigher</a>(uint32 lowmapID, uint32 lowitemID) <span class="keyword">const</span>;
00107 
00114    <span class="keyword">inline</span> <a class="code" href="classIDPair__t.html">IDPair_t</a> <a class="code" href="classIDTranslationTable.html#a9">translateToLower</a>(uint32 higherID) <span class="keyword">const</span>;
00115    
00116 
<a name="l00117"></a><a class="code" href="classIDTranslationTable.html#w0">00117</a>    <span class="keyword">typedef</span> pair&lt;uint32, IDPair_t&gt; lookupElement_t;
<a name="l00118"></a><a class="code" href="classIDTranslationTable.html#w1">00118</a>    <span class="keyword">typedef</span> <a class="code" href="classvector.html">vector&lt;lookupElement_t&gt;</a> <a class="code" href="classvector.html">lookupTable_t</a>;
<a name="l00119"></a><a class="code" href="classIDTranslationTable.html#w2">00119</a>    <span class="keyword">typedef</span> <a class="code" href="classvector.html">vector&lt;uint32&gt;</a> <a class="code" href="classvector.html">reverseLookupTable_t</a>;
00120    
00121       
<a name="l00122"></a><a class="code" href="classIDTranslationTable.html#a10">00122</a>    <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classIDTranslationTable.html#a10">getNbrElements</a>()<span class="keyword"> const </span>{
00123       <span class="keywordflow">return</span> <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>.size();
00124    }
00125 
<a name="l00126"></a><a class="code" href="classIDTranslationTable.html#a11">00126</a>    <span class="keywordtype">bool</span> <a class="code" href="classIDTranslationTable.html#a11">getElement</a>(uint32 i,
00127                    uint32&amp; itemID,
00128                    uint32&amp; fullMapID,
00129                    uint32&amp; fullItemID)<span class="keyword"> const </span>{
00130       <span class="keywordflow">if</span> (i &lt; <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>.size()) {
00131          <a class="code" href="classIDTranslationTable.html#w0">lookupElement_t</a> elm = <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>[<a class="code" href="classIDTranslationTable.html#r1">m_reverseLookupTable</a>[i]];
00132          itemID = elm.first;
00133          fullMapID = elm.second.first;
00134          fullItemID = elm.second.second;
00135          <span class="keywordflow">return</span> <span class="keyword">true</span>;
00136       }
00137       <span class="keywordflow">return</span> <span class="keyword">false</span>;
00138    }
00139 
<a name="l00140"></a><a class="code" href="classIDTranslationTable.html#a12">00140</a>    <span class="keywordtype">bool</span> <a class="code" href="classIDTranslationTable.html#a12">addElement</a>(uint32 itemID, uint32 fullMapID, uint32 fullItemID) {
00141       <span class="keywordflow">return</span> <a class="code" href="classIDTranslationTable.html#a12">addElement</a>( <a class="code" href="classIDPair__t.html">IDPair_t</a>(fullMapID, fullItemID), itemID);
00142    };
00143 
<a name="l00144"></a><a class="code" href="classIDTranslationTable.html#a13">00144</a>    <span class="keywordtype">bool</span> <a class="code" href="classIDTranslationTable.html#a12">addElement</a>(<span class="keyword">const</span> <a class="code" href="classIDPair__t.html">IDPair_t</a>&amp; fullID, uint32 itemID) {
00145       <a class="code" href="classIDTranslationTable.html#w0">lookupElement_t</a> elm(itemID, fullID);
00146       <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>.push_back(elm);
00147       <span class="keywordflow">return</span> <span class="keyword">true</span>;
00148    };
00149 
<a name="l00153"></a><a class="code" href="classIDTranslationTable.html#a14">00153</a>    <span class="keywordtype">bool</span> <a class="code" href="classIDTranslationTable.html#a14">removeElement</a>( uint32 itemID ) {
00154       reverseLookupTable_t::iterator search_it =
00155          lower_bound( <a class="code" href="classIDTranslationTable.html#r1">m_reverseLookupTable</a>.begin(),
00156                       <a class="code" href="classIDTranslationTable.html#r1">m_reverseLookupTable</a>.end(), itemID,
00157                       <a class="code" href="structIDTranslationTable_1_1SearchLessThanIndex.html">SearchLessThanIndex</a>( <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a> ) );
00158 
00159       <span class="keywordflow">if</span> ( search_it != <a class="code" href="classIDTranslationTable.html#r1">m_reverseLookupTable</a>.end() &amp;&amp;
00160            <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>[*search_it].first == itemID) {
00161          lookupTable_t::iterator it = <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>.begin();
00162          advance(it,(*search_it));
00163          <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>.erase( it );
00164          <a class="code" href="classIDTranslationTable.html#r1">m_reverseLookupTable</a>.erase( search_it );
00165          <a class="code" href="classIDTranslationTable.html#a15">sortElements</a>();
00166          <span class="keywordflow">return</span> <span class="keyword">true</span>;
00167       }
00168       <span class="keywordflow">return</span> <span class="keyword">false</span>;
00169 
00170    }
00171 
<a name="l00172"></a><a class="code" href="classIDTranslationTable.html#a15">00172</a>    <span class="keywordtype">bool</span> <a class="code" href="classIDTranslationTable.html#a15">sortElements</a>() {
00173       sort( <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>.begin(), <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>.end(), 
00174             <a class="code" href="structIDTranslationTable_1_1SortLookup.html">SortLookup</a>() );
00175       <a class="code" href="classIDTranslationTable.html#d4">sortReverseTable</a>();
00176 
00177       <span class="keywordflow">return</span> <span class="keyword">true</span>;
00178    }
00179 
00180 <span class="keyword">private</span>:
00181    <span class="keywordtype">void</span> <a class="code" href="classIDTranslationTable.html#d0">loadOld</a>( <a class="code" href="classDataBuffer.html">DataBuffer</a>&amp; dbuf, uint32 mapSet );
00182    <span class="keywordtype">void</span> <a class="code" href="classIDTranslationTable.html#d1">saveOld</a>( <a class="code" href="classDataBuffer.html">DataBuffer</a>&amp; dbuf ) <span class="keyword">const</span>;
00183 
00184    <span class="keywordtype">void</span> <a class="code" href="classIDTranslationTable.html#d2">loadNew</a>( <a class="code" href="classDataBuffer.html">DataBuffer</a>&amp; dbuf, uint32 mapSet );
00185    <span class="keywordtype">void</span> <a class="code" href="classIDTranslationTable.html#d3">saveNew</a>( <a class="code" href="classDataBuffer.html">DataBuffer</a>&amp; dbuf ) <span class="keyword">const</span>;
00186 
<a name="l00187"></a><a class="code" href="classIDTranslationTable.html#d4">00187</a>    <span class="keywordtype">void</span> <a class="code" href="classIDTranslationTable.html#d4">sortReverseTable</a>() {
00188       <span class="comment">// resize and fill array with numbers from 0 to n</span>
00189       <span class="keywordflow">if</span> ( <a class="code" href="classIDTranslationTable.html#r1">m_reverseLookupTable</a>.size() != <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>.size() )
00190          <a class="code" href="classIDTranslationTable.html#r1">m_reverseLookupTable</a>.resize( <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>.size() );
00191 
00192       generate_n( <a class="code" href="classIDTranslationTable.html#r1">m_reverseLookupTable</a>.begin(),
00193                   <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>.size(), <a class="code" href="classSTLUtility_1_1Counter.html">STLUtility::Counter&lt;uint32&gt;</a>( 0 ) );
00194 
00195       <span class="comment">// sort numbers by using the lookupTable</span>
00196       sort( <a class="code" href="classIDTranslationTable.html#r1">m_reverseLookupTable</a>.begin(), <a class="code" href="classIDTranslationTable.html#r1">m_reverseLookupTable</a>.end(),
00197             <a class="code" href="structIDTranslationTable_1_1SortLessThanIndex.html">SortLessThanIndex</a>( <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a> ) );
00198    }
00199 
<a name="l00200"></a><a class="code" href="structIDTranslationTable_1_1SortLessThanIndex.html">00200</a>    <span class="keyword">struct </span><a class="code" href="structIDTranslationTable_1_1SortLessThanIndex.html">SortLessThanIndex</a> {
<a name="l00201"></a><a class="code" href="structIDTranslationTable_1_1SortLessThanIndex.html#a0">00201</a>       <a class="code" href="structIDTranslationTable_1_1SortLessThanIndex.html">SortLessThanIndex</a>(<span class="keyword">const</span> <a class="code" href="classvector.html">lookupTable_t</a>&amp; index):m_index(index) { }
<a name="l00202"></a><a class="code" href="structIDTranslationTable_1_1SortLessThanIndex.html#a1">00202</a>       <span class="keywordtype">bool</span> operator()( uint32 a, uint32 b )<span class="keyword"> const </span>{
00203          <span class="keywordflow">return</span> m_index[a].first &lt; m_index[b].first;
00204       }
00205 
<a name="l00206"></a><a class="code" href="structIDTranslationTable_1_1SortLessThanIndex.html#o0">00206</a>       <span class="keyword">const</span> <a class="code" href="classvector.html">lookupTable_t</a>&amp; m_index;
00207    };
00208 
<a name="l00209"></a><a class="code" href="structIDTranslationTable_1_1SearchLessThanIndex.html">00209</a>    <span class="keyword">struct </span><a class="code" href="structIDTranslationTable_1_1SearchLessThanIndex.html">SearchLessThanIndex</a> {
<a name="l00210"></a><a class="code" href="structIDTranslationTable_1_1SearchLessThanIndex.html#a0">00210</a>       <a class="code" href="structIDTranslationTable_1_1SearchLessThanIndex.html">SearchLessThanIndex</a>(<span class="keyword">const</span> <a class="code" href="classvector.html">lookupTable_t</a>&amp; index):
00211          m_index(index) { }
<a name="l00212"></a><a class="code" href="structIDTranslationTable_1_1SearchLessThanIndex.html#a1">00212</a>       <span class="keywordtype">bool</span> operator()( uint32 a, uint32 b )<span class="keyword"> const </span>{
00213          <span class="keywordflow">return</span> m_index[a].first &lt; b;
00214       }
<a name="l00215"></a><a class="code" href="structIDTranslationTable_1_1SearchLessThanIndex.html#o0">00215</a>       <span class="keyword">const</span> <a class="code" href="classvector.html">lookupTable_t</a>&amp; m_index;
00216    };
00217 
00218 
<a name="l00219"></a><a class="code" href="structIDTranslationTable_1_1SearchLookup.html">00219</a>    <span class="keyword">struct </span><a class="code" href="structIDTranslationTable_1_1SearchLookup.html">SearchLookup</a>:
00220       <span class="keyword">public</span> binary_function&lt;const lookupElement_t, 
00221       const IDPair_t, bool&gt; {
<a name="l00222"></a><a class="code" href="structIDTranslationTable_1_1SearchLookup.html#a0">00222</a>       <span class="keywordtype">bool</span> <a class="code" href="structIDTranslationTable_1_1SearchLookup.html#a0">operator()</a>( <span class="keyword">const</span> lookupElement_t&amp; x, 
00223                        <span class="keyword">const</span> <a class="code" href="classIDPair__t.html">IDPair_t</a>&amp; y )<span class="keyword"> const </span>{
00224          <span class="keywordflow">return</span> 
00225             x.second.first &lt; y.first ||
00226             ( x.second.first == y.first &amp;&amp;
00227               x.second.second &lt; y.second );
00228       }
00229    };
00230 
00231 
<a name="l00232"></a><a class="code" href="structIDTranslationTable_1_1SortLookup.html">00232</a>    <span class="keyword">struct </span><a class="code" href="structIDTranslationTable_1_1SortLookup.html">SortLookup</a>:
00233       <span class="keyword">public</span> binary_function&lt;const lookupElement_t,
00234       const lookupElement_t, bool&gt; {
<a name="l00235"></a><a class="code" href="structIDTranslationTable_1_1SortLookup.html#a0">00235</a>       <span class="keywordtype">bool</span> <a class="code" href="structIDTranslationTable_1_1SortLookup.html#a0">operator()</a>(<span class="keyword">const</span> lookupElement_t&amp; x,
00236                       <span class="keyword">const</span> lookupElement_t&amp; y)<span class="keyword"> const </span>{
00237          <span class="keywordflow">return</span> 
00238             x.second.first &lt; y.second.first ||
00239             ( x.second.first == y.second.first &amp;&amp;
00240               x.second.second &lt; y.second.second );
00241       }
00242    };
00243 
<a name="l00247"></a><a class="code" href="classIDTranslationTable.html#r0">00247</a>    <a class="code" href="classvector.html">lookupTable_t</a> m_lookupTable;
00248 
<a name="l00252"></a><a class="code" href="classIDTranslationTable.html#r1">00252</a>    <a class="code" href="classvector.html">reverseLookupTable_t</a> m_reverseLookupTable;
00253 
<a name="l00254"></a><a class="code" href="classIDTranslationTable.html#r2">00254</a>    <span class="keywordtype">int</span> m_version;
<a name="l00255"></a><a class="code" href="classIDTranslationTable.html#n0">00255</a>    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classM3Creator.html">M3Creator</a>; <span class="comment">// must be able to modifiy old/new version</span>
00256 };
00257 
00258 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00259"></a><a class="code" href="classIDTranslationTable.html#a7">00259</a> <a class="code" href="classIDTranslationTable.html#a7">IDTranslationTable::translateToHigher</a>(<span class="keyword">const</span> <a class="code" href="classIDPair__t.html">IDPair_t</a>&amp; lowerID)<span class="keyword"> const</span>
00260 <span class="keyword"></span>{
00261    <span class="comment">// Keep the node !</span>
00262    <span class="keyword">const</span> <a class="code" href="Types_8h.html#a21">uint32</a> nodePattern = lowerID.second &amp; 0x80000000;
00263    <a class="code" href="classIDPair__t.html">IDPair_t</a> lookupNode(lowerID.first, lowerID.second &amp; 0x7fffffff);
00264    lookupTable_t::const_iterator it = 
00265       lower_bound( <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>.begin(),
00266                    <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>.end(),
00267                    lookupNode, <a class="code" href="structIDTranslationTable_1_1SearchLookup.html">SearchLookup</a>() );
00268    <span class="keywordflow">if</span> ( it == <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>.end() ||
00269         (*it).second != lookupNode ) {
00270       <span class="keywordflow">return</span> MAX_UINT32;
00271    }
00272    <span class="comment">// add the node-information again  ...?</span>
00273    <span class="keywordflow">return</span> (*it).first | nodePattern;
00274 }
00275 
00276 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00277"></a><a class="code" href="classIDTranslationTable.html#a8">00277</a> <a class="code" href="classIDTranslationTable.html#a7">IDTranslationTable::translateToHigher</a>(uint32 lowmapID, 
00278                                       uint32 lowitemID)<span class="keyword"> const</span>
00279 <span class="keyword"></span>{   
00280    <span class="keywordflow">return</span> <a class="code" href="classIDTranslationTable.html#a7">translateToHigher</a>( <a class="code" href="classIDPair__t.html">IDPair_t</a>(lowmapID, lowitemID) );
00281 }
00282 
00283 <span class="keyword">inline</span> <a class="code" href="classIDPair__t.html">IDPair_t</a>
<a name="l00284"></a><a class="code" href="classIDTranslationTable.html#a9">00284</a> <a class="code" href="classIDTranslationTable.html#a9">IDTranslationTable::translateToLower</a>(uint32 higherID)<span class="keyword"> const</span>
00285 <span class="keyword"></span>{
00286    <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classIDPair__t.html">IDPair_t</a> inval(<a class="code" href="Types_8h.html#a4">MAX_UINT32</a>, <a class="code" href="Types_8h.html#a4">MAX_UINT32</a>);
00287    <span class="keyword">const</span> <a class="code" href="Types_8h.html#a21">uint32</a> nodePattern = higherID &amp; 0x80000000;
00288    <span class="keyword">const</span> <a class="code" href="Types_8h.html#a21">uint32</a> itemID =      higherID &amp; 0x7fffffff;         
00289    reverseLookupTable_t::const_iterator it = 
00290       lower_bound( <a class="code" href="classIDTranslationTable.html#r1">m_reverseLookupTable</a>.begin(),
00291                    <a class="code" href="classIDTranslationTable.html#r1">m_reverseLookupTable</a>.end(),
00292                    itemID,
00293                    <a class="code" href="structIDTranslationTable_1_1SearchLessThanIndex.html">SearchLessThanIndex</a>( <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a> ) );
00294    <span class="keywordflow">if</span> ( it == <a class="code" href="classIDTranslationTable.html#r1">m_reverseLookupTable</a>.end() ||
00295         <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>[*it].first != itemID ) {
00296       <span class="keywordflow">return</span> inval;
00297    }
00298 
00299    <span class="comment">// add node pattern and return search result</span>
00300    <span class="keywordflow">return</span> <a class="code" href="classIDPair__t.html">IDPair_t</a>(<a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>[*it].second.first,
00301                    <a class="code" href="classIDTranslationTable.html#r0">m_lookupTable</a>[*it].second.second | nodePattern);
00302 
00303 }
00304 
00305 
00306 <span class="preprocessor">#endif</span>
00307 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jun 30 10:11:47 2010 for mc2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
