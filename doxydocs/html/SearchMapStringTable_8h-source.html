<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mc2: SearchMapStringTable.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">Server</a>&nbsp;/&nbsp;<a class="el" href="dir_000010.html">Modules</a>&nbsp;/&nbsp;<a class="el" href="dir_000021.html">include</a></div>
<h1>SearchMapStringTable.h</h1><a href="SearchMapStringTable_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">Copyright (c) 1999 - 2010, Vodafone Group Services Ltd</span>
00003 <span class="comment">All rights reserved.</span>
00004 <span class="comment"></span>
00005 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
00008 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
00009 <span class="comment">    * Neither the name of the Vodafone Group Services Ltd nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
00010 <span class="comment"></span>
00011 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#ifndef SEARCHMAPSTRINGTABLE_H</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define SEARCHMAPSTRINGTABLE_H</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00018 
00019 <span class="preprocessor">#include "<a class="code" href="STLStringUtility_8h.html">STLStringUtility.h</a>"</span>
00020 <span class="preprocessor">#include "<a class="code" href="ItemTypes_8h.html">ItemTypes.h</a>"</span>
00021 <span class="preprocessor">#include "<a class="code" href="NameUtility_8h.html">NameUtility.h</a>"</span>
00022 <span class="preprocessor">#include "<a class="code" href="ArrayTools_8h.html">ArrayTools.h</a>"</span>
00023 <span class="preprocessor">#include "<a class="code" href="SearchMapRegionTable_8h.html">SearchMapRegionTable.h</a>"</span>
00024 
00025 <span class="preprocessor">#include &lt;set&gt;</span>
00026 <span class="preprocessor">#include &lt;map&gt;</span>
00027 
00028 
00029 <span class="keyword">class </span><a class="code" href="classDataBuffer.html">DataBuffer</a>;
00030 <span class="keyword">class </span><a class="code" href="classSearchMapRegionTable.html">SearchMapRegionTable</a>;
00031 <span class="keyword">class </span><a class="code" href="classWriteableSearchMapRegionTable.html">WriteableSearchMapRegionTable</a>;
00032 <span class="keyword">class </span><a class="code" href="classItemNames.html">ItemNames</a>;
00033 <span class="keyword">class </span><a class="code" href="classGenericMap.html">GenericMap</a>;
00034 
<a name="l00039"></a><a class="code" href="classSearchMapStringTable.html">00039</a> <span class="keyword">class </span><a class="code" href="classSearchMapStringTable.html">SearchMapStringTable</a> {
00040 <span class="keyword">public</span>:
00044    <a class="code" href="classSearchMapStringTable.html">SearchMapStringTable</a>();
00045 
00049    <span class="keyword">virtual</span> ~<a class="code" href="classSearchMapStringTable.html">SearchMapStringTable</a>();
00050 
00054    <span class="keywordtype">int</span> getSizeInDataBuffer() <span class="keyword">const</span>;
00055 
00059    <span class="keywordtype">int</span> <a class="code" href="namespaceTileFeatureScaleRange.html#a4">load</a>(<a class="code" href="classDataBuffer.html">DataBuffer</a>&amp; dataBuffer);
00060 
00064    <span class="keywordtype">int</span> <a class="code" href="namespaceTileFeatureScaleRange.html#a3">save</a>(<a class="code" href="classDataBuffer.html">DataBuffer</a>&amp; dataBuffer) <span class="keyword">const</span>;
00065 
00070    <span class="keyword">inline</span> <span class="keywordtype">int</span> getComboNbrNames(<a class="code" href="Types_8h.html#a21">uint32</a> idx) <span class="keyword">const</span>;
00071 
00076    <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getComboNameIdx(<span class="keywordtype">int</span> nameNbr, <a class="code" href="Types_8h.html#a21">uint32</a> idx) <span class="keyword">const</span>;
00077 
00084    <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getBestIdxInCombo(LangTypes::language_t lang,
00085                                    <a class="code" href="Types_8h.html#a21">uint32</a> comboIdx) <span class="keyword">const</span>;
00086 
00097    <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getBestIdxOfTypeInCombo( LangTypes::language_t lang,
00098                                           ItemTypes::name_t type,
00099                                           <a class="code" href="Types_8h.html#a21">uint32</a> comboIdx) <span class="keyword">const </span>;
00100 
00107    <span class="keyword">inline</span> pair&lt;const char*, LangTypes::language_t&gt;
00108       getBestNameInCombo(LangTypes::language_t lang,
00109                          <a class="code" href="Types_8h.html#a21">uint32</a> idx) <span class="keyword">const</span>;
00110 
00114    <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* getName(<a class="code" href="Types_8h.html#a21">uint32</a> stringIndex) <span class="keyword">const</span>;
00115    
00116    
00120    <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> getTotalStringSize() <span class="keyword">const</span>;   
00121    
00122 <span class="keyword">protected</span>:
00123 
00130    <span class="keyword">enum</span> {
00131       index_to_offset_factor = 4,
00132    };
00133    
<a name="l00137"></a><a class="code" href="classSearchMapStringTable.html#f0">00137</a>    <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> indexToOffset( uint32 idx ) {
00138       <span class="keywordflow">return</span> idx * index_to_offset_factor;
00139    }
00140 
<a name="l00144"></a><a class="code" href="classSearchMapStringTable.html#f1">00144</a>    <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> offsetToIndex( uint32 offset ) {
00145       <span class="keywordflow">return</span> offset / index_to_offset_factor;
00146    }
00147    
<a name="l00151"></a><a class="code" href="classSearchMapStringTable.html#f2">00151</a>    <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> canBeIndexed( uint32 offset ) {
00152       <span class="keywordflow">return</span> ( offset % index_to_offset_factor ) == 0;
00153    }
00154 
<a name="l00158"></a><a class="code" href="classSearchMapStringTable.html#p0">00158</a>    <span class="keywordtype">char</span>* m_strings;
00159 
<a name="l00163"></a><a class="code" href="classSearchMapStringTable.html#p1">00163</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_nbrCharsUsed;
00164 
<a name="l00169"></a><a class="code" href="classSearchMapStringTable.html#p2">00169</a>    <a class="code" href="classSearchMapRegionTable.html">SearchMapRegionTable</a>* m_stringCombos;
00170    
00171 };
00172 
00173 <span class="comment">// -- The writeable version</span>
00174 
<a name="l00175"></a><a class="code" href="classWriteableSearchMapStringTable.html">00175</a> <span class="keyword">class </span><a class="code" href="classWriteableSearchMapStringTable.html">WriteableSearchMapStringTable</a> : <span class="keyword">public</span> <a class="code" href="classSearchMapStringTable.html">SearchMapStringTable</a> {
00176 
00177 <span class="keyword">public</span>:
00181    <a class="code" href="classWriteableSearchMapStringTable.html#a0">WriteableSearchMapStringTable</a>();
00182 
<a name="l00186"></a><a class="code" href="classWriteableSearchMapStringTable.html#a1">00186</a>    <a class="code" href="classWriteableSearchMapStringTable.html#a1">~WriteableSearchMapStringTable</a>() {
00187       <a class="code" href="MC2Logging_8h.html#a2">mc2dbg</a> &lt;&lt; <span class="stringliteral">"[WSMST]: Total pad is "</span> &lt;&lt; <a class="code" href="classWriteableSearchMapStringTable.html#p3">m_totalPad</a> &lt;&lt; endl;
00188    }
00189   
00203    <span class="keyword">template</span>&lt;<span class="keyword">class</span> ITERATABLE&gt;
00204    <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classWriteableSearchMapStringTable.html#a2">addStringCombo</a>(<span class="keyword">const</span> ITERATABLE&amp; rawStrings,
00205                          <span class="keyword">const</span> <a class="code" href="classmap.html">map&lt;uint32, uint32&gt;</a>* theMap = NULL);
00206 
00207 
00213    <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a> <a class="code" href="classWriteableSearchMapStringTable.html#a3">addItemName</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name);
00214    
00215 <span class="keyword">protected</span>:
00216       
<a name="l00220"></a><a class="code" href="classWriteableSearchMapStringTable.html#p0">00220</a>    <a class="code" href="classWriteableSearchMapRegionTable.html">WriteableSearchMapRegionTable</a>* m_writeableStringCombos;
00221 
<a name="l00225"></a><a class="code" href="classWriteableSearchMapStringTable.html#p1">00225</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_allocatedStringSize;
00226 
<a name="l00230"></a><a class="code" href="classWriteableSearchMapStringTable.html#x0">00230</a>    <span class="keyword">typedef</span> <a class="code" href="classmap.html">map&lt;const char*, uint32, STLStringUtility::ltstr&gt;</a> <a class="code" href="classmap.html">stringMap_t</a>;
00231    
<a name="l00236"></a><a class="code" href="classWriteableSearchMapStringTable.html#p2">00236</a>    <a class="code" href="classmap.html">stringMap_t</a> m_stringMap;
00237 
<a name="l00241"></a><a class="code" href="classWriteableSearchMapStringTable.html#p3">00241</a>    <a class="code" href="Types_8h.html#a21">uint32</a> m_totalPad;
00242    
00243 };
00244 
00245 <span class="comment">// -- Inlined funcs</span>
00246 
00247 <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00248"></a><a class="code" href="classSearchMapStringTable.html#a5">00248</a> <a class="code" href="classSearchMapStringTable.html#a5">SearchMapStringTable::getComboNbrNames</a>(uint32 idx)<span class="keyword"> const</span>
00249 <span class="keyword"></span>{
00250    <span class="keywordflow">return</span> <a class="code" href="classSearchMapStringTable.html#p2">m_stringCombos</a>-&gt;<a class="code" href="classSearchMapRegionTable.html#a8">getNbrRegions</a>(idx);
00251 }
00252 
00253 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00254"></a><a class="code" href="classSearchMapStringTable.html#a6">00254</a> <a class="code" href="classSearchMapStringTable.html#a6">SearchMapStringTable::getComboNameIdx</a>(<span class="keywordtype">int</span> nameNbr, uint32 idx)<span class="keyword"> const</span>
00255 <span class="keyword"></span>{
00256    <span class="keywordflow">return</span> <a class="code" href="classSearchMapStringTable.html#p2">m_stringCombos</a>-&gt;<a class="code" href="classSearchMapRegionTable.html#a7">getRegion</a>(nameNbr, idx);
00257 }
00258 
00259 <span class="keyword">const</span> <span class="keywordtype">char</span>*
<a name="l00260"></a><a class="code" href="classSearchMapStringTable.html#a10">00260</a> <a class="code" href="classSearchMapStringTable.html#a10">SearchMapStringTable::getName</a>(uint32 idx)<span class="keyword"> const</span>
00261 <span class="keyword"></span>{
00262    <a class="code" href="Types_8h.html#a21">uint32</a> offset = <a class="code" href="classSearchMapStringTable.html#f0">indexToOffset</a>( idx );
00263    <a class="code" href="config_8h.html#a29">MC2_ASSERT</a>( offset &lt; <a class="code" href="classSearchMapStringTable.html#p1">m_nbrCharsUsed</a> );
00264    <span class="keywordflow">return</span> &amp;<a class="code" href="classSearchMapStringTable.html#p0">m_strings</a>[ offset ];
00265 }
00266    
00267 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00268"></a><a class="code" href="classSearchMapStringTable.html#a7">00268</a> <a class="code" href="classSearchMapStringTable.html#a7">SearchMapStringTable::getBestIdxInCombo</a>(LangTypes::language_t lang,
00269                                         uint32 idx)<span class="keyword"> const</span>
00270 <span class="keyword"></span>{
00271    <span class="keyword">const</span> <span class="keywordtype">int</span> nbrNames = <a class="code" href="classSearchMapStringTable.html#a5">getComboNbrNames</a>(idx);
00272    <span class="keywordflow">if</span> ( nbrNames == 0 ) {
00273       <span class="keywordflow">return</span> MAX_UINT32;
00274    }
00275    <a class="code" href="SearchMapRegionTable_8h.html#a0">SearchMapRegionIterator</a> ptr = <a class="code" href="classSearchMapStringTable.html#p2">m_stringCombos</a>-&gt;<a class="code" href="classSearchMapRegionTable.html#a5">begin</a>(idx);
00276    <span class="keywordtype">int</span> chosenNbr = <a class="code" href="classNameUtility.html#e0">NameUtility::getBestName</a>(nbrNames,
00277                                             ptr,
00278                                             lang);
00279    <span class="keywordflow">if</span> ( chosenNbr &lt; 0 ) {
00280       <span class="keywordflow">return</span> MAX_UINT32;
00281    } <span class="keywordflow">else</span> {
00282       <span class="keywordflow">return</span> <a class="code" href="classSearchMapStringTable.html#a6">getComboNameIdx</a>(chosenNbr, idx);
00283    }
00284 }
00285 
00286 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00287"></a><a class="code" href="classSearchMapStringTable.html#a8">00287</a> <a class="code" href="classSearchMapStringTable.html#a8">SearchMapStringTable::getBestIdxOfTypeInCombo</a>( LangTypes::language_t lang,
00288                                                ItemTypes::name_t type,
00289                                                uint32 comboIdx )<span class="keyword"> const</span>
00290 <span class="keyword"></span>{
00291    <span class="keyword">const</span> <span class="keywordtype">int</span> nbrNames = <a class="code" href="classSearchMapStringTable.html#a5">getComboNbrNames</a>(comboIdx);
00292    
00293    <span class="keywordflow">if</span> ( nbrNames == 0 ) {
00294       <span class="keywordflow">return</span> MAX_UINT32;
00295    }
00296    <a class="code" href="SearchMapRegionTable_8h.html#a0">SearchMapRegionIterator</a> ptr = <a class="code" href="classSearchMapStringTable.html#p2">m_stringCombos</a>-&gt;<a class="code" href="classSearchMapRegionTable.html#a5">begin</a>(comboIdx);
00297    <span class="keywordtype">int</span> chosenNbr = <a class="code" href="classNameUtility.html#e4">NameUtility::getBestNameOfType</a>( nbrNames,
00298                                                    ptr,
00299                                                    lang,
00300                                                    type );
00301    <span class="keywordflow">if</span> ( chosenNbr &lt; 0 ) {
00302       <span class="keywordflow">return</span> MAX_UINT32;
00303    } <span class="keywordflow">else</span> {
00304       <span class="keywordflow">return</span> <a class="code" href="classSearchMapStringTable.html#a6">getComboNameIdx</a>(chosenNbr, comboIdx);
00305    }
00306 }
00307 
00308 <span class="keyword">inline</span> pair&lt;const char*, LangTypes::language_t&gt;
<a name="l00309"></a><a class="code" href="classSearchMapStringTable.html#a9">00309</a> <a class="code" href="classSearchMapStringTable.html#a9">SearchMapStringTable::getBestNameInCombo</a>(LangTypes::language_t lang,
00310                                          uint32 idx)<span class="keyword"> const</span>
00311 <span class="keyword"></span>{
00312    <span class="keyword">const</span> <a class="code" href="Types_8h.html#a21">uint32</a> tmpNameOffset = <a class="code" href="classSearchMapStringTable.html#a7">getBestIdxInCombo</a>(lang, idx);
00313    <span class="keywordflow">if</span> ( tmpNameOffset != MAX_UINT32 ) {
00314       <span class="keywordflow">return</span> pair&lt;const char*, LangTypes::language_t&gt;
00315          (<a class="code" href="classSearchMapStringTable.html#a10">getName</a>(<a class="code" href="ItemTypes_8h.html#a10">GET_STRING_INDEX</a>(tmpNameOffset)),
00316           <a class="code" href="ItemTypes_8h.html#a4">GET_STRING_LANGUAGE</a>(tmpNameOffset));
00317    } <span class="keywordflow">else</span> {
00318       <span class="keywordflow">return</span> pair&lt;const char*, LangTypes::language_t&gt;
00319          (NULL, LangTypes::invalidLanguage);
00320    }
00321 }
00322 
00323 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00324"></a><a class="code" href="classSearchMapStringTable.html#a11">00324</a> <a class="code" href="classSearchMapStringTable.html#a11">SearchMapStringTable::getTotalStringSize</a>()<span class="keyword"> const</span>
00325 <span class="keyword"></span>{
00326    <span class="keywordflow">return</span> m_nbrCharsUsed;
00327 }
00328 
00329 <span class="keyword">inline</span> <a class="code" href="Types_8h.html#a21">uint32</a>
<a name="l00330"></a><a class="code" href="classWriteableSearchMapStringTable.html#a3">00330</a> <a class="code" href="classWriteableSearchMapStringTable.html#a3">WriteableSearchMapStringTable::addItemName</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name)
00331 {
00332    <a class="code" href="config_8h.html#a29">MC2_ASSERT</a>( <a class="code" href="classSearchMapStringTable.html#f2">canBeIndexed</a>( m_nbrCharsUsed ) );
00333 
00334    pair&lt;stringMap_t::iterator, bool&gt; res =
00335       <a class="code" href="classWriteableSearchMapStringTable.html#p2">m_stringMap</a>.insert(make_pair(name, m_nbrCharsUsed) );
00336 
00337    <span class="keywordflow">if</span> ( res.second == false ) {
00338       <span class="comment">// Not inserted</span>
00339    } <span class="keywordflow">else</span> {
00340       <span class="comment">// Inserted - now we must keep our promise and add it</span>
00341       <span class="keywordtype">int</span> len = strlen(name) + 1;
00342       
00343       <span class="comment">// Insert all the substrings in the map too. There may</span>
00344       <span class="comment">// be some room that can be saved that way.</span>
00345       <span class="comment">// The first one is already added.</span>
00346 
00347       <span class="comment">//</span>
00348       <span class="comment">// Adds substrings as:</span>
00349       <span class="comment">// abcd</span>
00350       <span class="comment">// bcd</span>
00351       <span class="comment">// cd</span>
00352       <span class="comment">// d</span>
00353       <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; len; ++i ) {
00354          <span class="comment">// Skip the ones that cannot be indexed anyway.</span>
00355          <span class="keywordflow">if</span> ( <a class="code" href="classSearchMapStringTable.html#f2">canBeIndexed</a>( m_nbrCharsUsed ) ) {
00356             <a class="code" href="classWriteableSearchMapStringTable.html#p2">m_stringMap</a>.insert(make_pair(&amp;name[i], m_nbrCharsUsed));
00357          } <span class="keywordflow">else</span> {
00358             <a class="code" href="MC2Logging_8h.html#a6">mc2dbg8</a> &lt;&lt; <span class="stringliteral">"[WSMST]: "</span> &lt;&lt; m_nbrCharsUsed &lt;&lt; <span class="stringliteral">" cannot be indexed"</span>
00359                     &lt;&lt; endl;
00360          }
00361 
00362          <span class="comment">// Add the character to the array of characters</span>
00363          m_strings = <a class="code" href="namespaceArrayTool.html#a1">ArrayTool::addElement</a>(m_strings, name[i], m_nbrCharsUsed,
00364                                          <a class="code" href="classWriteableSearchMapStringTable.html#p1">m_allocatedStringSize</a>);
00365       }
00366       <span class="comment">// Pad if uneven number of characters.</span>
00367       <span class="keywordflow">while</span> ( ! <a class="code" href="classSearchMapStringTable.html#f2">canBeIndexed</a>( m_nbrCharsUsed ) ) {
00368          ++m_totalPad;
00369          m_strings = <a class="code" href="namespaceArrayTool.html#a1">ArrayTool::addElement</a>(m_strings, <span class="charliteral">'\0'</span>, m_nbrCharsUsed,
00370                                          <a class="code" href="classWriteableSearchMapStringTable.html#p1">m_allocatedStringSize</a>);
00371       }
00372    }
00373 
00374    <span class="keywordflow">return</span> <a class="code" href="classSearchMapStringTable.html#f1">offsetToIndex</a>( res.first-&gt;second );
00375    
00376 }
00377 
00378 <span class="keyword">template</span> &lt;<span class="keyword">class</span> ITERATABLE&gt;
00379 <a class="code" href="Types_8h.html#a21">uint32</a>
00380 <a class="code" href="classWriteableSearchMapStringTable.html#a2">WriteableSearchMapStringTable::</a>
<a name="l00381"></a><a class="code" href="classWriteableSearchMapStringTable.html#a2">00381</a> <a class="code" href="classWriteableSearchMapStringTable.html#a2">addStringCombo</a>(<span class="keyword">const</span> ITERATABLE&amp; rawStrings,
00382                <span class="keyword">const</span> <a class="code" href="classmap.html">map&lt;uint32,uint32&gt;</a>* theMap)
00383 {
00384    <span class="comment">// Start by adding and exchanging the indeces for our indeces.</span>
00385    set&lt;uint32&gt; newCombo;
00386    <span class="keywordflow">for</span>(<span class="keyword">typename</span> ITERATABLE::const_iterator it = rawStrings.begin();
00387        it != rawStrings.end();
00388        ++it ) {
00389       LangTypes::language_t strLang = <a class="code" href="ItemTypes_8h.html#a4">GET_STRING_LANGUAGE</a>(it-&gt;first);
00390       ItemTypes::name_t strType     = <a class="code" href="ItemTypes_8h.html#a7">GET_STRING_TYPE</a>(it-&gt;first);
00391       <a class="code" href="Types_8h.html#a21">uint32</a> strIdx                 = <a class="code" href="ItemTypes_8h.html#a10">GET_STRING_INDEX</a>(it-&gt;second);
00392       
00393       <span class="comment">// Exchange the name for our name</span>
00394       <span class="keywordflow">if</span> ( theMap ) {
00395          strIdx = theMap-&gt;find(strIdx)-&gt;second;
00396       }
00397 
00398       <span class="comment">// Check so that the strIdx isn't too large.</span>
00399       <span class="keywordflow">if</span> ( strIdx != <a class="code" href="ItemTypes_8h.html#a10">GET_STRING_INDEX</a>( strIdx ) ) {
00400          <a class="code" href="MC2Logging_8h.html#a2">mc2dbg</a> &lt;&lt; <span class="stringliteral">"[SMST]: String index "</span> &lt;&lt; strIdx &lt;&lt; <span class="stringliteral">" to high"</span>
00401                 &lt;&lt; endl;
00402       }
00403       <a class="code" href="config_8h.html#a29">MC2_ASSERT</a>( strIdx == <a class="code" href="ItemTypes_8h.html#a10">GET_STRING_INDEX</a>( strIdx ) );
00404      
00405       newCombo.insert( <a class="code" href="ItemTypes_8h.html#a12">CREATE_NEW_NAME</a>(strLang, strType, strIdx) );      
00406    }
00407 
00408    <span class="comment">// Return the index of the combination.</span>
00409    <span class="keywordflow">return</span> <a class="code" href="classWriteableSearchMapStringTable.html#p0">m_writeableStringCombos</a>-&gt;<a class="code" href="classWriteableSearchMapRegionTable.html#a2">addRegionCombo</a>(newCombo);
00410 }
00411 
00412 
00413 
00414 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jun 30 10:11:50 2010 for mc2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
