<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mc2: GfxData.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">Server</a>&nbsp;/&nbsp;<a class="el" href="dir_000005.html">Shared</a>&nbsp;/&nbsp;<a class="el" href="dir_000045.html">Gfx</a>&nbsp;/&nbsp;<a class="el" href="dir_000046.html">include</a></div>
<h1>GfxData.h</h1><a href="GfxData_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">Copyright (c) 1999 - 2010, Vodafone Group Services Ltd</span>
00003 <span class="comment">All rights reserved.</span>
00004 <span class="comment"></span>
00005 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
00008 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
00009 <span class="comment">    * Neither the name of the Vodafone Group Services Ltd nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
00010 <span class="comment"></span>
00011 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#ifndef GFXDATA_H</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define GFXDATA_H</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00018 
00019 <span class="preprocessor">#include &lt;vector&gt;</span>
00020 <span class="preprocessor">#include &lt;set&gt;</span>
00021 <span class="preprocessor">#include &lt;utility&gt;</span>
00022 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
00023 <span class="preprocessor">#include &lt;algorithm&gt;</span>
00024 <span class="preprocessor">#include &lt;functional&gt;</span>
00025 <span class="preprocessor">#include &lt;cmath&gt;</span>
00026 <span class="preprocessor">#include &lt;iterator&gt;</span>
00027 <span class="preprocessor">#include &lt;fstream&gt;</span>
00028 
00029 <span class="preprocessor">#include "<a class="code" href="MC2BoundingBox_8h.html">MC2BoundingBox.h</a>"</span>
00030 <span class="preprocessor">#include "<a class="code" href="CoordinateTransformer_8h.html">CoordinateTransformer.h</a>"</span>
00031 <span class="preprocessor">#include "<a class="code" href="GfxDataTypes_8h.html">GfxDataTypes.h</a>"</span>
00032 <span class="preprocessor">#include "<a class="code" href="FilteredCoord_8h.html">FilteredCoord.h</a>"</span>
00033 
00034 <span class="keyword">class </span><a class="code" href="classGenericMap.html">GenericMap</a>;
00035 <span class="keyword">class </span>ConvexHullNotice;
00036 <span class="keyword">class </span><a class="code" href="classDataBuffer.html">DataBuffer</a>;
00037 <span class="keyword">class </span><a class="code" href="classStack.html">Stack</a>;
00038 
00039 <span class="keyword">class </span><a class="code" href="classGfxData.html">GfxData</a>;
00040 <span class="keyword">class </span><a class="code" href="classGfxDataFull.html">GfxDataFull</a>;
00041 
<a name="l00049"></a><a class="code" href="classGfxDataFilterIterator.html">00049</a> <span class="keyword">class </span><a class="code" href="classGfxDataFilterIterator.html">GfxDataFilterIterator</a> {
00050    
00051 <span class="keyword">public</span>:
00052 
<a name="l00054"></a><a class="code" href="classGfxDataFilterIterator.html#w0">00054</a>    <span class="keyword">typedef</span> <a class="code" href="classMC2Coordinate.html">MC2Coordinate</a> <a class="code" href="classMC2Coordinate.html">value_type</a>;
00055    
<a name="l00062"></a><a class="code" href="classGfxDataFilterIterator.html#a0">00062</a>    <a class="code" href="classGfxDataFilterIterator.html">GfxDataFilterIterator</a>( <span class="keyword">const</span> <a class="code" href="classMC2Coordinate.html">MC2Coordinate</a>* curPos,
00063                           <span class="keyword">const</span> <a class="code" href="classMC2Coordinate.html">MC2Coordinate</a>* end,
00064                           uint8 filterLevel ) :
00065       m_filterLevel(filterLevel) {
00066       m_curPos = curPos;
00067       m_end    = end;
00068    }
00069    
<a name="l00073"></a><a class="code" href="classGfxDataFilterIterator.html#a1">00073</a>    <span class="keywordtype">bool</span> <a class="code" href="namespaceSTLUtility.html#a31">operator==</a>(<span class="keyword">const</span> <a class="code" href="classGfxDataFilterIterator.html">GfxDataFilterIterator</a>&amp; other)<span class="keyword"> const </span>{
00074       <span class="keywordflow">return</span> ( ( other.<a class="code" href="classGfxDataFilterIterator.html#r0">m_curPos</a> == m_curPos ) &amp;&amp;
00075                ( other.<a class="code" href="classGfxDataFilterIterator.html#r2">m_filterLevel</a> == m_filterLevel) );
00076    }
00077 
<a name="l00081"></a><a class="code" href="classGfxDataFilterIterator.html#a2">00081</a>    <span class="keywordtype">bool</span> <a class="code" href="namespaceSTLUtility.html#a33">operator!=</a>(<span class="keyword">const</span> <a class="code" href="classGfxDataFilterIterator.html">GfxDataFilterIterator</a>&amp; other)<span class="keyword"> const </span>{
00082       <span class="keywordflow">return</span> ! (other == *<span class="keyword">this</span>);
00083    }
00084    
<a name="l00088"></a><a class="code" href="classGfxDataFilterIterator.html#a3">00088</a>    <span class="keyword">inline</span> <span class="keyword">const</span> value_type&amp; operator*()<span class="keyword"> const </span>{
00089       <a class="code" href="config_8h.html#a29">MC2_ASSERT</a>( m_curPos &lt; m_end );
00090       <span class="keywordflow">return</span> *m_curPos;
00091    }
00092 
<a name="l00096"></a><a class="code" href="classGfxDataFilterIterator.html#a4">00096</a>    <span class="keyword">const</span> <a class="code" href="classGfxDataFilterIterator.html">GfxDataFilterIterator</a>&amp; operator++() {
00097       <span class="keywordflow">if</span> ( m_curPos &lt; m_end ) {
00098          <span class="keywordflow">while</span> ( ++m_curPos != m_end &amp;&amp;
00099                  <a class="code" href="classFilteredCoord.html#a0">FilteredCoord::getFilterLevel</a>(**<span class="keyword">this</span>) &lt; m_filterLevel ) {
00100             <span class="comment">// Step</span>
00101          }
00102       } <span class="keywordflow">else</span> {
00103          <span class="comment">// Will crash sooner or later.</span>
00104          ++m_curPos;
00105       }
00106       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00107    }
00108    
00109 <span class="keyword">private</span>:
<a name="l00111"></a><a class="code" href="classGfxDataFilterIterator.html#r0">00111</a>    <span class="keyword">const</span> <a class="code" href="classMC2Coordinate.html">MC2Coordinate</a>* m_curPos;
<a name="l00113"></a><a class="code" href="classGfxDataFilterIterator.html#r1">00113</a>    <span class="keyword">const</span> <a class="code" href="classMC2Coordinate.html">MC2Coordinate</a>* m_end;
<a name="l00115"></a><a class="code" href="classGfxDataFilterIterator.html#r2">00115</a>    <a class="code" href="Types_8h.html#a17">uint8</a> m_filterLevel;
00116 };
00117 
<a name="l00135"></a><a class="code" href="classGfxData.html">00135</a> <span class="keyword">class </span><a class="code" href="classGfxData.html">GfxData</a> {
00136 <span class="keyword">public</span>:
<a name="l00138"></a><a class="code" href="classGfxData.html#w0">00138</a>    <span class="keyword">typedef</span> <a class="code" href="Types_8h.html#a22">int32</a> coordinate_type;
00139       
<a name="l00141"></a><a class="code" href="classGfxData.html#w1">00141</a>    <span class="keyword">typedef</span> <a class="code" href="classMC2Coordinate.html">MC2Coordinate</a>* <a class="code" href="classMC2Coordinate.html">iterator</a>;
<a name="l00143"></a><a class="code" href="classGfxData.html#w2">00143</a>    <span class="keyword">typedef</span> <span class="keyword">const</span> <a class="code" href="classMC2Coordinate.html">MC2Coordinate</a>* <a class="code" href="classMC2Coordinate.html">const_iterator</a>;
00144 
00145    <span class="keyword">static</span> <a class="code" href="classGfxDataFull.html">GfxDataFull</a>* createNewGfxData(<a class="code" href="classGenericMap.html">GenericMap</a>* theMap, 
00146                                         <span class="keywordtype">bool</span> createNewPolygon=<span class="keyword">false</span>);
00147          
00148    <span class="keyword">static</span> <a class="code" href="classGfxData.html">GfxData</a>* createNewGfxData(<a class="code" href="classGenericMap.html">GenericMap</a>* theMap, 
00149                                     <span class="keyword">const</span> <a class="code" href="classMC2BoundingBox.html">MC2BoundingBox</a>* bbox);
00150 
00151    <span class="keyword">static</span> <a class="code" href="classGfxData.html">GfxData</a>* createNewGfxData(<a class="code" href="classGenericMap.html">GenericMap</a>* theMap, 
00152                                     <span class="keyword">const</span> coordinate_type* firstLat,
00153                                     <span class="keyword">const</span> coordinate_type* firstLon, 
00154                                     uint16 nbrCoords, 
00155                                     <span class="keywordtype">bool</span> closed);
00156 
00157    <span class="keyword">static</span> <a class="code" href="classGfxData.html">GfxData</a>* createNewGfxData(<a class="code" href="classGenericMap.html">GenericMap</a>* theMap, 
00158                                     <span class="keyword">const</span> <a class="code" href="classGfxData.html">GfxData</a>* src);
00159 
00160 
<a name="l00164"></a><a class="code" href="classGfxData.html#a0">00164</a>    <a class="code" href="classGfxData.html">GfxData</a>() { };
00165 
00166 
<a name="l00171"></a><a class="code" href="classGfxData.html#a1">00171</a>    <span class="keyword">virtual</span> ~<a class="code" href="classGfxData.html">GfxData</a>() {};
00172 
00174    <span class="keyword">virtual</span> const_iterator polyBegin( uint16 p ) <span class="keyword">const </span>= 0;
00176    <span class="keyword">virtual</span> const_iterator polyEnd( uint16 p ) <span class="keyword">const </span>= 0;
00178    <span class="keyword">virtual</span> iterator polyBegin( uint16 p ) = 0;
00180    <span class="keyword">virtual</span> iterator polyEnd( uint16 p ) = 0;
00181       
00182    <span class="keyword">virtual</span> coordinate_type getLat(uint16 p, uint32 i) <span class="keyword">const </span>= 0;
00183 
00184    <span class="keyword">virtual</span> coordinate_type getLon(uint16 p, uint32 i) <span class="keyword">const </span>= 0;
00185 
00186    <span class="keyword">virtual</span> <a class="code" href="Types_8h.html#a19">uint16</a> getNbrPolygons() <span class="keyword">const </span>= 0;
00187 
00188    <span class="keyword">virtual</span> <a class="code" href="Types_8h.html#a21">uint32</a> getNbrCoordinates(uint16 poly) <span class="keyword">const </span>= 0;
00189       
<a name="l00190"></a><a class="code" href="classGfxData.html#a10">00190</a>    <a class="code" href="Types_8h.html#a21">uint32</a> getTotalNbrCoordinates()<span class="keyword"> const </span>{
00191       <a class="code" href="Types_8h.html#a21">uint32</a> n=0;
00192       <span class="keywordflow">for</span> (<a class="code" href="Types_8h.html#a21">uint32</a> p=0; p&lt;getNbrPolygons(); ++p)
00193          n += getNbrCoordinates(p);
00194       <span class="keywordflow">return</span> n;
00195    }
00196 
<a name="l00203"></a><a class="code" href="classGfxData.html#a11">00203</a>    <span class="keyword">inline</span> <a class="code" href="classMC2Coordinate.html">MC2Coordinate</a> getCoordinate( uint16 p, uint32 i )<span class="keyword"> const </span>{
00204       <span class="keywordflow">return</span> <a class="code" href="classMC2Coordinate.html">MC2Coordinate</a>( getLat( p, i ), getLon( p, i ) );
00205    }
00206 
<a name="l00208"></a><a class="code" href="classGfxData.html#w3">00208</a>    <span class="keyword">typedef</span> <a class="code" href="classGfxDataFilterIterator.html">GfxDataFilterIterator</a> <a class="code" href="classGfxDataFilterIterator.html">const_filter_iterator</a>;
00209    
00211    const_filter_iterator
<a name="l00212"></a><a class="code" href="classGfxData.html#a12">00212</a>    beginFilteredPoly(uint16 polyIdx, uint8 filterLevel )<span class="keyword"> const </span>{
00213       <span class="keywordflow">return</span> <a class="code" href="classGfxDataFilterIterator.html">GfxDataFilterIterator</a>(polyBegin(polyIdx),
00214                                    polyEnd(polyIdx),
00215                                    filterLevel);
00216    }
00217 
00223    const_filter_iterator
<a name="l00224"></a><a class="code" href="classGfxData.html#a13">00224</a>    endFilteredPoly(uint16 polyIdx, uint8 filterLevel )<span class="keyword"> const </span>{
00225       <span class="keywordflow">return</span> <a class="code" href="classGfxDataFilterIterator.html">GfxDataFilterIterator</a>(polyEnd(polyIdx),
00226                                    polyEnd(polyIdx),
00227                                    filterLevel );
00228    }
00229 
00236    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> sortPolygons() = 0;
00237 
00238    <span class="keyword">virtual</span> <span class="keywordtype">void</span> setClosed(uint16 poly, <span class="keywordtype">bool</span> closed) = 0;
00239       
00240    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> getClosed(uint16 poly) <span class="keyword">const </span>= 0;
00241 
00247    <span class="keyword">virtual</span> coordinate_type getMinLat() <span class="keyword">const </span>= 0;
00248 
00254    <span class="keyword">virtual</span> coordinate_type getMaxLat() <span class="keyword">const </span>= 0;
00255 
00256 
00265    <span class="keyword">virtual</span> coordinate_type getMinLon() <span class="keyword">const </span>= 0;
00266 
00275    <span class="keyword">virtual</span> coordinate_type getMaxLon() <span class="keyword">const </span>= 0;
00276 
00277    <span class="keyword">virtual</span> <a class="code" href="Types_8h.html#a27">float64</a> getCosLat() <span class="keyword">const </span>= 0;
00278 
00280    <span class="keyword">virtual</span> <a class="code" href="Types_8h.html#a27">float64</a> getLength(uint16 p) <span class="keyword">const </span>= 0;
00281 
00285    <a class="code" href="Types_8h.html#a27">float64</a> calcPolyLength( uint32 polyIdx ) <span class="keyword">const</span>;
00286 
00287    
00289    <span class="keyword">virtual</span> <span class="keywordtype">void</span> setLength(uint16 p, float64 length) = 0;
00290 
00291  
00298    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> updateLength(uint16 polindex = MAX_UINT16) = 0;
00299 
00300    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> updateBBox() = 0;
00301       
00302    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> updateBBox(<span class="keyword">const</span> coordinate_type lat,
00303                            <span class="keyword">const</span> coordinate_type lon) = 0;
00304 
00309    <span class="keyword">virtual</span> <a class="code" href="Types_8h.html#a21">uint32</a> getMemoryUsage() <span class="keyword">const</span>;
00310 
<a name="l00311"></a><a class="code" href="classGfxData.html#w9">00311</a>    <span class="keyword">enum</span> gfxdata_t {
00312       gfxDataFull = 0,
00313       gfxDataSingleSmallPoly,
00314       gfxDataSingleLine,
00315       gfxDataSinglePoint,
00316       gfxDataMultiplePoints
00317    };
00318 
<a name="l00319"></a><a class="code" href="classGfxData.html#a29">00319</a>    gfxdata_t getGfxDataType()<span class="keyword"> const </span>{
00320       <span class="keywordflow">if</span> (getNbrPolygons() == 1) {
00321          <span class="keywordflow">if</span> (getNbrCoordinates(0) == 1) {
00322             <span class="keywordflow">return</span> gfxDataSinglePoint;
00323          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (getNbrCoordinates(0) == 2 ) {
00324             <span class="keywordflow">if</span> ( ! closed() ) {
00325                <span class="keywordflow">return</span> gfxDataSingleLine;
00326             } <span class="keywordflow">else</span> {
00327                <a class="code" href="MC2Logging_8h.html#a2">mc2dbg</a> &lt;&lt; <span class="stringliteral">"[GfxData]: A closed polygon with 2 coordinates "</span>
00328                       &lt;&lt; <span class="stringliteral">"is stupid"</span> &lt;&lt; endl;
00329                <span class="comment">// This shold be impossible really.</span>
00330                <span class="keywordflow">return</span> gfxDataSingleSmallPoly;                  
00331             }
00332          } <span class="keywordflow">else</span> {
00333             <span class="keywordflow">return</span> gfxDataSingleSmallPoly;
00334          }
00335       } <span class="keywordflow">else</span> {
00336          <span class="comment">// More than one polygon, check if all polygons</span>
00337          <span class="comment">// only have one coordinate</span>
00338          <span class="keywordtype">bool</span> onlyPoints = <span class="keyword">true</span>;
00339          <a class="code" href="Types_8h.html#a21">uint32</a> p = 0;
00340          <span class="keywordflow">while</span> ((onlyPoints) &amp;&amp; (p &lt; getNbrPolygons())) {
00341             onlyPoints = getNbrCoordinates(p) == 1;
00342             ++p;
00343          }
00344          <span class="keywordflow">if</span> (onlyPoints) {
00345             <span class="keywordflow">return</span> gfxDataMultiplePoints;
00346          }
00347       }
00348       <span class="comment">// Default, return FULL</span>
00349       <span class="keywordflow">return</span> gfxDataFull;
00350    }
00351 
00352    <span class="keywordtype">void</span> createFromDataBuffer( <a class="code" href="classDataBuffer.html">DataBuffer</a>* dataBuffer );
00353 
00354       
00380    <span class="keyword">static</span> <a class="code" href="classGfxData.html">GfxData</a>* getArcApproximation(int32 lat, int32 lon, 
00381                                        <span class="keywordtype">int</span> startAngle, <span class="keywordtype">int</span> stopAngle, 
00382                                        <span class="keywordtype">int</span> outerRadius, 
00383                                        <span class="keywordtype">int</span> innerRadius = 0,
00384                                        float64 angleIncrement = 0.2);
00385 
00404    <span class="keywordtype">bool</span> getPolygonCentroid(<span class="keyword">const</span> uint32 polygon,
00405                            int32&amp; centroidLat,
00406                            int32&amp; centroidLon) <span class="keyword">const</span>;
00407 
<a name="l00409"></a><a class="code" href="classGfxData.html#a32">00409</a>    <span class="keyword">inline</span> <span class="keywordtype">bool</span> getPolygonCentroid( uint32 polygon,
00410                                    <a class="code" href="classMC2Coordinate.html">MC2Coordinate</a>&amp; coord )<span class="keyword"> const </span>{
00411       <span class="keywordflow">return</span> getPolygonCentroid( polygon, <a class="code" href="RouteRequestData_8h.html#a3a0">coord</a>.<a class="code" href="classMC2Coordinate.html#o0">lat</a>, <a class="code" href="RouteRequestData_8h.html#a3a0">coord</a>.<a class="code" href="classMC2Coordinate.html#o1">lon</a> );
00412    }
00426    <span class="keywordtype">bool</span> convexPolygon(<span class="keyword">const</span> uint32 polygon) <span class="keyword">const</span>;
00427 
00438    <span class="keywordtype">double</span> getCosRelativeAngle(int32 polyIndex, uint32 p,
00439                               uint32 tip, uint32 q);
00440      
00449    <span class="keywordtype">void</span> <a class="code" href="namespaceTileFeatureScaleRange.html#a3">save</a>(<a class="code" href="classDataBuffer.html">DataBuffer</a>&amp; dataBuffer) <span class="keyword">const</span>;
00450 
00458    <a class="code" href="Types_8h.html#a21">uint32</a> getSizeInDataBuffer() <span class="keyword">const</span>;
00459 
00480    <a class="code" href="Types_8h.html#a21">uint32</a> getCoordinate(uint16 offset, coordinate_type&amp; lat,
00481                         coordinate_type&amp; lon) <span class="keyword">const</span>;
00482 
00488    <span class="keyword">inline</span> coordinate_type getLastLat(uint16 p) <span class="keyword">const</span>;
00489 
00495    <span class="keyword">inline</span> coordinate_type getLastLon(uint16 p) <span class="keyword">const</span>;
00496 
00515    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> getMC2BoundingBox(<a class="code" href="classMC2BoundingBox.html">MC2BoundingBox</a>&amp; bb, 
00516                                   uint16 polygon = MAX_UINT16) <span class="keyword">const</span>;
00517 
00522    <span class="keyword">virtual</span> <a class="code" href="Types_8h.html#a27">float64</a> getBBoxArea() <span class="keyword">const</span>;
00523    <span class="keyword">virtual</span> <a class="code" href="Types_8h.html#a23">uint64</a> getBBoxArea_mc2() <span class="keyword">const</span>;
00524    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> insideBBox(int32 lat, int32 lon) <span class="keyword">const</span>;
00525 
00539    <span class="keywordtype">bool</span> getRandomCoordinateInside(coordinate_type&amp; lat,
00540                                   coordinate_type&amp; lon, uint32 maxTries = 1000) <span class="keyword">const</span>;
00542 
00560    <a class="code" href="Types_8h.html#a19">uint16</a> getAverageNbrMaxTries(<span class="keyword">const</span> uint16 polygon) <span class="keyword">const</span>;
00561 
00584    <span class="keywordtype">int</span> insidePolygon(coordinate_type lat, coordinate_type lon,
00585                      uint16 usePolygon = MAX_UINT16) <span class="keyword">const</span>;
00586          
00587    <span class="keywordtype">int</span> insidePolygon(<a class="code" href="classMC2Coordinate.html">MC2Coordinate</a> coord, 
00588                      uint16 usePolygon = MAX_UINT16) <span class="keyword">const</span>;
00589 
00604    <span class="keywordtype">int</span> nbrCornersInsidePolygon(<span class="keyword">const</span> <a class="code" href="classMC2BoundingBox.html">MC2BoundingBox</a>&amp; bbox,
00605                                <span class="keywordtype">int</span> maxCorners = 4,
00606                                uint16 usePolygon = MAX_UINT16) <span class="keyword">const</span>;
00607          
00608 
00631    <a class="code" href="Types_8h.html#a23">uint64</a> squareDistWithOffsetToLine_mc2(coordinate_type lat,
00632                                          coordinate_type lon, uint16&amp; closestPolygon, uint32&amp; closestI,
00633                                          float64&amp; closestT, uint16 usePolygon = MAX_UINT16) <span class="keyword">const</span>;
00634 
00657    <a class="code" href="Types_8h.html#a23">uint64</a> squareDistWithOffsetToLine(coordinate_type lat,
00658                                      coordinate_type lon, uint16&amp; cloestPoly, uint32&amp; closestI,
00659                                      float64&amp; closestT, uint16 usePolygon = MAX_UINT16) <span class="keyword">const</span>;
00660 
00672    <a class="code" href="Types_8h.html#a23">uint64</a> squareDistToLine_mc2(coordinate_type lat,
00673                                coordinate_type lon, uint16 usePolygon = MAX_UINT16) <span class="keyword">const</span>;
00674 
00686    <a class="code" href="Types_8h.html#a23">uint64</a> squareDistToLine(coordinate_type lat,
00687                            coordinate_type lon, uint16 usePolygon = MAX_UINT16) <span class="keyword">const</span>;
00688 
00701    <a class="code" href="Types_8h.html#a23">uint64</a> squareDistTo(coordinate_type lat, coordinate_type lon,
00702                        uint16 usePolygon = MAX_UINT16) <span class="keyword">const</span>;
00703 
00715    <a class="code" href="Types_8h.html#a23">uint64</a> minSquareDistTo(<span class="keyword">const</span> <a class="code" href="classGfxData.html">GfxData</a>* otherGfx) <span class="keyword">const</span>;
00716 
00730    <a class="code" href="Types_8h.html#a24">int64</a> signedSquareDistTo(coordinate_type lat, coordinate_type lon,
00731                             uint16 usePolygon = MAX_UINT16) <span class="keyword">const</span>;
00732 
00733    <a class="code" href="Types_8h.html#a24">int64</a> signedSquareDistTo_mc2(coordinate_type lat, coordinate_type lon,
00734                             uint16 usePolygon = MAX_UINT16) <span class="keyword">const</span>;
00735 
00736 
00746    <a class="code" href="Types_8h.html#a27">float64</a> getAngle(uint16 offset) <span class="keyword">const</span>;
00747 
00752    <a class="code" href="Types_8h.html#a19">uint16</a> getOffset(int32 lat, int32 lon, 
00753                     int32&amp; latOnPoly, int32 &amp;lonOnPoly) <span class="keyword">const</span>;
00755 
00759    <span class="keywordtype">bool</span> equals(uint16 thisPolygon, uint32 thisCoord, 
00760                <span class="keyword">const</span> <a class="code" href="classGfxData.html">GfxData</a>* otherGfx,
00761                uint16 otherPolygon, uint32 otherCoord,
00762                uint16 factor=1) <span class="keyword">const</span>;
00763       
00774    <span class="keywordtype">bool</span> equals(<span class="keyword">const</span> <a class="code" href="classGfxData.html">GfxData</a>* otherData) <span class="keyword">const</span>;
00775 
00776 
00777 
00794    <span class="keywordtype">bool</span> getConvexHull(<a class="code" href="classStack.html">Stack</a>* stack, uint16 polygon);
00795 
00804    <a class="code" href="classGfxData.html">GfxData</a>* createNewConvexHull() <span class="keyword">const</span>;
00805       
00815    <a class="code" href="classGfxData.html">GfxData</a>* getConvexHull(<span class="keyword">const</span> <a class="code" href="classGfxData.html">GfxData</a>* pointSet);
00816       
00835    <span class="keywordtype">bool</span> getSimplifiedPolygon(<a class="code" href="classStack.html">Stack</a>* stack, uint16 polygon,
00836                              uint32 maxDist, uint32 minDist) <span class="keyword">const</span>;
00837 
00877    <span class="keywordtype">bool</span> openPolygonFilter( <a class="code" href="classStack.html">Stack</a>* newPoly, uint32 polyIndex,
00878                            uint32 maxLatDist, uint32 maxWayDist,
00879                            <span class="keywordtype">bool</span> minimizeError = <span class="keyword">false</span>,
00880                            uint32 startIndex = 0,
00881                            uint32 endIndex = MAX_UINT32 );
00882 
00895    <span class="keywordtype">bool</span> douglasPeuckerPolygonFilter( <a class="code" href="classStack.html">Stack</a>&amp; newPoly, 
00896                                      uint32 polyIndex,
00897                                      uint32 epsilon ) <span class="keyword">const</span>;
00898 
00899    <span class="comment">/*</span>
00900 <span class="comment">    * This method returns the coordinate indexes of all coordinates that exists</span>
00901 <span class="comment">    * more than one time in this GfxData.</span>
00902 <span class="comment">    *</span>
00903 <span class="comment">    * @param Outparameter A multimap with polygon index as key and coordinate </span>
00904 <span class="comment">    *        index as value. It should always be empty when calling the method,</span>
00905 <span class="comment">    *        and it is filled in by the call.</span>
00906 <span class="comment">    * </span>
00907 <span class="comment">    * @return Returns true if any coordinates were stored in selfTouchCoords.</span>
00908 <span class="comment">    *</span>
00909 <span class="comment">    */</span>
00910    <span class="keywordtype">bool</span> getMultiCoords(multimap&lt; uint32,uint32 &gt;&amp; selfTouchCoords) <span class="keyword">const</span>;
00911 
00912 
00941    <span class="keywordtype">bool</span> closedPolygonFilter(<a class="code" href="classStack.html">Stack</a>* newPoly, uint32 polyIndex,
00942                             uint32 pMaxLatDist, uint32 pMaxWayDist);
00943 
00956    <span class="keywordtype">double</span> polygonArea(uint32 polyIndex) <span class="keyword">const</span>;
00957 
00977    <span class="keywordtype">bool</span> triangulatePolygon(<a class="code" href="classStack.html">Stack</a>* stack, uint32 polyIndex);
00978 
01001    <span class="keywordtype">int</span> clockWise(<span class="keywordtype">int</span> polyIndex, <span class="keywordtype">int</span> startIndex = 0) <span class="keyword">const</span>;
01002 
01003       
01017    <a class="code" href="classGfxDataFull.html">GfxDataFull</a>* removeTooCloseCoordinates( <span class="keyword">const</span> uint32 polygon,
01018                                            <span class="keyword">const</span> int64 minSqDist );
01019 
01020 
01021    <span class="comment">/*</span>
01022 <span class="comment">    *    </span>
01023 <span class="comment">    *   @param  objectBBoxes  MC2BoundingBoxes to avoid collision with</span>
01024 <span class="comment">    *   @param  polygon       Index of the polygon used.   </span>
01025 <span class="comment">    *   @param  tmpGfx2       Outparameter. A subset of the original GfxData</span>
01026 <span class="comment">    *   @param  gfxTextArray  vector with GfxData for GfxFeatures previously</span>
01027 <span class="comment">    *                         placed out. </span>
01028 <span class="comment">    *   @return               True if the outdata has more than one coordinate, false otherwise</span>
01029 <span class="comment">    */</span>  
01030    <span class="keywordtype">bool</span> getTextPosition( <span class="keyword">const</span> <a class="code" href="classvector.html">vector&lt;MC2BoundingBox&gt;</a>&amp; objectBBoxes, 
01031                          uint16 polygon,  
01032                          <a class="code" href="classGfxDataFull.html">GfxDataFull</a>* tmpGfx2,
01033                          <span class="keyword">const</span> <a class="code" href="classvector.html">vector&lt;GfxData*&gt;</a>&amp; gfxTextArray ) <span class="keyword">const</span>;
01034       
<a name="l01035"></a><a class="code" href="classGfxData.html#a52">01035</a>    <span class="keywordtype">bool</span> closed()<span class="keyword"> const </span>{ 
01036       <span class="keywordflow">return</span> getClosed(0); 
01037    };
01038 
01042    <span class="keyword">virtual</span> <span class="keywordtype">void</span> readPolygons( uint16 nbrPolygons,
01043                               <a class="code" href="classDataBuffer.html">DataBuffer</a>&amp; dataBuffer, <a class="code" href="classGenericMap.html">GenericMap</a>* <a class="code" href="classmap.html">map</a>) = 0;
01044       
01045 <span class="keyword">protected</span>:
01046 
01066    <span class="keywordtype">double</span> distToTriangleSide(uint32 polyIndex, uint32 testIndex,
01067                              uint32 prevIndex, uint32 currIndex,
01068                              uint32 nextIndex);
01069       
01088    <span class="keywordtype">void</span> removePolygonVertex(int32 polyVec[], uint32 nbrCoordInVec,
01089                             uint32 VertexPos);
01090       
01091       
01101    <a class="code" href="Types_8h.html#a21">uint32</a> nbrCoordInSplittedPolygon(int32 polyVec[]);
01102       
01122    <span class="keywordtype">void</span> splitPolygon(int32 polyVec[], uint32 nbrCoordInPoly,
01123                      uint32 startIndexPos, uint32 stopIndexPos);
01124 
01125 
01126    
<a name="l01127"></a><a class="code" href="classGfxData.html#x0">01127</a>    <span class="keyword">typedef</span> set&lt; pair&lt;uint32,uint32&gt; &gt; idxSet_t;
<a name="l01128"></a><a class="code" href="classGfxData.html#x1">01128</a>    <span class="keyword">typedef</span> <a class="code" href="classmap.html">map&lt; MC2Coordinate, idxSet_t &gt;</a> <a class="code" href="classmap.html">coordMap_t</a>;
01129    
01141    <span class="keyword">static</span> <span class="keywordtype">void</span> fillCoordMap( <span class="keyword">const</span> <a class="code" href="classGfxData.html">GfxData</a>* gfx, uint32 poly,
01142                              coordMap_t&amp; gfxCoords, uint32 polyIdxToStore );
01143 
01144 
01145 
01146             
01147 <span class="keyword">private</span>:
01153                
01167    <span class="keywordtype">bool</span> simplifyPoly(<a class="code" href="classStack.html">Stack</a>* newPoly, uint32 polyIndex, 
01168                      int64 maxSqist, int64 minSqDist) <span class="keyword">const</span>;
01169 
01170 
01183    <span class="keywordtype">void</span> findBoundaryLoops2(<a class="code" href="classStack.html">Stack</a>* newPoly, uint32 polyIndex) <span class="keyword">const</span>;
01184          
01185          
01192    <a class="code" href="Types_8h.html#a21">uint32</a> stepIndex(<span class="keywordtype">int</span> step, int32 index, int32 nbrCoord) <span class="keyword">const</span>;
01193 
01203    <a class="code" href="Types_8h.html#a21">uint32</a> getPointOnConvexHull(<span class="keywordtype">int</span> polyIndex) <span class="keyword">const</span>;
01204 
01217    <span class="keywordtype">int</span> clockWiseByArea(uint32 polyIndex) <span class="keyword">const</span>;
01218          
01219 
01228    <a class="code" href="Types_8h.html#a24">int64</a> dist(int32 polyIndex, int32 first, int32 second) <span class="keyword">const</span>;
01229          
01238    <a class="code" href="Types_8h.html#a24">int64</a> dist(const_iterator polyIter, int32 first, int32 second) <span class="keyword">const</span>;
01239 
01240 
01241          
01243       
01252    <span class="keywordtype">bool</span> checkConcaveCorner( uint16 polyIndex, int32 currentIndex );
01253          
01269    <a class="code" href="Types_8h.html#a27">float64</a> getAngleNoCoslat(ConvexHullNotice* notice1, 
01270                     ConvexHullNotice* notice2,
01271                     uint16 polygon);
01272 
01276    <span class="keywordtype">bool</span> getBBox(coordinate_type&amp; minLat, coordinate_type&amp; maxLat,
01277                 coordinate_type&amp; minLon, coordinate_type&amp; maxLon) <span class="keyword">const</span>;
01278 
01284    <span class="keywordtype">int</span> getSegment(uint16 offset) <span class="keyword">const</span>;
01285 
01306    <a class="code" href="Types_8h.html#a22">int32</a> orientation(uint32 polyIndex,
01307                      uint32 x, uint32 y, uint32 z) <span class="keyword">const</span>;
01308 
01312    <a class="code" href="Types_8h.html#a22">int32</a> orientation(int32 lat1, int32 lon1, int32 lat2, int32 lon2, 
01313                      int32 lat3, int32 lon3) <span class="keyword">const</span>;
01314 
01326    <span class="keywordtype">bool</span> segmentIntersect(uint32 polyIndex, uint32 p1,
01327                          uint32 p2, uint32 q1, uint32 q2) <span class="keyword">const</span>;
01328 
01342    <span class="keywordtype">double</span> crossDistance(uint32 polyIndex, uint32 k, uint32 a, uint32 b );
01343 
01358    <span class="keywordtype">double</span> maxCrossDistance(uint32 polyIndex, uint32 a,  uint32 b);
01359       
01368    <a class="code" href="Types_8h.html#a21">uint32</a> getBestIndexBetween( uint16 polyIndex, uint32 a, uint32 b );
01369       
01383    <span class="keywordtype">double</span> triangleArea(<span class="keywordtype">double</span> d1, <span class="keywordtype">double</span> d2, <span class="keywordtype">double</span>  d3) <span class="keyword">const</span>;
01384 
<a name="l01385"></a><a class="code" href="classGfxData.html#n0">01385</a>    <span class="keyword">friend</span> <span class="keyword">class </span>SimulateRouteWindow;
<a name="l01386"></a><a class="code" href="classGfxData.html#n1">01386</a>    <span class="keyword">friend</span> <span class="keyword">class </span>MESimulateRouteWindow;
<a name="l01387"></a><a class="code" href="classGfxData.html#n2">01387</a>    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classGMSPolyUtility.html">GMSPolyUtility</a>;
01388 };
01389 
01390 <span class="comment">//-------------------------------------------------------------------------</span>
01391 <span class="comment">//                                       Implementation of inlined methods</span>
01392 <span class="comment">//-------------------------------------------------------------------------</span>
01393 
01394 
01395 <span class="keyword">inline</span> GfxData::coordinate_type
<a name="l01396"></a><a class="code" href="classGfxData.html#z491_1">01396</a> <a class="code" href="classGfxData.html#z491_1">GfxData::getLastLat</a>(uint16 poly)<span class="keyword"> const</span>
01397 <span class="keyword"></span>{
01398    <a class="code" href="config_8h.html#a29">MC2_ASSERT</a>(<a class="code" href="classGfxData.html#a9">getNbrCoordinates</a>(poly) &gt; 0);
01399    <span class="keywordflow">return</span> <a class="code" href="classGfxData.html#a6">getLat</a>(poly, <a class="code" href="classGfxData.html#a9">getNbrCoordinates</a>(poly) - 1);
01400 }
01401 
01402 <span class="keyword">inline</span> GfxData::coordinate_type
<a name="l01403"></a><a class="code" href="classGfxData.html#z491_2">01403</a> <a class="code" href="classGfxData.html#z491_2">GfxData::getLastLon</a>(uint16 poly)<span class="keyword"> const</span>
01404 <span class="keyword"></span>{
01405    <a class="code" href="config_8h.html#a29">MC2_ASSERT</a>(<a class="code" href="classGfxData.html#a9">getNbrCoordinates</a>(poly) &gt; 0);
01406    <span class="keywordflow">return</span> <a class="code" href="classGfxData.html#a7">getLon</a>(poly, <a class="code" href="classGfxData.html#a9">getNbrCoordinates</a>(poly) - 1);
01407 }
01408 
01409 
01410 <span class="preprocessor">#endif // GFXDATA_H</span>
01411 <span class="preprocessor"></span>
01412 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jun 30 10:11:46 2010 for mc2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
