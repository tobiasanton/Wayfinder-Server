<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mc2: GetAdditionalPOIInfo.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">Server</a>&nbsp;/&nbsp;<a class="el" href="dir_000005.html">Shared</a>&nbsp;/&nbsp;<a class="el" href="dir_000006.html">include</a></div>
<h1>GetAdditionalPOIInfo.h</h1><a href="GetAdditionalPOIInfo_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">Copyright (c) 1999 - 2010, Vodafone Group Services Ltd</span>
00003 <span class="comment">All rights reserved.</span>
00004 <span class="comment"></span>
00005 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
00008 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
00009 <span class="comment">    * Neither the name of the Vodafone Group Services Ltd nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
00010 <span class="comment"></span>
00011 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#ifndef GETADDITIONALPOIINFO_H</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define GETADDITIONALPOIINFO_H</span>
00016 <span class="preprocessor"></span>
00017 
00018 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00019 <span class="preprocessor">#include "<a class="code" href="SQLDriver_8h.html">SQLDriver.h</a>"</span>
00020 <span class="preprocessor">#include &lt;vector&gt;</span>
00021 <span class="preprocessor">#include &lt;set&gt;</span>
00022 <span class="preprocessor">#include "<a class="code" href="MC2String_8h.html">MC2String.h</a>"</span>
00023 <span class="preprocessor">#include "<a class="code" href="ItemInfoPacket_8h.html">ItemInfoPacket.h</a>"</span>
00024 <span class="preprocessor">#include "<a class="code" href="Item_8h.html">Item.h</a>"</span>
00025 <span class="preprocessor">#include "<a class="code" href="PointOfInterestItem_8h.html">PointOfInterestItem.h</a>"</span>
00026 
00027 <span class="keyword">class </span><a class="code" href="classCharEncSQLConn.html">CharEncSQLConn</a>;
00028 <span class="keyword">class </span><a class="code" href="classCharEncSQLQuery.html">CharEncSQLQuery</a>;
00029 <span class="keyword">class </span><a class="code" href="classPOIInfoData.html">POIInfoData</a>;
00030 <span class="keyword">class </span><a class="code" href="classGenericMap.html">GenericMap</a>;
00031 <span class="keyword">class </span>POIInfoDataFull;
00032 <span class="keyword">class </span><a class="code" href="classPOIInfo.html">POIInfo</a>;
00033 
00034 
<a name="l00039"></a><a class="code" href="classGetAdditionalPOIInfo.html">00039</a> <span class="keyword">class </span><a class="code" href="classGetAdditionalPOIInfo.html">GetAdditionalPOIInfo</a> {
00040 
00041    <span class="keyword">public</span>:
<a name="l00045"></a><a class="code" href="classGetAdditionalPOIInfo.html#w86">00045</a>       <span class="keyword">enum</span> keyID_t {
00046          VIS_ADDRESS              = 0,
00047          VIS_HOUSE_NBR            = 1,
00048          VIS_ZIP_CODE             = 2,
00049          VIS_COMPLETE_ZIP         = 3,
00050          PHONE                    = 4,
00051          VIS_ZIP_AREA             = 5,
00052          VIS_FULL_ADDRESS         = 6,
00053          FAX                      = 7,
00054          EMAIL                    = 8,
00055          <a class="code" href="classURL.html">URL</a>                      = 9,
00056          BRANDNAME                = 10,
00057          SHORT_DESCRIPTION        = 11,
00058          LONG_DESCRIPTION         = 12,
00059          CITYPART                 = 13,
00060          STATE                    = 14,
00061          NEIGHBORHOOD             = 15,
00062          OPEN_HOURS               = 16,
00063          NEAREST_TRAIN            = 17,
00064          START_DATE               = 18,
00065          END_DATE                 = 19,
00066          START_TIME               = 20,
00067          END_TIME                 = 21,
00068          ACCOMMODATION_TYPE       = 22,
00069          CHECK_IN                 = 23,
00070          CHECK_OUT                = 24,
00071          NBR_OF_ROOMS             = 25,
00072          SINGLE_ROOM_FROM         = 26,
00073          DOUBLE_ROOM_FROM         = 27,
00074          TRIPLE_ROOM_FROM         = 28,
00075          SUITE_FROM               = 29,
00076          EXTRA_BED_FROM           = 30,
00077          WEEKEND_RATE             = 31,
00078          NONHOTEL_COST            = 32,
00079          BREAKFAST                = 33,
00080          HOTEL_SERVICES           = 34,
00081          CREDIT_CARD              = 35,
00082          SPECIAL_FEATURE          = 36,
00083          CONFERENCES              = 37,
00084          AVERAGE_COST             = 38,
00085          BOOKING_ADVISABLE        = 39,
00086          ADMISSION_CHARGE         = 40,
00087          HOME_DELIVERY            = 41,
00088          DISABLED_ACCESS          = 42,
00089          TAKEAWAY_AVAILABLE       = 43,
00090          ALLOWED_TO_BRING_ALCOHOL = 44,
00091          TYPE_FOOD                = 45,
00092          DECOR                    = 46,
00093          DISPLAY_CLASS            = 47,
00094          IMAGE                    = 48,
00095          SUPPLIER                 = 49,
00096          OWNER                    = 50,
00097          PRICE_PETROL_SUPERPLUS   = 51,
00098          PRICE_PETROL_SUPER       = 52,
00099          PRICE_PETROL_NORMAL      = 53,
00100          PRICE_DIESEL             = 54,
00101          PRICE_BIODIESEL          = 55,
00102          FREE_OF_CHARGE           = 56,
00103          POIMAIN_RIGHTS           = 57,
00104          MYCHILD                  = 58,
00105          MYPARENT                 = 59,
00106          OPEN_SEASON              = 60,
00107          SKI_MOUNTAIN_MAX_HEIGHT  = 61,
00108          SKI_MOUNTAIN_MIN_HEIGHT  = 62,
00109          SNOW_DEPTH_MOUNTAIN      = 63,
00110          SNOW_DEPTH_VALLEY        = 64,
00111          SNOW_QUALITY             = 65,
00112          LIFTS_TOTAL              = 66,
00113          LIFTS_OPEN               = 67,
00114          SLOPES_TOTAL_KM          = 68,
00115          SLOPES_OPEN_KM           = 69,
00116          VALLEY_RUN               = 70,
00117          VALLEY_RUN_INFO          = 71,
00118          CROSS_COUNTRY_SKIING     = 72,
00119          CROSS_COUNTRY_SKIING_TOTAL_KM = 73,
00120          FUNPARK                  = 74,
00121          FUNPARK_INFO             = 75,
00122          NIGHT_SKIING             = 76,
00123          NIGHT_SKIING_INFO        = 77,
00124          GLACIER_AREA             = 78,
00125          LAST_SNOWFALL            = 79,
00126          HALFPIPE                 = 80,
00127          HALFPIPE_INFO            = 81,
00128 
00129          <span class="comment">// follows the POIInfoKeys table strictly</span>
00130          
00131          NBR_KEYS
00132       };
00133 
<a name="l00134"></a><a class="code" href="classGetAdditionalPOIInfo.html#w0">00134</a>    <span class="keyword">typedef</span> set&lt;keyID_t&gt; keyIDSet_t;
00135 
<a name="l00136"></a><a class="code" href="classGetAdditionalPOIInfo.html#w1">00136</a>    <span class="keyword">typedef</span> multimap&lt;keyID_t, pair&lt;MC2String, uint32&gt; &gt; resultMap_t;
00137 
<a name="l00138"></a><a class="code" href="classGetAdditionalPOIInfo.html#w2">00138</a>    <span class="keyword">typedef</span> <a class="code" href="classmap.html">map&lt;uint32, resultMap_t&gt;</a> <a class="code" href="classmap.html">poiResultMap_t</a>;
00139 
00154       <a class="code" href="classGetAdditionalPOIInfo.html">GetAdditionalPOIInfo</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* database,
00155                            <span class="keyword">const</span> <span class="keywordtype">char</span>* host,
00156                            <span class="keyword">const</span> <span class="keywordtype">char</span>* username,
00157                            <span class="keyword">const</span> <span class="keywordtype">char</span>* password);
00158 
00159       <span class="keyword">virtual</span> ~<a class="code" href="classGetAdditionalPOIInfo.html">GetAdditionalPOIInfo</a>();
00160    
00170       <span class="keywordtype">int</span> getInfo(uint32 sqlID, resultMap_t&amp; data);
00177       <span class="keywordtype">int</span> getInfo( <span class="keyword">const</span> <a class="code" href="classGenericMap.html">GenericMap</a>&amp; <a class="code" href="classmap.html">map</a>,
00178                    <a class="code" href="classvector.html">vector&lt;Item*&gt;</a>::iterator lower,
00179                    <a class="code" href="classvector.html">vector&lt;Item*&gt;</a>::iterator upper,
00180                    <span class="keyword">const</span> set&lt;GetAdditionalPOIInfo::keyID_t&gt;&amp; keyIDs,
00181                    poiResultMap_t &amp;data );
00182       
00195    <span class="keywordtype">int</span> addToPacket( <span class="keyword">const</span> <a class="code" href="classGenericMap.html">GenericMap</a>&amp; <a class="code" href="classmap.html">map</a>,  
00196                     <span class="keyword">const</span> <a class="code" href="classPointOfInterestItem.html">PointOfInterestItem</a>* item,
00197                     <a class="code" href="classItemInfoData.html">ItemInfoData</a>&amp; reply,
00198                     LangTypes::language_t lang,
00199                     <span class="keyword">const</span> <span class="keywordtype">char</span>* addrString,
00200                     ItemInfoEnums::InfoTypeFilter infoFilterLevel );
00206       <span class="keywordtype">int</span> getMultiInfo( <span class="keyword">const</span> set&lt;uint32&gt;&amp; waspIDs,
00207                         <span class="keyword">const</span> keyIDSet_t&amp; wantedTypes,
00208                         poiResultMap_t&amp; res);
00209       
00210 
00220    <span class="keywordtype">int</span> precache( <span class="keyword">const</span> uint32* beginIDs,
00221                  <span class="keyword">const</span> uint32* endIDs,
00222                  <span class="keyword">const</span> set&lt;GetAdditionalPOIInfo::keyID_t&gt;&amp; wantedTypes,
00223                  poiResultMap_t&amp; result );
00232    <span class="keywordtype">int</span> getStaticIDs( <span class="keyword">const</span> uint32* beginIDs,
00233                      <span class="keyword">const</span> uint32* endIDs,
00234                      <a class="code" href="classvector.html">vector&lt;uint32&gt;</a>&amp; ids );
00235 
00242    <span class="keywordtype">int</span> getDynamicIDs( set&lt;uint32&gt;&amp; ids );
00243 
00244 
00245 <span class="keyword">private</span>:
00252    <span class="keywordtype">int</span> addDynamicInfo( uint32 dbID, <a class="code" href="classPOIInfo.html">POIInfo</a>&amp; info );
00253 
00254 
00255       <span class="keyword">static</span> <a class="code" href="Types_8h.html#a21">uint32</a> getNbrKeys();
00256 
00260       <span class="keywordtype">bool</span> <a class="code" href="namespaceDoQuerySpace.html#a0">doQuery</a>(<a class="code" href="classCharEncSQLQuery.html">CharEncSQLQuery</a>* sqlQuery,
00261                    <span class="keyword">const</span> <span class="keywordtype">char</span>* query, <span class="keyword">const</span> <span class="keywordtype">char</span>* whereTag);
00262 
00272       <span class="keywordtype">bool</span> checkDatabaseConnection(uint32 maxNbrTries = 1);
00273 
00274       <span class="keyword">const</span> <span class="keywordtype">char</span>* getKeyString( uint32 keyID,
00275                                 LangTypes::language_t lang,
00276                                 <span class="keyword">const</span> <span class="keywordtype">char</span>* defaultValue ) <span class="keyword">const</span>;
00277 
00278 
00285       <a class="code" href="classMC2String.html">MC2String</a> getImageLink( <a class="code" href="classMC2String.html">MC2String</a> image ) <span class="keyword">const</span>;
00286 
00287       ItemInfoEnums::InfoType getType( uint32 keyID ) <span class="keyword">const</span>;
00288 
00299       <span class="keywordtype">bool</span> addPOIInfo( <a class="code" href="classItemInfoData.html">ItemInfoData</a>&amp; reply, 
00300                        uint32 keyID, <span class="keyword">const</span> POIInfoDataFull&amp; info,
00301                        LangTypes::language_t reqLang,
00302                        ItemInfoEnums::InfoTypeFilter infoFilterLevel ) <span class="keyword">const</span>;
00303 
<a name="l00307"></a><a class="code" href="classGetAdditionalPOIInfo.html#r0">00307</a>       <a class="code" href="classCharEncSQLConn.html">CharEncSQLConn</a>* m_sqlConnection;
00308 
<a name="l00313"></a><a class="code" href="classGetAdditionalPOIInfo.html#r1">00313</a>       <span class="keywordtype">int</span> m_waitDBRetry;
00314 
<a name="l00315"></a><a class="code" href="classGetAdditionalPOIInfo.html#r2">00315</a>       <span class="keywordtype">char</span>* m_database;
<a name="l00316"></a><a class="code" href="classGetAdditionalPOIInfo.html#r3">00316</a>       <span class="keywordtype">char</span>* m_host;
<a name="l00317"></a><a class="code" href="classGetAdditionalPOIInfo.html#r4">00317</a>       <span class="keywordtype">char</span>* m_username;
<a name="l00318"></a><a class="code" href="classGetAdditionalPOIInfo.html#r5">00318</a>       <span class="keywordtype">char</span>* m_password;
00319 
<a name="l00324"></a><a class="code" href="classGetAdditionalPOIInfo.html#v0">00324</a>       <span class="keyword">static</span> ItemInfoEnums::InfoType m_keyID_to_type[];
00325       <span class="comment">// If a value is bool (0-&gt;"No",1-&gt;"Yes"), int for future. </span>
<a name="l00326"></a><a class="code" href="classGetAdditionalPOIInfo.html#v1">00326</a>       <span class="keyword">static</span> <span class="keywordtype">int</span> m_keyID_value_is_bool[];
00327 };
00328 
00329 <span class="preprocessor">#endif</span>
00330 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jun 30 10:11:46 2010 for mc2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
